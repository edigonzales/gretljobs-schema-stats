[jbang] Building jar for SchemaAnalyzer.java...
--------------------------------------------------------------------------------
agi_gwr_pub/transfer_gebaeude.sql
--------------------------------------------------------------------------------
agi_gwr_pub/transfer_wohnung.sql
--------------------------------------------------------------------------------
agi_gwr_pub/import_data_codes.sql
--------------------------------------------------------------------------------
agi_gwr_pub/import_data_buildings.sql
--------------------------------------------------------------------------------
agi_gwr_pub/import_data_dwellings.sql
--------------------------------------------------------------------------------
arp_mjpnatur_pub/arp_mjpnatur_pub_flaechen.sql
--------------------------------------------------------------------------------
agi_suchindex_pub/layerSearchIndex.sql
--------------------------------------------------------------------------------
arp_statpop_import/delete.sql
--------------------------------------------------------------------------------
arp_statpop_import/transfer_nutzungszonen.sql
--------------------------------------------------------------------------------
arp_statpop_import/transfer_staging_edit.sql
--------------------------------------------------------------------------------
avt_gesamtverkehrsmodell2015_pub/gvm_so_2015_prognose_2040_pub.sql
--------------------------------------------------------------------------------
avt_gesamtverkehrsmodell2015_pub/gvm_so_2015_pub.sql
--------------------------------------------------------------------------------
avt_gesamtverkehrsmodell2015_pub/gvm_so_2015_oev_passagiere_pub.sql
--------------------------------------------------------------------------------
avt_gesamtverkehrsmodell2015_pub/gvm_so_2015_prognose_2025_pub.sql
--------------------------------------------------------------------------------
arp_waldreservate_pub/update_txt.sql
--------------------------------------------------------------------------------
arp_waldreservate_pub/waldreservate.sql
--------------------------------------------------------------------------------
arp_waldreservate_pub/write_to_mgdm.sql
--------------------------------------------------------------------------------
afu_isboden_csv_import/delete_afu_isboden_csv_import.sql
--------------------------------------------------------------------------------
afu_isboden_csv_import/update_untertypen.sql
class net.sf.jsqlparser.JSQLParserException
net.sf.jsqlparser.parser.ParseException: Encountered unexpected token: "\n\n\n" <ST_SEMICOLON>
    at line 50, column 2.

Was expecting one of:

    "("
    ","
    "DELETE"
    "FROM"
    "INSERT"
    "MERGE"
    "UPDATE"
    "VALUE"
    "VALUES"
    "WITH"
    <K_SELECT>

Error parsing: --Hier werden die Bodeneinheiten und Ausprägungen miteinander verbunden: 
--ACHTUNG: Deummerweise heisst der pk der Ausprägungen auch "pk_bodeneinheit". Ich benennen ihn hier aber um zu pk(oder fk) auspraegung. 
with auspraegungen as (
    select 
        fk_bodeneinheit as pk_bodeneinheit,
        pk_bodeneinheit as pk_auspraegung, --falls Haut und Nebenausprägungen (evtl. nicht mehr relevant) 
        csv_import.gewichtung_auspraegung
    from 
        afu_isboden.bodeneinheit_auspraegung_t auspraegung
    inner join 
        afu_isboden_csv_import_v1.csv_import_csv_import_t csv_import 
        on 
        auspraegung.fk_bodeneinheit = csv_import.bodeneinheiten_pk 
        and 
        auspraegung.pk_bodeneinheit = csv_import.auspraegung_pk
    where 
        fk_bodeneinheit in (select bodeneinheiten_pk from afu_isboden_csv_import_v1.csv_import_csv_import_t)
), 

--Macht für jeden Untertyp einer Bodeneinheit eine neue Zeile. Erleichtert später den Import und macht eine for-schlaufe überflüssig
untertypen as (
    select 
        bodeneinheiten_pk, 
        auspraegung_pk as fk_auspraegung,
        trim((regexp_split_to_table(CONCAT(
            coalesce(untertyp_e, ''),
            coalesce(',' ||untertyp_k, ''),
            coalesce(',' ||untertyp_i, ''),
            coalesce(',' ||untertyp_g, ''),
            coalesce(',' ||untertyp_r, ''),
            coalesce(',' ||untertyp_p, ''),
            coalesce(',' ||untertyp_div, '')
        )::text,','))) as untertypen
    from 
        afu_isboden_csv_import_v1.csv_import_csv_import_t csv_import
),

untertypen_mit_auspraegungen_und_untertypen as (
    select 
        untertypen.bodeneinheiten_pk, 
        untertypen.fk_auspraegung AS pk_auspraegung,
        untertypen.untertypen, 
        untertyp_t.pk_untertyp as pk_untertyp 
    from 
        untertypen untertypen
    left join 
        afu_isboden.untertyp_t untertyp_t 
        on 
        untertypen.untertypen = untertyp_t.code 
)


insert into afu_isboden.zw_bodeneinheit_untertyp 
(
    fk_bodeneinheit, 
    fk_untertyp
)
(
    select 
        pk_auspraegung as fk_bodeneinheit, 
        pk_untertyp as fk_untertyp 
    from
        untertypen_mit_auspraegungen_und_untertypen
) (net.sf.jsqlparser.parser.ParseException: Encountered unexpected token: "\n\n\n" <ST_SEMICOLON>
    at line 50, column 2.

Was expecting one of:

    "("
    ","
    "DELETE"
    "FROM"
    "INSERT"
    "MERGE"
    "UPDATE"
    "VALUE"
    "VALUES"
    "WITH"
    <K_SELECT>
)
********************************************************************************
--------------------------------------------------------------------------------
afu_isboden_csv_import/fillinpks.sql
--------------------------------------------------------------------------------
afu_isboden_csv_import/update_bodeneinheit_t.sql
--------------------------------------------------------------------------------
avt_strassenlaerm/transform_immission_strasse_pointofdetermination.sql
--------------------------------------------------------------------------------
arp_richtplan_naturreservate_pub/arp_richtplan_pub_naturreservate.sql
--------------------------------------------------------------------------------
ags_religionsgemeinschaften_pub/ags_religionsgemeinschaften_pub.sql
--------------------------------------------------------------------------------
arp_wanderwege_import_xtf/delete_arp_wanderwege_tables.sql
--------------------------------------------------------------------------------
ksta_landwert_pub/ksta_landwerte.sql
--------------------------------------------------------------------------------
agi_kartenkatalog_pub/transfer_data.sql
WITH parents AS 
(
    SELECT 
        dp.id,
        dp.dtype,
        dp.description,
        pg.description_override,
        pg.description_model,
        dp.remarks,
        dp.title,
        dp.ident_part,
        dp.derived_identifier,
        dp.keywords,
        dp.synonyms,
        ps.display_text,
        dsw.style_server,
        dsw.service_download,
        sa.transparency,
        st.title AS theme_title,
        st.identifier AS theme_ident,
        sou."name" AS org_name,
        --json(list(r."name") FILTER (WHERE r."name" IS NOT NULL)) AS permissions--,
        json_agg(r."name") FILTER (WHERE r."name" IS NOT NULL) AS permissions
    FROM 
        simi.simiproduct_data_product AS dp 
        LEFT JOIN simi.simiproduct_data_product_pub_scope AS ps 
        ON dp.pub_scope_id = ps.id 
        LEFT JOIN simi.simidata_data_set_view AS dsw 
        ON dsw.id = dp.id
        LEFT JOIN simi.simiproduct_single_actor AS sa  
        ON sa.id = dp.id
        LEFT JOIN simi.simiiam_permission AS perm
        ON perm.data_set_view_id = dsw.id
        LEFT JOIN simi.simiiam_role AS r 
        ON perm.role_id = r.id
        LEFT JOIN simi.simitheme_theme_publication AS stp 
        ON dp.theme_publication_id = stp.id 
        LEFT JOIN simi.simitheme_theme AS st 
        ON stp.theme_id = st.id
        LEFT JOIN simi.simitheme_org_unit AS sou 
        ON st.data_owner_id = sou.id

        LEFT JOIN simi.simidata_table_view AS tv 
        ON dp.id = tv.id 
        LEFT JOIN simi.simidata_postgres_table AS pg 
        ON tv.postgres_table_id = pg.id

    WHERE 
        dp.dtype NOT IN ('simiProduct_Map')
        AND
        ps.display_text IN ('WGC, QGIS u. WMS', 'Nur WMS', 'WGC u. QGIS')
    GROUP BY 
        1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18
)
,
children AS 
(
    SELECT 
        lg.id AS lg_id,
        dp.id,
        dp.dtype,
        dp.description,
        pg.description_override,
        pg.description_model,
        dp.remarks,
        dp.title,
        dp.ident_part,
        dp.derived_identifier,
        dp.keywords,
        dp.synonyms,
        ps.display_text,
        dsw.style_server,
        dsw.service_download,
        sa.transparency,
        st.title AS theme_title,
        st.identifier AS theme_ident,
        sou."name" AS org_name,
        --json(list(r."name") FILTER (WHERE r."name" IS NOT NULL)) AS permissions--,
        json_agg(r."name") FILTER (WHERE r."name" IS NOT NULL) AS permissions
    FROM 
        simi.simiproduct_layer_group AS lg 
        LEFT JOIN simi.simiproduct_properties_in_list AS pil 
        ON lg.id = pil.product_list_id
        LEFT JOIN simi.simiproduct_data_product AS dp 
        ON pil.single_actor_id = dp.id 
        LEFT JOIN simi.simiproduct_data_product_pub_scope AS ps 
        ON dp.pub_scope_id = ps.id 
        LEFT JOIN simi.simidata_data_set_view AS dsw 
        ON dsw.id = dp.id
        LEFT JOIN simi.simiproduct_single_actor AS sa  
        ON sa.id = dp.id
        LEFT JOIN simi.simiiam_permission AS perm
        ON perm.data_set_view_id = dsw.id
        LEFT JOIN simi.simiiam_role AS r 
        ON perm.role_id = r.id
        LEFT JOIN simi.simitheme_theme_publication AS stp 
        ON dp.theme_publication_id = stp.id 
        LEFT JOIN simi.simitheme_theme AS st 
        ON stp.theme_id = st.id
        LEFT JOIN simi.simitheme_org_unit AS sou 
        ON st.data_owner_id = sou.id

        LEFT JOIN simi.simidata_table_view AS tv 
        ON dp.id = tv.id 
        LEFT JOIN simi.simidata_postgres_table AS pg 
        ON tv.postgres_table_id = pg.id

    GROUP BY 
        1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19
)
SELECT 
    p.id AS p_id,
    p.dtype AS p_dtype,
    p.description AS p_description,
    p.description_override AS p_description_override,
    p.description_model AS p_description_model,
    p.remarks AS p_remarks,
    p.title AS p_title,
    p.ident_part AS p_ident_part,
    p.derived_identifier AS p_derived_identifier,
    p.keywords AS p_keywords,
    p.synonyms AS p_synonyms,
    p.display_text AS p_display_text,
    p.style_server AS p_style_server,
    p.service_download AS p_service_download,
    p.transparency AS p_transparency,
    p.theme_title AS p_theme_title,
    p.theme_ident AS p_theme_ident,
    p.org_name AS p_org_name,
    p.permissions AS p_permissions,
    c.id AS c_id,
    c.dtype AS c_dtype,
    c.description AS c_description,
    c.description_override AS c_description_override,
    c.description_model AS c_description_model,
    c.remarks AS c_remarks,
    c.title AS c_title,
    c.ident_part AS c_ident_part,
    c.derived_identifier AS c_derived_identifier,
    c.keywords AS c_keywords,
    c.synonyms AS c_synonyms,
    c.display_text AS c_display_text,
    c.style_server AS c_style_server,
    c.service_download AS c_service_download,
    c.transparency AS c_transparency,
    c.theme_title AS c_theme_title,
    c.theme_ident AS c_theme_ident,
    c.org_name AS c_org_name,
    c.permissions AS c_permissions
FROM
    parents AS p 
    LEFT JOIN children AS c
    ON p.id = c.lg_id
ORDER BY 
    p.title, c.title
--------------------------------------------------------------------------------
afu_naturgefahrenhinweiskarte_pub/murgang.sql
--------------------------------------------------------------------------------
afu_naturgefahrenhinweiskarte_pub/blockschlag.sql
--------------------------------------------------------------------------------
afu_naturgefahrenhinweiskarte_pub/rutschung_tief.sql
--------------------------------------------------------------------------------
afu_naturgefahrenhinweiskarte_pub/steinschlag.sql
--------------------------------------------------------------------------------
afu_naturgefahrenhinweiskarte_pub/rutschung_bekannt.sql
--------------------------------------------------------------------------------
afu_naturgefahrenhinweiskarte_pub/ueberflutung.sql
--------------------------------------------------------------------------------
afu_naturgefahrenhinweiskarte_pub/talboeden_geringe_neigung.sql
--------------------------------------------------------------------------------
afu_naturgefahrenhinweiskarte_pub/rutschung_lockergestein.sql
--------------------------------------------------------------------------------
afu_naturgefahrenhinweiskarte_pub/uebersarung.sql
--------------------------------------------------------------------------------
arp_mjpnl_zahlungslauf/calc_mjpnl_abrechnung_per_leistung_obl.sql
--------------------------------------------------------------------------------
arp_mjpnl_zahlungslauf/calc_mjpnl_abrechnung_per_leistung_wiese.sql
--------------------------------------------------------------------------------
arp_mjpnl_zahlungslauf/cleanup_mjpnl_abrechnung_per_leistung_orphans.sql
--------------------------------------------------------------------------------
arp_mjpnl_zahlungslauf/calc_mjpnl_abrechnung_per_leistung_wbl_weide.sql
--------------------------------------------------------------------------------
arp_mjpnl_zahlungslauf/calc_mjpnl_abrechnung_per_leistung_wbl_wiese.sql
--------------------------------------------------------------------------------
arp_mjpnl_zahlungslauf/test_delete_entries.sql
--------------------------------------------------------------------------------
arp_mjpnl_zahlungslauf/calc_mjpnl_abrechnung_per_leistung_hecke.sql
--------------------------------------------------------------------------------
arp_mjpnl_zahlungslauf/test_create_entries.sql
--------------------------------------------------------------------------------
arp_mjpnl_zahlungslauf/delete_mjpnl_migrierte_leistungen.sql
--------------------------------------------------------------------------------
arp_mjpnl_zahlungslauf/calc_mjpnl_abrechnung_per_vereinbarung.sql
--------------------------------------------------------------------------------
arp_mjpnl_zahlungslauf/cleanup_mjpnl_abrechnung_per_bewirtschafter.sql
--------------------------------------------------------------------------------
arp_mjpnl_zahlungslauf/calc_mjpnl_abrechnung_per_leistung_alr_saum.sql
--------------------------------------------------------------------------------
arp_mjpnl_zahlungslauf/copy_mjpnl_abrechnung_per_leistung.sql
--------------------------------------------------------------------------------
arp_mjpnl_zahlungslauf/calc_mjpnl_abrechnung_per_bewirtschafter.sql
--------------------------------------------------------------------------------
arp_mjpnl_zahlungslauf/calc_mjpnl_abrechnung_per_leistung_alr_buntbrache.sql
--------------------------------------------------------------------------------
arp_mjpnl_zahlungslauf/cleanup_mjpnl_abrechnung_per_leistung_status.sql
--------------------------------------------------------------------------------
arp_mjpnl_zahlungslauf/cleanup_mjpnl_abrechnung_per_leistung.sql
--------------------------------------------------------------------------------
arp_mjpnl_zahlungslauf/calc_mjpnl_abrechnung_per_leistung_weide_ln.sql
--------------------------------------------------------------------------------
arp_mjpnl_zahlungslauf/calc_mjpnl_abrechnung_per_leistung_hostet.sql
--------------------------------------------------------------------------------
arp_mjpnl_zahlungslauf/calc_mjpnl_abrechnung_per_leistung_weide_soeg.sql
--------------------------------------------------------------------------------
arp_mjpnl_zahlungslauf/cleanup_mjpnl_abrechnung_per_vereinbarung.sql
--------------------------------------------------------------------------------
awjf_rodung_rodungsersatz_mgdm/ersatzmassnahmennl.sql
class net.sf.jsqlparser.JSQLParserException
net.sf.jsqlparser.parser.ParseException: Encountered unexpected token: "\n\n\n" <ST_SEMICOLON>
    at line 31, column 2.

Was expecting one of:

    "("
    ","
    "DELETE"
    "FROM"
    "INSERT"
    "MERGE"
    "UPDATE"
    "VALUE"
    "VALUES"
    "WITH"
    <K_SELECT>

Error parsing: WITH

-- Selektion Attribute aus Tabelle Flaeche --
ersatzmassnahmennl AS (
    SELECT
        rodungsdaten.nr_kanton,
        flaeche.ersatzmassnahmennl
    FROM 
        awjf_rodung_rodungsersatz_v1.flaeche as flaeche
    LEFT JOIN awjf_rodung_rodungsersatz_v1.rodungsdaten AS rodungsdaten
        ON flaeche.rodung_r = rodungsdaten.t_id
	WHERE
		flaeche.ersatzmassnahmennl IS NOT NULL
	AND 
		rodungsdaten.rodungsentscheid = 'positiv'
	AND 
    	rodungsdaten.datum_entscheid >= '2020-01-01' -- Nur Rodungen, welche ab 01.01.2020 bewilligt wurden, sollen geliefert werden
 	AND 
 		flaeche.frist >= CURRENT_DATE - INTERVAL '10 years'
	AND 
    	flaeche.geometrie IS NOT NULL
)
,

-- Selektion Attribute aus Tabelle Rodungsbewilligung --
rodungsbewilligung AS (
    SELECT 
        t_id,
        nr_kanton
    FROM awjf_rodung_rodungsersatz_mgdm_v1.rodungsbewilligung
)


-- Abfüllen der Tabelle Ersatzmassnahmennl_ --
INSERT INTO awjf_rodung_rodungsersatz_mgdm_v1.ersatzmassnahmennl_ (
    avalue,
    rodungsbewilligung_ersatz_massnahmennl
)
  
SELECT
     DISTINCT
        CASE 
            WHEN enl.ersatzmassnahmennl = 'Nein'
                THEN 'N1'
            WHEN enl.ersatzmassnahmennl = 'Gebiet_Waldflaeche_zunehmend'
                THEN 'N2'
            WHEN enl.ersatzmassnahmennl = 'Gebiet_uebrige'
                THEN 'N3'
        END AS avalue,
    rb.t_id AS rodungsbewilligung_ersatz_massnahmennl
FROM
    ersatzmassnahmennl AS enl
JOIN rodungsbewilligung AS rb
    ON enl.nr_kanton = rb.nr_kanton (net.sf.jsqlparser.parser.ParseException: Encountered unexpected token: "\n\n\n" <ST_SEMICOLON>
    at line 31, column 2.

Was expecting one of:

    "("
    ","
    "DELETE"
    "FROM"
    "INSERT"
    "MERGE"
    "UPDATE"
    "VALUE"
    "VALUES"
    "WITH"
    <K_SELECT>
)
********************************************************************************
--------------------------------------------------------------------------------
awjf_rodung_rodungsersatz_mgdm/rodungsbewilligung.sql
--------------------------------------------------------------------------------
awjf_rodung_rodungsersatz_mgdm/ersatzverzicht.sql
--------------------------------------------------------------------------------
awjf_rodung_rodungsersatz_mgdm/massnahmenltyp.sql
--------------------------------------------------------------------------------
awjf_rodung_rodungsersatz_mgdm/objekt.sql
--------------------------------------------------------------------------------
arp_richtplan_grundnutzung_pub/arp_richtplan_pub_grundnutzung.sql
--------------------------------------------------------------------------------
afu_naturgefahren_produkte/kennwerte/kw_uebermurung_hoehe.sql
--------------------------------------------------------------------------------
afu_naturgefahren_produkte/kennwerte/fliesstiefen_altdaten_copy.sql
--------------------------------------------------------------------------------
afu_naturgefahren_produkte/kennwerte/fliessrichtung.sql
--------------------------------------------------------------------------------
afu_naturgefahren_produkte/kennwerte/kw_ueberschwemmung_geschwindigkeit.sql
--------------------------------------------------------------------------------
afu_naturgefahren_produkte/kennwerte/fliesstiefen.sql
--------------------------------------------------------------------------------
afu_naturgefahren_produkte/kennwerte/fliessrichtung_altdaten_copy.sql
--------------------------------------------------------------------------------
afu_naturgefahren_produkte/kennwerte/kw_uebermurung_geschwindigkeit.sql
--------------------------------------------------------------------------------
afu_naturgefahren_produkte/hauptprozesse/gefahrengebiet_hauptprozesse_synoptisch_create_split_poly.sql
--------------------------------------------------------------------------------
afu_naturgefahren_produkte/hauptprozesse/gefahrengebiet_hauptprozess_sturz.sql
--------------------------------------------------------------------------------
afu_naturgefahren_produkte/hauptprozesse/gefahrengebiet_hauptprozess_wasser_altdaten_copy.sql
--------------------------------------------------------------------------------
afu_naturgefahren_produkte/hauptprozesse/gefahrengebiet_hauptprozesse_synoptisch_add_attributes.sql
--------------------------------------------------------------------------------
afu_naturgefahren_produkte/hauptprozesse/gefahrengebiet_hauptprozess_rutschung.sql
--------------------------------------------------------------------------------
afu_naturgefahren_produkte/hauptprozesse/gefahrengebiet_hauptprozess_wasser.sql
class net.sf.jsqlparser.JSQLParserException
net.sf.jsqlparser.parser.ParseException: Encountered unexpected token: "\n\n\n" <ST_SEMICOLON>
    at line 156, column 2.

Was expecting one of:

    "("
    ","
    "DELETE"
    "FROM"
    "INSERT"
    "MERGE"
    "UPDATE"
    "VALUE"
    "VALUES"
    "WITH"
    <K_SELECT>

Error parsing: WITH 
basket AS (
     SELECT 
         t_id,
         attachmentkey
     from 
         afu_naturgefahren_staging_v1.t_ili2db_basket
) 

,hauptprozess_wasser AS ( 
    SELECT
        gefahrenstufe, 
        charakterisierung, 
        'uebermurung' AS teilprozess,
        (st_dump(geometrie)).geom AS geometrie  
    FROM 
        afu_naturgefahren_staging_v1.gefahrengebiet_teilprozess_murgang 
    WHERE 
        datenherkunft = 'Neudaten'
    UNION ALL 
    SELECT 
        gefahrenstufe,
        charakterisierung, 
        'ueberschwemmung' AS teilprozess,
        (ST_Dump(geometrie)).geom AS geometrie
    FROM 
        afu_naturgefahren_staging_v1.gefahrengebiet_teilprozess_ueberflutung
    WHERE 
        datenherkunft = 'Neudaten'
)

,hauptprozess_wasser_clean AS (
    SELECT 
        gefahrenstufe, 
        charakterisierung, 
        teilprozess,
        geometrie 
    FROM 
        hauptprozess_wasser 
)

,hauptprozess_wasser_clean_prio AS (
    SELECT 
        gefahrenstufe, 
        charakterisierung, 
        teilprozess,
        geometrie,
        CASE 
            WHEN gefahrenstufe = 'restgefaehrdung' THEN 0 
            WHEN gefahrenstufe = 'gering' THEN 1 
            WHEN gefahrenstufe = 'mittel' THEN 2 
            WHEN gefahrenstufe = 'erheblich' THEN 3
        END AS prio 
    FROM 
        hauptprozess_wasser_clean
)

,hauptprozess_wasser_clean_prio_clip AS (
    SELECT 
        a.gefahrenstufe, 
        a.charakterisierung, 
        a.teilprozess,
        ST_Multi(COALESCE(
            ST_Difference(a.geometrie, blade.geometrie),
            a.geometrie
        )) AS geometrie
    FROM  
        hauptprozess_wasser_clean_prio AS a
    CROSS JOIN LATERAL (
        SELECT 
            ST_Union(geometrie) AS geometrie
        FROM   
            hauptprozess_wasser_clean_prio AS b
        WHERE 
            a.geometrie && b.geometrie 
            and 
            a.prio < b.prio              
    ) AS blade      
)

,hauptprozess_wasser_boundary AS (
    SELECT 
        ST_union(st_boundary(geometrie)) AS geometrie
    FROM
        hauptprozess_wasser_clean_prio_clip
)

,hauptprozess_wasser_split_poly AS (
    SELECT 
        (ST_dump(ST_polygonize(geometrie))).geom AS geometrie
    FROM
        hauptprozess_wasser_boundary
)

,hauptprozess_wasser_split_poly_points AS (
    SELECT 
        ROW_NUMBER() OVER() AS id,
        geometrie AS poly,
        ST_pointonsurface(geometrie) AS point
    FROM
        hauptprozess_wasser_split_poly
)
    
,hauptprozess_wasser_point_on_polygons AS (
    SELECT 
        s.id,
        p.gefahrenstufe,
        string_agg(p.charakterisierung,', ') AS charakterisierung,
        string_agg(p.teilprozess,', ') AS teilprozess
    FROM
        hauptprozess_wasser_split_poly_points s
    JOIN
        hauptprozess_wasser_clean_prio_clip p ON st_within(s.point, p.geometrie)
    GROUP BY 
        s.id,
        p.gefahrenstufe
)

,hauptprozess_wasser_charakterisierung_agg AS (
    SELECT 
        polygone.gefahrenstufe,
        polygone.charakterisierung,
        polygone.teilprozess,
        point.poly AS geometrie
    FROM 
        hauptprozess_wasser_split_poly_points point 
    LEFT JOIN 
        hauptprozess_wasser_point_on_polygons polygone 
        ON 
        polygone.id = point.id
)

-- Flächen mit gleicher Gefahrenstufe und gleicher Charakterisierung können zusammengefasst werden
,hauptprozess_wasser_union AS (
    SELECT 
        gefahrenstufe,
        charakterisierung,
        teilprozess,
        ST_union(geometrie) AS geometrie
    FROM 
        hauptprozess_wasser_charakterisierung_agg
    GROUP BY 
        gefahrenstufe,
        charakterisierung,
        teilprozess
)

,hauptprozess_wasser_dump AS (
    SELECT 
        gefahrenstufe,
        charakterisierung,
        teilprozess,
        (ST_dump(geometrie)).geom AS geometrie
    FROM 
        hauptprozess_wasser_union
)


INSERT INTO afu_naturgefahren_staging_v1.gefahrengebiet_hauptprozess_wasser (
    t_basket,
    hauptprozess, 
    gefahrenstufe, 
    charakterisierung, 
    teilprozess,
    geometrie, 
    datenherkunft, 
    auftrag_neudaten
)

SELECT 
    basket.t_id AS t_basket,
    'wasser' AS hauptprozess,
    gefahrenstufe,
    charakterisierung,
    teilprozess,
    st_multi(geometrie) AS geometrie, 
    'Neudaten' AS datenherkunft, 
    basket.attachmentkey AS auftrag_neudaten   
from 
    basket,
    hauptprozess_wasser_dump
WHERE 
    charakterisierung is not null (net.sf.jsqlparser.parser.ParseException: Encountered unexpected token: "\n\n\n" <ST_SEMICOLON>
    at line 156, column 2.

Was expecting one of:

    "("
    ","
    "DELETE"
    "FROM"
    "INSERT"
    "MERGE"
    "UPDATE"
    "VALUE"
    "VALUES"
    "WITH"
    <K_SELECT>
)
********************************************************************************
--------------------------------------------------------------------------------
afu_naturgefahren_produkte/hauptprozesse/gefahrengebiet_hauptprozesse_synoptisch_make_temp_tables.sql
class java.lang.UnsupportedOperationException
Finding tables from CreateIndex is not supported
Error parsing: CREATE INDEX gk_poly_geometrie ON gk_poly USING GIST (geometrie) (Finding tables from CreateIndex is not supported)
********************************************************************************
class java.lang.UnsupportedOperationException
Finding tables from CreateIndex is not supported
Error parsing: CREATE INDEX splited_point ON splited USING GIST (point) (Finding tables from CreateIndex is not supported)
********************************************************************************
--------------------------------------------------------------------------------
afu_naturgefahren_produkte/hauptprozesse/gefahrengebiet_hauptprozess_sturz_altdaten_copy.sql
--------------------------------------------------------------------------------
afu_naturgefahren_produkte/hauptprozesse/gefahrengebiet_hauptprozesse_synoptisch_delete_holes.sql
--------------------------------------------------------------------------------
afu_naturgefahren_produkte/hauptprozesse/gefahrengebiet_hauptprozess_rutschung_altdaten_copy.sql
--------------------------------------------------------------------------------
afu_naturgefahren_produkte/hauptprozesse/gefahrengebiet_hauptprozesse_synoptisch_sort_and_insert.sql
--------------------------------------------------------------------------------
afu_naturgefahren_produkte/hauptprozesse/gefahrengebiet_hauptprozesse_synoptisch_union.sql
--------------------------------------------------------------------------------
afu_naturgefahren_produkte/hauptprozesse/gefahrengebiet_hauptprozesse_synoptisch_copy_all_to_temptables.sql
--------------------------------------------------------------------------------
afu_naturgefahren_produkte/copy_alte_natgef/copy_gefahrenkartirung_gk_wasser.sql
--------------------------------------------------------------------------------
afu_naturgefahren_produkte/copy_alte_natgef/copy_gefahrenkartirung_gk_rutsch_kont_sackung.sql
--------------------------------------------------------------------------------
afu_naturgefahren_produkte/copy_alte_natgef/copy_gefahrenkartirung_gk_synoptisch_generiert.sql
--------------------------------------------------------------------------------
afu_naturgefahren_produkte/copy_alte_natgef/copy_gefahrenkartierung_perimeter.sql
--------------------------------------------------------------------------------
afu_naturgefahren_produkte/copy_alte_natgef/copy_gefahrenkartirung_gk_absenkung_einsturz.sql
--------------------------------------------------------------------------------
afu_naturgefahren_produkte/copy_alte_natgef/copy_gefahrenkartirung_gk_rutsch_spontan.sql
--------------------------------------------------------------------------------
afu_naturgefahren_produkte/copy_alte_natgef/copy_gefahrenkartierung_erhebiungsgebiet.sql
--------------------------------------------------------------------------------
afu_naturgefahren_produkte/copy_alte_natgef/copy_gefahrenkartirung_ueberflutungskarte.sql
--------------------------------------------------------------------------------
afu_naturgefahren_produkte/copy_alte_natgef/copy_gefahrenkartirung_gk_hangmure.sql
--------------------------------------------------------------------------------
afu_naturgefahren_produkte/copy_alte_natgef/copy_gefahrenkartirung_ik_synoptisch_mgdm.sql
--------------------------------------------------------------------------------
afu_naturgefahren_produkte/copy_alte_natgef/copy_gefahrenkartirung_punktsignatur.sql
--------------------------------------------------------------------------------
afu_naturgefahren_produkte/copy_alte_natgef/copy_gefahrenkartirung_gk_sturz.sql
--------------------------------------------------------------------------------
afu_naturgefahren_produkte/copy_to_edit/publish_fliessrichtung.sql
--------------------------------------------------------------------------------
afu_naturgefahren_produkte/copy_to_edit/publish_gk_teilprozess_murgang.sql
--------------------------------------------------------------------------------
afu_naturgefahren_produkte/copy_to_edit/publish_dokumente.sql
--------------------------------------------------------------------------------
afu_naturgefahren_produkte/copy_to_edit/publish_kennwert_uebermurung_geschwindigkeit.sql
--------------------------------------------------------------------------------
afu_naturgefahren_produkte/copy_to_edit/publish_kennwert_uebermurung_hoehe.sql
--------------------------------------------------------------------------------
afu_naturgefahren_produkte/copy_to_edit/publish_erhebungsgebiet.sql
--------------------------------------------------------------------------------
afu_naturgefahren_produkte/copy_to_edit/publish_gk_hauptprozess_sturz.sql
--------------------------------------------------------------------------------
afu_naturgefahren_produkte/copy_to_edit/publish_abklaerungsperimeter.sql
--------------------------------------------------------------------------------
afu_naturgefahren_produkte/copy_to_edit/publish_gk_teilprozess_permanente_rutschung.sql
--------------------------------------------------------------------------------
afu_naturgefahren_produkte/copy_to_edit/publish_gk_hauptprozess_rutschung.sql
--------------------------------------------------------------------------------
afu_naturgefahren_produkte/copy_to_edit/publish_gk_teilprozess_spontane_rutschung.sql
--------------------------------------------------------------------------------
afu_naturgefahren_produkte/copy_to_edit/publish_gk_teilprozess_absenkung_einsturz.sql
--------------------------------------------------------------------------------
afu_naturgefahren_produkte/copy_to_edit/publish_synoptisches_gefahrengebiet.sql
--------------------------------------------------------------------------------
afu_naturgefahren_produkte/copy_to_edit/publish_gk_teilprozess_fels_bergsturz.sql
--------------------------------------------------------------------------------
afu_naturgefahren_produkte/copy_to_edit/publish_gk_hauptprozess_wasser.sql
--------------------------------------------------------------------------------
afu_naturgefahren_produkte/copy_to_edit/publish_ufererosion.sql
--------------------------------------------------------------------------------
afu_naturgefahren_produkte/copy_to_edit/publish_synoptische_intensitaet.sql
--------------------------------------------------------------------------------
afu_naturgefahren_produkte/copy_to_edit/publish_gk_teilprozess_hangmure.sql
--------------------------------------------------------------------------------
afu_naturgefahren_produkte/copy_to_edit/publish_fliesstiefen.sql
--------------------------------------------------------------------------------
afu_naturgefahren_produkte/copy_to_edit/publish_gk_teilprozess_stein_blockschlag.sql
--------------------------------------------------------------------------------
afu_naturgefahren_produkte/copy_to_edit/publish_kennwert_ueberschwemmung_geschwindigkeit.sql
--------------------------------------------------------------------------------
afu_naturgefahren_produkte/copy_to_edit/publish_gk_teilprozess_ueberflutung.sql
--------------------------------------------------------------------------------
afu_naturgefahren_produkte/ufererosion.sql
--------------------------------------------------------------------------------
afu_naturgefahren_produkte/ufererosion_altdaten_copy.sql
--------------------------------------------------------------------------------
afu_naturgefahren_produkte/vorbereitung/prepare_db.sql
class net.sf.jsqlparser.JSQLParserException
net.sf.jsqlparser.parser.ParseException: Encountered unexpected token: "IF" "IF"
    at line 1, column 18.

Was expecting one of:

    "."
    "INDEX"

Error parsing: CREATE EXTENSION IF NOT EXISTS "uuid-ossp" (net.sf.jsqlparser.parser.ParseException: Encountered unexpected token: "IF" "IF"
    at line 1, column 18.

Was expecting one of:

    "."
    "INDEX"
)
********************************************************************************
--------------------------------------------------------------------------------
afu_naturgefahren_produkte/vorbereitung/createbaskets.sql
class java.lang.ClassCastException
class net.sf.jsqlparser.statement.insert.ParenthesedInsert cannot be cast to class net.sf.jsqlparser.statement.select.ParenthesedSelect (net.sf.jsqlparser.statement.insert.ParenthesedInsert and net.sf.jsqlparser.statement.select.ParenthesedSelect are in unnamed module of loader 'app')
Error parsing: WITH
dataset AS (
    SELECT
        t_id  AS dataset  
    FROM 
        afu_naturgefahren_v1.t_ili2db_dataset
    WHERE 
        datasetname = xxx_1
)

,insert_dataset AS (
    INSERT INTO 
        afu_naturgefahren_staging_v1.t_ili2db_dataset (t_id, datasetname)
        SELECT 
            nextval('afu_naturgefahren_staging_v1.t_ili2db_seq'::regclass) AS t_id,
            xxx_1 AS datasetname 
    RETURNING t_id
)
 
INSERT INTO 
    afu_naturgefahren_staging_v1.t_ili2db_basket (t_id, dataset, topic, attachmentkey)
    SELECT 
        nextval('afu_naturgefahren_staging_v1.t_ili2db_seq'::regclass) AS t_id,
        insert_dataset.t_id AS dataset, 
        'SO_AFU_Naturgefahren_Kernmodell_20231016.Naturgefahren' AS topic, 
        xxx_1  AS attachmentkey 
    FROM 
        insert_dataset (class net.sf.jsqlparser.statement.insert.ParenthesedInsert cannot be cast to class net.sf.jsqlparser.statement.select.ParenthesedSelect (net.sf.jsqlparser.statement.insert.ParenthesedInsert and net.sf.jsqlparser.statement.select.ParenthesedSelect are in unnamed module of loader 'app'))
********************************************************************************
--------------------------------------------------------------------------------
afu_naturgefahren_produkte/vorbereitung/alte_dokumente_copy.sql
--------------------------------------------------------------------------------
afu_naturgefahren_produkte/vorbereitung/truncate_table.sql
--------------------------------------------------------------------------------
afu_naturgefahren_produkte/dokumente_pro_gemeinde.sql
--------------------------------------------------------------------------------
afu_naturgefahren_produkte/synoptische_intensitaet_altdaten_copy.sql
--------------------------------------------------------------------------------
afu_naturgefahren_produkte/synoptische_intensitaet.sql
--------------------------------------------------------------------------------
afu_naturgefahren_produkte/abklaerungsperimeter.sql
--------------------------------------------------------------------------------
afu_naturgefahren_produkte/geometrie_bereinigung.sql
--------------------------------------------------------------------------------
afu_naturgefahren_produkte/erhebungsgebiet.sql
--------------------------------------------------------------------------------
afu_naturgefahren_produkte/teilprozesse/gefahrengebiet_teilprozess_permanente_rutschung.sql
--------------------------------------------------------------------------------
afu_naturgefahren_produkte/teilprozesse/gefahrengebiet_teilprozess_fels_bergsturz.sql
--------------------------------------------------------------------------------
afu_naturgefahren_produkte/teilprozesse/gefahrengebiet_teilprozess_ueberflutung_altdaten_copy.sql
--------------------------------------------------------------------------------
afu_naturgefahren_produkte/teilprozesse/gefahrengebiet_teilprozess_murgang_altdaten_copy.sql
--------------------------------------------------------------------------------
afu_naturgefahren_produkte/teilprozesse/gefahrengebiet_teilprozess_stein_blockschlag_altdaten_copy.sql
--------------------------------------------------------------------------------
afu_naturgefahren_produkte/teilprozesse/gefahrengebiet_teilprozess_permanente_rutschung_altdaten_copy.sql
--------------------------------------------------------------------------------
afu_naturgefahren_produkte/teilprozesse/gefahrengebiet_teilprozess_spontane_rutschung_altdaten_copy.sql
--------------------------------------------------------------------------------
afu_naturgefahren_produkte/teilprozesse/gefahrengebiet_teilprozess_hangmure.sql
class net.sf.jsqlparser.JSQLParserException
net.sf.jsqlparser.parser.ParseException: Encountered unexpected token: "\n\n\n" <ST_SEMICOLON>
    at line 110, column 2.

Was expecting one of:

    "("
    ","
    "DELETE"
    "FROM"
    "INSERT"
    "MERGE"
    "UPDATE"
    "VALUE"
    "VALUES"
    "WITH"
    <K_SELECT>

Error parsing: WITH
orig_dataset AS (
    SELECT
        t_id  AS dataset  
    FROM 
        afu_naturgefahren_v1.t_ili2db_dataset
    WHERE 
        datasetname = xxx_1
),

orig_basket AS (
    SELECT 
        basket.t_id 
    FROM 
        afu_naturgefahren_v1.t_ili2db_basket basket,
        orig_dataset
    WHERE 
        basket.dataset = orig_dataset.dataset
        AND 
        topic like '%Befunde'
),

teilprozess_hangmure AS ( 
    SELECT 
       'hangmure' AS teilprozess,
        case when 
             (string_to_array(iwcode, '_'))[1] = 'gelb' then 'gering' 
             when
             (string_to_array(iwcode, '_'))[1] = 'blau' then 'mittel' 
             when
             (string_to_array(iwcode, '_'))[1] = 'rot' then 'erheblich'
             when
             (string_to_array(iwcode, '_'))[1] = 'restgefaehrdung' then 'restgefaehrdung'
        end AS gefahrenstufe,
        case when 
             (string_to_array(iwcode, '_'))[2] = 'schwach' AND (string_to_array(iwcode, '_'))[3] = '30' then 3
             when
             (string_to_array(iwcode, '_'))[2] = 'schwach' AND (string_to_array(iwcode, '_'))[3] = '100' then 2
             when
             (string_to_array(iwcode, '_'))[2] = 'schwach' AND (string_to_array(iwcode, '_'))[3] = '300' then 1
             when 
             (string_to_array(iwcode, '_'))[2] = 'mittel' AND (string_to_array(iwcode, '_'))[3] = '30' then 6
             when 
             (string_to_array(iwcode, '_'))[2] = 'mittel' AND (string_to_array(iwcode, '_'))[3] = '100' then 5
             when 
             (string_to_array(iwcode, '_'))[2] = 'mittel' AND (string_to_array(iwcode, '_'))[3] = '300' then 4
             when 
             (string_to_array(iwcode, '_'))[2] = 'stark' AND (string_to_array(iwcode, '_'))[3] = '30' then 9
             when 
             (string_to_array(iwcode, '_'))[2] = 'stark' AND (string_to_array(iwcode, '_'))[3] = '100' then 8
             when 
             (string_to_array(iwcode, '_'))[2] = 'stark' AND (string_to_array(iwcode, '_'))[3] = '300' then 7   
             WHEN 
             (string_to_array(iwcode, '_'))[1] = 'restgefaehrdung' THEN 0 --Restgefährdung hat immer die niedrigste Prio 
        end AS charakterisierung,
        geometrie, 
        'Neudaten' AS datenherkunft,
        basket.attachmentkey AS auftrag_neudaten
    FROM 
        afu_naturgefahren_v1.befundhangmure befund
    left join
        afu_naturgefahren_v1.t_ili2db_basket basket
        on 
        befund.t_basket = basket.t_id 
    WHERE 
        befund.t_basket in (SELECT t_id FROM orig_basket)
)

,teilprozess_hangmure_priorisiert AS (
    SELECT 
        teilprozess,
        gefahrenstufe,
        charakterisierung,
        geometrie,
        datenherkunft,
        auftrag_neudaten,
        CASE 
            WHEN gefahrenstufe = 'restgefaehrdung' then 0 
            WHEN gefahrenstufe = 'gering' then 10 
            WHEN gefahrenstufe = 'mittel' then 20 
            WHEN gefahrenstufe = 'erheblich' then 30
        end + charakterisierung AS prio
    FROM 
        teilprozess_hangmure
)

,teilprozess_hangmure_prio AS (
    SELECT 
        a.teilprozess,
        a.gefahrenstufe,
        a.charakterisierung,
        ST_Multi(COALESCE(
            ST_Difference(a.geometrie, blade.geometrie),
            a.geometrie
        )) AS geometrie, 
        a.datenherkunft,
        a.auftrag_neudaten
    FROM  
        teilprozess_hangmure_priorisiert AS a
    CROSS JOIN LATERAL (
        SELECT 
            ST_Union(geometrie) AS geometrie
        FROM   
            teilprozess_hangmure_priorisiert AS b
        WHERE 
            a.geometrie && b.geometrie 
            AND 
            a.prio < b.prio              
    ) AS blade
)


,teilprozess_hangmure_union AS (
    SELECT 
        teilprozess,
        gefahrenstufe,
        charakterisierung,
        ST_Union(geometrie) AS geometrie,
        datenherkunft,
        auftrag_neudaten
    FROM 
        teilprozess_hangmure_prio
    GROUP BY 
        teilprozess,
        gefahrenstufe,
        charakterisierung,
        datenherkunft,
        auftrag_neudaten
)

,teilprozess_hangmure_dump AS (
    SELECT 
        teilprozess,
        gefahrenstufe,
        charakterisierung,
        ST_Multi((ST_Dump(geometrie)).geom) AS geometrie,
        datenherkunft,
        auftrag_neudaten
    FROM 
        teilprozess_hangmure_union
) 

,basket AS (
    SELECT 
        t_id 
    FROM 
        afu_naturgefahren_staging_v1.t_ili2db_basket
)

INSERT INTO afu_naturgefahren_staging_v1.gefahrengebiet_teilprozess_hangmure (
    t_basket, 
    teilprozess, 
    gefahrenstufe, 
    charakterisierung, 
    geometrie, 
    datenherkunft, 
    auftrag_neudaten
)

SELECT
    basket.t_id AS t_basket, 
    teilprozess,
    gefahrenstufe AS gefahrenstufe,
    CASE 
    	WHEN gefahrenstufe = 'restgefaehrdung'
    	THEN 'H10' 
    	else'H'||charakterisierung 
    END AS charakterisierung,
    geometrie, 
    datenherkunft,
    auftrag_neudaten
FROM 
    teilprozess_hangmure_dump, 
    basket
WHERE 
    ST_Isempty(geometrie) is not true (net.sf.jsqlparser.parser.ParseException: Encountered unexpected token: "\n\n\n" <ST_SEMICOLON>
    at line 110, column 2.

Was expecting one of:

    "("
    ","
    "DELETE"
    "FROM"
    "INSERT"
    "MERGE"
    "UPDATE"
    "VALUE"
    "VALUES"
    "WITH"
    <K_SELECT>
)
********************************************************************************
--------------------------------------------------------------------------------
afu_naturgefahren_produkte/teilprozesse/gefahrengebiet_teilprozess_ueberflutung.sql
--------------------------------------------------------------------------------
afu_naturgefahren_produkte/teilprozesse/gefahrengebiet_teilprozess_fels_bergsturz_altdaten_copy.sql
--------------------------------------------------------------------------------
afu_naturgefahren_produkte/teilprozesse/gefahrengebiet_teilprozess_stein_blockschlag.sql
--------------------------------------------------------------------------------
afu_naturgefahren_produkte/teilprozesse/gefahrengebiet_teilprozess_hangmure_altdaten_copy.sql
--------------------------------------------------------------------------------
afu_naturgefahren_produkte/teilprozesse/gefahrengebiet_teilprozess_murgang.sql
--------------------------------------------------------------------------------
afu_naturgefahren_produkte/teilprozesse/gefahrengebiet_teilprozess_absenkung_einsturz.sql
--------------------------------------------------------------------------------
afu_naturgefahren_produkte/teilprozesse/gefahrengebiet_teilprozess_spontane_rutschung.sql
--------------------------------------------------------------------------------
afu_hydro_messstationen_pub/update_typ.sql
--------------------------------------------------------------------------------
afu_hydro_messstationen_pub/messstationen.sql
--------------------------------------------------------------------------------
avt_gvm_import/update_dtv_klassen.sql
--------------------------------------------------------------------------------
agi_av_meldewesen/update_lage.sql
--------------------------------------------------------------------------------
agi_av_meldewesen/update_manual_records.sql
--------------------------------------------------------------------------------
agi_av_meldewesen/transfer_to_work.sql
class net.sf.jsqlparser.JSQLParserException
net.sf.jsqlparser.parser.ParseException: Encountered unexpected token: "DO" "DO"
    at line 89, column 25.

Was expecting one of:

    "ON"
    "RETURN"
    "RETURNING"
    <EOF>
    <ST_SEMICOLON>

Error parsing: WITH grundstuecke AS 
(
    SELECT 
        g.nummer, g.egris_egrid, g.art, o.geometrie 
    FROM 
        agi_dm01avso24.liegenschaften_grundstueck AS g 
    LEFT JOIN 
        (
            SELECT 
                liegenschaft_von AS von, geometrie 
            FROM
                agi_dm01avso24.liegenschaften_liegenschaft
            UNION ALL 
            SELECT 
                selbstrecht_von AS von, geometrie 
            FROM 
                agi_dm01avso24.liegenschaften_selbstrecht
            UNION ALL 
            SELECT 
                bergwerk_von AS von, geometrie 
            FROM 
                agi_dm01avso24.liegenschaften_bergwerk
        ) o ON o.von = g.t_id 
)
,
gemeinden AS 
(
    SELECT 
        aname, geometrie
    FROM 
        agi_dm01avso24.gemeindegrenzen_gemeinde AS gem
    LEFT JOIN
        agi_dm01avso24.gemeindegrenzen_gemeindegrenze AS grenze ON grenze.gemeindegrenze_von = gem.t_id  
)

INSERT INTO 
    agi_av_meldewesen_work_v1.meldungen_meldung 
(
    t_ili_tid,
    lage,
    grundstuecksnummer,
    egrid,
    nbident,
    datum_meldung,
    meldegrund,
    baujahr,
    gemeinde,
    gebaeudebezeichnung,
    gebaeudeadresse,
    egid,
    versicherungsbeginn,
    verwalter,
    eigentuemer,
    baulicher_mehrwert,
    astatus,
    messageid,
    insuranceobjectid,
    bemerkungen
)
SELECT 
    m.t_ili_tid,
    ST_GeometryN(ST_GeneratePoints(grundstuecke.geometrie, 1), 1) AS lage,
    m.grundstuecksnummer,
    m.egrid,
    m.nbident,
    m.datum_meldung,
    m.meldegrund,
    m.baujahr,
    gemeinden.aname AS gemeinde,
    m.gebaeudebezeichnung,
    m.gebaeudeadresse,
    m.egid,
    m.versicherungsbeginn,
    m.verwalter,
    m.eigentuemer,
    m.baulicher_mehrwert,
    m.astatus,
    m.messageid,
    m.insuranceobjectid,
    CASE 
        WHEN m.lage IS NULL THEN 'Koordinate automatisch gerechnet.'
    END AS bemerkungen
FROM 
    agi_av_meldewesen_import_v1.meldungen_meldung AS m 
LEFT JOIN
    grundstuecke ON m.egrid = grundstuecke.egris_egrid 
LEFT JOIN 
    gemeinden ON ST_Intersects(ST_PointOnSurface(grundstuecke.geometrie), gemeinden.geometrie)
ON CONFLICT (messageid) DO NOTHING (net.sf.jsqlparser.parser.ParseException: Encountered unexpected token: "DO" "DO"
    at line 89, column 25.

Was expecting one of:

    "ON"
    "RETURN"
    "RETURNING"
    <EOF>
    <ST_SEMICOLON>
)
********************************************************************************
--------------------------------------------------------------------------------
afu_gewaesserschutz_bereiche_pub/gewaesserschutz_zustroembereich.sql
--------------------------------------------------------------------------------
afu_gewaesserschutz_bereiche_pub/gewaesserschutz_gewaesserschutzbereich.sql
--------------------------------------------------------------------------------
afu_geotope_pub/afu_geotope_pub_geotope_hoehle.sql
--------------------------------------------------------------------------------
afu_geotope_pub/afu_geotope_pub_geotope_fundstelle_grabung.sql
--------------------------------------------------------------------------------
afu_geotope_pub/afu_geotope_pub_geotope_landschaftsform.sql
--------------------------------------------------------------------------------
afu_geotope_pub/afu_geotope_pub_geotope_erratiker.sql
--------------------------------------------------------------------------------
afu_geotope_pub/afu_geotope_pub_geotope_aufschluss.sql
--------------------------------------------------------------------------------
afu_geotope_pub/afu_geotope_pub_geotope_quelle.sql
--------------------------------------------------------------------------------
afu_schutzbauten_export_ai/select_schutzbautenobjekte_wasser.sql
--------------------------------------------------------------------------------
afu_schutzbauten_export_ai/select_schutzbautenobjekte_rutschung.sql
--------------------------------------------------------------------------------
afu_schutzbauten_export_ai/select_schutzbautenobjekte_sturz.sql
--------------------------------------------------------------------------------
afu_schutzbauten_export_ai/delete_schutzbautenobjekte.sql
--------------------------------------------------------------------------------
afu_bodendaten_schadstoffuntersuchung_pub/vsb_sanierungswert_legende.sql
--------------------------------------------------------------------------------
afu_karst_pub/allogene_gebiete.sql
--------------------------------------------------------------------------------
afu_karst_pub/subartesische_zone.sql
--------------------------------------------------------------------------------
afu_karst_pub/felsueberdeckung.sql
--------------------------------------------------------------------------------
afu_karst_pub/verkarstung.sql
--------------------------------------------------------------------------------
alw_bund_hanglagen_allgemein_pub/alw_bund_hanglagen_allgemein_pub_hl_allgemein.sql
--------------------------------------------------------------------------------
afu_klimaanalyse_pub/arbeitszone_ohne_wohnen_pub.sql
--------------------------------------------------------------------------------
afu_klimaanalyse_pub/entwicklungsflaechen_pub.sql
--------------------------------------------------------------------------------
afu_klimaanalyse_pub/kaltluftbereich_zukunft_pub.sql
--------------------------------------------------------------------------------
afu_klimaanalyse_pub/kaltluftentstehung_zukunft_pub.sql
--------------------------------------------------------------------------------
afu_klimaanalyse_pub/kaltluftentstehung_ist_pub.sql
--------------------------------------------------------------------------------
afu_klimaanalyse_pub/entwicklungsflaechen_agglopr_pub.sql
--------------------------------------------------------------------------------
afu_klimaanalyse_pub/kaltluftprozess_zukunft_pub.sql
--------------------------------------------------------------------------------
afu_klimaanalyse_pub/kaltluftbereich_ist_pub.sql
--------------------------------------------------------------------------------
afu_klimaanalyse_pub/kaltluftprozess_ist_pub.sql
--------------------------------------------------------------------------------
afu_klimaanalyse_pub/ausgangsgroessen_bewertung_pub.sql
--------------------------------------------------------------------------------
afu_naturgefahren_pub/copy_to_pub/publish_fliessrichtung.sql
--------------------------------------------------------------------------------
afu_naturgefahren_pub/copy_to_pub/publish_gk_teilprozess_murgang.sql
--------------------------------------------------------------------------------
afu_naturgefahren_pub/copy_to_pub/publish_dokumente.sql
--------------------------------------------------------------------------------
afu_naturgefahren_pub/copy_to_pub/publish_kennwert_uebermurung_geschwindigkeit.sql
--------------------------------------------------------------------------------
afu_naturgefahren_pub/copy_to_pub/publish_kennwert_uebermurung_hoehe.sql
--------------------------------------------------------------------------------
afu_naturgefahren_pub/copy_to_pub/publish_erhebungsgebiet.sql
--------------------------------------------------------------------------------
afu_naturgefahren_pub/copy_to_pub/publish_gk_hauptprozess_sturz.sql
--------------------------------------------------------------------------------
afu_naturgefahren_pub/copy_to_pub/publish_abklaerungsperimeter.sql
--------------------------------------------------------------------------------
afu_naturgefahren_pub/copy_to_pub/publish_gk_teilprozess_permanente_rutschung.sql
--------------------------------------------------------------------------------
afu_naturgefahren_pub/copy_to_pub/publish_gk_hauptprozess_rutschung.sql
--------------------------------------------------------------------------------
afu_naturgefahren_pub/copy_to_pub/publish_gk_teilprozess_spontane_rutschung.sql
--------------------------------------------------------------------------------
afu_naturgefahren_pub/copy_to_pub/publish_gk_teilprozess_absenkung_einsturz.sql
--------------------------------------------------------------------------------
afu_naturgefahren_pub/copy_to_pub/publish_synoptisches_gefahrengebiet.sql
--------------------------------------------------------------------------------
afu_naturgefahren_pub/copy_to_pub/publish_gk_teilprozess_fels_bergsturz.sql
--------------------------------------------------------------------------------
afu_naturgefahren_pub/copy_to_pub/publish_gk_hauptprozess_wasser.sql
--------------------------------------------------------------------------------
afu_naturgefahren_pub/copy_to_pub/publish_ufererosion.sql
--------------------------------------------------------------------------------
afu_naturgefahren_pub/copy_to_pub/publish_synoptische_intensitaet.sql
--------------------------------------------------------------------------------
afu_naturgefahren_pub/copy_to_pub/publish_gk_teilprozess_hangmure.sql
--------------------------------------------------------------------------------
afu_naturgefahren_pub/copy_to_pub/publish_fliesstiefen.sql
--------------------------------------------------------------------------------
afu_naturgefahren_pub/copy_to_pub/publish_gk_teilprozess_stein_blockschlag.sql
--------------------------------------------------------------------------------
afu_naturgefahren_pub/copy_to_pub/publish_kennwert_ueberschwemmung_geschwindigkeit.sql
--------------------------------------------------------------------------------
afu_naturgefahren_pub/copy_to_pub/publish_gk_teilprozess_ueberflutung.sql
--------------------------------------------------------------------------------
afu_naturgefahren_pub/mgdm/hazard_area.sql
--------------------------------------------------------------------------------
afu_naturgefahren_pub/mgdm/synoptic_intensity.sql
--------------------------------------------------------------------------------
afu_naturgefahren_pub/mgdm/assessment_area.sql
--------------------------------------------------------------------------------
afu_naturgefahren_pub/mgdm/truncate_tables.sql
--------------------------------------------------------------------------------
arp_nutzungsvereinbarung_pub/arp_nutzungsvereinbarung_pub_nutzungsvrnbrngen_nutzungsvreinbarungen.sql
--------------------------------------------------------------------------------
arp_mjpnatur_gelan_export/arp_mjpnatur_gelan.sql
--------------------------------------------------------------------------------
awjf_samenerntekataster_pub/awjf_samenerntekataster_pub.sql
--------------------------------------------------------------------------------
afu_naturgefahren_gk_clean/_tmp/_copy_into_mocklayer.sql
--------------------------------------------------------------------------------
afu_naturgefahren_gk_clean/_tmp/_create_gk_mocklayer.sql
--------------------------------------------------------------------------------
afu_naturgefahren_gk_clean/_tmp/_create_verification_table.sql
class java.lang.UnsupportedOperationException
Finding tables from CreateIndex is not supported
Error parsing: CREATE INDEX sidx_verification_geometrie ON public.verification USING gist (geometrie) (Finding tables from CreateIndex is not supported)
********************************************************************************
--------------------------------------------------------------------------------
afu_naturgefahren_gk_clean/smallpoly/log_modifications.sql
--------------------------------------------------------------------------------
afu_naturgefahren_gk_clean/smallpoly/delete_sourcetable_smallpoly.sql
--------------------------------------------------------------------------------
afu_naturgefahren_gk_clean/smallpoly/create_cleanup_layer.sql
class java.lang.UnsupportedOperationException
Finding tables from CreateIndex is not supported
Error parsing: CREATE INDEX sidx_poly_cleanup_geom ON public.poly_cleanup USING gist (geom) (Finding tables from CreateIndex is not supported)
********************************************************************************
--------------------------------------------------------------------------------
afu_naturgefahren_gk_clean/smallpoly/merge_geometries.sql
--------------------------------------------------------------------------------
afu_naturgefahren_gk_clean/smallpoly/map_small_to_big.sql
class net.sf.jsqlparser.JSQLParserException
net.sf.jsqlparser.parser.ParseException: Encountered unexpected token: "\n\n\n" <ST_SEMICOLON>
    at line 4, column 3.

Was expecting one of:

    "("
    "ALTER"
    "ANALYZE"
    "BEGIN"
    "CALL"
    "COMMENT"
    "COMMIT"
    "CREATE"
    "DECLARE"
    "DELETE"
    "DESC"
    "DESCRIBE"
    "DROP"
    "EXEC"
    "EXECUTE"
    "EXPLAIN"
    "FROM"
    "GRANT"
    "IF"
    "INSERT"
    "MERGE"
    "PURGE"
    "REFRESH"
    "RENAME"
    "REPLACE"
    "RESET"
    "ROLLBACK"
    "SAVEPOINT"
    "SET"
    "SHOW"
    "SUMMARIZE"
    "TABLE"
    "TRUNCATE"
    "UPDATE"
    "UPSERT"
    "USE"
    "VALUE"
    "VALUES"
    "WITH"
    <K_SELECT>

Error parsing: /*
Klassiert die Polygone in grosse und kleine und füllt für Kleinpolygone
den Fremdschlüssel "merge_big_id" auf das zu mergende Grosspolygon aus.
*/


UPDATE -- Ergänzung aller Polygone unter der definierten Grösse mit Wert für den max. Durchmesser (max_diameter)
    public.poly_cleanup t
SET 
    g_max_diameter = max_diameter
FROM (
    SELECT 
        (ST_MaximumInscribedCircle(geom)).radius * 2 AS max_diameter,
        id
    FROM 
        public.poly_cleanup
    WHERE   
        g_area < xxx_1
) AS s
WHERE t.id = s.id (net.sf.jsqlparser.parser.ParseException: Encountered unexpected token: "\n\n\n" <ST_SEMICOLON>
    at line 4, column 3.

Was expecting one of:

    "("
    "ALTER"
    "ANALYZE"
    "BEGIN"
    "CALL"
    "COMMENT"
    "COMMIT"
    "CREATE"
    "DECLARE"
    "DELETE"
    "DESC"
    "DESCRIBE"
    "DROP"
    "EXEC"
    "EXECUTE"
    "EXPLAIN"
    "FROM"
    "GRANT"
    "IF"
    "INSERT"
    "MERGE"
    "PURGE"
    "REFRESH"
    "RENAME"
    "REPLACE"
    "RESET"
    "ROLLBACK"
    "SAVEPOINT"
    "SET"
    "SHOW"
    "SUMMARIZE"
    "TABLE"
    "TRUNCATE"
    "UPDATE"
    "UPSERT"
    "USE"
    "VALUE"
    "VALUES"
    "WITH"
    <K_SELECT>
)
********************************************************************************
--------------------------------------------------------------------------------
afu_naturgefahren_gk_clean/smallpoly/copy_from_sourcetable.sql
--------------------------------------------------------------------------------
afu_naturgefahren_gk_clean/smallpoly/update_sourcetable_geom.sql
--------------------------------------------------------------------------------
awjf_forstreviere_pub/awjf_forstreviere_pub_forstreviere_forstkreis.sql
--------------------------------------------------------------------------------
awjf_forstreviere_pub/awjf_forstreviere_pub_forstreviere_forstrevier.sql
--------------------------------------------------------------------------------
arp_nutzungsplanung_pub/insert_arp_nutzungsplanung_export_2017.sql
--------------------------------------------------------------------------------
arp_nutzungsplanung_pub/delete_arp_nutzungsplanung_export.sql
--------------------------------------------------------------------------------
arp_nutzungsplanung_pub/arp_waldabstandslinien_mgdm.sql
class java.lang.ClassCastException
class net.sf.jsqlparser.statement.insert.ParenthesedInsert cannot be cast to class net.sf.jsqlparser.statement.select.ParenthesedSelect (net.sf.jsqlparser.statement.insert.ParenthesedInsert and net.sf.jsqlparser.statement.select.ParenthesedSelect are in unnamed module of loader 'app')
Error parsing: WITH multilingualuri AS
(
    INSERT INTO
        arp_waldabstandslinien_mgdm_v1.multilingualuri
        (
            t_id,
            t_basket,
            t_datasetname,
            t_seq,
            rechtsvrschrftn_dkment_textimweb
        )
    SELECT
        nextval('arp_waldabstandslinien_mgdm_v1.t_ili2db_seq'::regclass) AS t_id,
        (SELECT 
             t_id 
         FROM 
             arp_waldabstandslinien_mgdm_v1.t_ili2db_basket 
         WHERE 
             topic = 'Waldabstandslinien_V1_2.Rechtsvorschriften'
        ) AS t_basket, 
        (SELECT 
             datasetname 
         FROM 
             arp_waldabstandslinien_mgdm_v1.t_ili2db_dataset tid 
         WHERE 
             t_id = (SELECT 
                         dataset 
                     FROM 
                         arp_waldabstandslinien_mgdm_v1.t_ili2db_basket 
                     WHERE 
                         topic = 'Waldabstandslinien_V1_2.Rechtsvorschriften')
        ) AS t_datasetname,
        0 AS t_seq,
        rechtsvorschrften_dokument.t_id AS rechtsvrschrftn_dkment_textimweb
    FROM
        arp_waldabstandslinien_mgdm_v1.rechtsvorschrften_dokument AS rechtsvorschrften_dokument
    WHERE 
        t_datasetname = xxx_1::TEXT 
    RETURNING *
)
,
localiseduri AS 
(
    SELECT 
        nextval('arp_waldabstandslinien_mgdm_v1.t_ili2db_seq'::regclass) AS t_id,
        (SELECT 
             t_id 
         FROM 
             arp_waldabstandslinien_mgdm_v1.t_ili2db_basket 
         WHERE 
             topic = 'Waldabstandslinien_V1_2.Rechtsvorschriften'
        ) AS t_basket, 
        xxx_1 AS t_datasetname,      
        0 AS t_seq,
        'de' AS alanguage,
        textimweb AS atext,
        multilingualuri.t_id AS multilingualuri_localisedtext
    FROM
        arp_nutzungsplanung_v1.rechtsvorschrften_dokument AS rechtsvorschrften_dokument
        RIGHT JOIN multilingualuri 
        ON multilingualuri.rechtsvrschrftn_dkment_textimweb = rechtsvorschrften_dokument.t_id
    WHERE 
        rechtsvorschrften_dokument.t_datasetname::int4 = xxx_1
)
INSERT INTO
    arp_waldabstandslinien_mgdm_v1.localiseduri
    (
        t_id,
        t_basket,
        t_datasetname,
        t_seq,
        alanguage,
        atext,
        multilingualuri_localisedtext
    )
    SELECT 
        t_id,
        t_basket,
        t_datasetname,
        t_seq,
        alanguage,
        coalesce (atext,'https://planregister-data.so.ch/public/kanton/Dokument-nicht-digital-verfuegbar.pdf') AS atext, --Wenn kein Dokument vorhanden, soll auf dieses Dokument verwiesen werden,
        multilingualuri_localisedtext
    FROM 
        localiseduri (class net.sf.jsqlparser.statement.insert.ParenthesedInsert cannot be cast to class net.sf.jsqlparser.statement.select.ParenthesedSelect (net.sf.jsqlparser.statement.insert.ParenthesedInsert and net.sf.jsqlparser.statement.select.ParenthesedSelect are in unnamed module of loader 'app'))
********************************************************************************
--------------------------------------------------------------------------------
arp_nutzungsplanung_pub/delete_arp_nutzungsplanung_planregister_pub_kommunal.sql
--------------------------------------------------------------------------------
arp_nutzungsplanung_pub/truncate_all_arp_waldabstandslinien_mgdm_tables.sql
--------------------------------------------------------------------------------
arp_nutzungsplanung_pub/truncate_all_arp_laermempfindlichkeit_mgdm_tables.sql
--------------------------------------------------------------------------------
arp_nutzungsplanung_pub/insert_arp_nutzungsplanung_transfer_pub.sql
--------------------------------------------------------------------------------
arp_nutzungsplanung_pub/arp_planungszonen_mgdm.sql
class java.lang.ClassCastException
class net.sf.jsqlparser.statement.insert.ParenthesedInsert cannot be cast to class net.sf.jsqlparser.statement.select.ParenthesedSelect (net.sf.jsqlparser.statement.insert.ParenthesedInsert and net.sf.jsqlparser.statement.select.ParenthesedSelect are in unnamed module of loader 'app')
Error parsing: WITH multilingualuri AS
(
    INSERT INTO
        arp_planungszonen_mgdm_v1.multilingualuri
        (
            t_id,
            t_basket,
            t_datasetname,
            t_seq,
            rechtsvrschrftn_dkment_textimweb
        )
    SELECT
        nextval('arp_planungszonen_mgdm_v1.t_ili2db_seq'::regclass) AS t_id,
        (SELECT 
             t_id 
         FROM 
             arp_planungszonen_mgdm_v1.t_ili2db_basket 
         WHERE 
             topic = 'Planungszonen_V1_1.Rechtsvorschriften'
        ) AS t_basket, 
        (SELECT 
             datasetname 
         FROM 
             arp_planungszonen_mgdm_v1.t_ili2db_dataset tid 
         WHERE 
             t_id = (SELECT 
                         dataset 
                     FROM 
                         arp_planungszonen_mgdm_v1.t_ili2db_basket 
                     WHERE 
                         topic = 'Planungszonen_V1_1.Rechtsvorschriften')
        ) AS t_datasetname,
        0 AS t_seq,
        rechtsvorschrften_dokument.t_id AS rechtsvrschrftn_dkment_textimweb
    FROM
        arp_planungszonen_mgdm_v1.rechtsvorschrften_dokument AS rechtsvorschrften_dokument
    WHERE 
        t_datasetname = xxx_1::TEXT 
    RETURNING *
)
,
localiseduri AS 
(
    SELECT 
        nextval('arp_planungszonen_mgdm_v1.t_ili2db_seq'::regclass) AS t_id,
        (SELECT 
             t_id 
         FROM 
             arp_planungszonen_mgdm_v1.t_ili2db_basket 
         WHERE 
             topic = 'Planungszonen_V1_1.Rechtsvorschriften'
        ) AS t_basket, 
        xxx_1 AS t_datasetname,      
        0 AS t_seq,
        'de' AS alanguage,
        textimweb AS atext,
        multilingualuri.t_id AS multilingualuri_localisedtext
    FROM
        arp_nutzungsplanung_v1.rechtsvorschrften_dokument AS rechtsvorschrften_dokument
        RIGHT JOIN multilingualuri 
        ON multilingualuri.rechtsvrschrftn_dkment_textimweb = rechtsvorschrften_dokument.t_id
    WHERE 
        rechtsvorschrften_dokument.t_datasetname::int4 = xxx_1
)
INSERT INTO
    arp_planungszonen_mgdm_v1.localiseduri
    (
        t_id,
        t_basket,
        t_datasetname,
        t_seq,
        alanguage,
        atext,
        multilingualuri_localisedtext
    )
    SELECT 
        t_id,
        t_basket,
        t_datasetname,
        t_seq,
        alanguage,
        coalesce (atext,'https://planregister-data.so.ch/public/kanton/Dokument-nicht-digital-verfuegbar.pdf') AS atext, --Wenn kein Dokument vorhanden, soll auf dieses Dokument verwiesen werden,
        multilingualuri_localisedtext
    FROM 
        localiseduri (class net.sf.jsqlparser.statement.insert.ParenthesedInsert cannot be cast to class net.sf.jsqlparser.statement.select.ParenthesedSelect (net.sf.jsqlparser.statement.insert.ParenthesedInsert and net.sf.jsqlparser.statement.select.ParenthesedSelect are in unnamed module of loader 'app'))
********************************************************************************
--------------------------------------------------------------------------------
arp_nutzungsplanung_pub/arp_laermempfindlichkeitsstufen_mgdm.sql
class java.lang.ClassCastException
class net.sf.jsqlparser.statement.insert.ParenthesedInsert cannot be cast to class net.sf.jsqlparser.statement.select.ParenthesedSelect (net.sf.jsqlparser.statement.insert.ParenthesedInsert and net.sf.jsqlparser.statement.select.ParenthesedSelect are in unnamed module of loader 'app')
Error parsing: WITH multilingualuri AS
(
    INSERT INTO
        arp_laermempfindlichkeitsstufen_mgdm_v1.multilingualuri
        (
            t_id,
            t_basket,
            t_datasetname,
            t_seq,
            rechtsvrschrftn_dkment_textimweb
        )
    SELECT
        nextval('arp_laermempfindlichkeitsstufen_mgdm_v1.t_ili2db_seq'::regclass) AS t_id,
        (SELECT 
             t_id 
         FROM 
             arp_laermempfindlichkeitsstufen_mgdm_v1.t_ili2db_basket 
         WHERE 
             topic = 'Laermempfindlichkeitsstufen_V1_2.Rechtsvorschriften'
        ) AS t_basket, 
        (SELECT 
             datasetname 
         FROM 
             arp_laermempfindlichkeitsstufen_mgdm_v1.t_ili2db_dataset tid 
         WHERE 
             t_id = (SELECT 
                         dataset 
                     FROM 
                         arp_laermempfindlichkeitsstufen_mgdm_v1.t_ili2db_basket 
                     WHERE 
                         topic = 'Laermempfindlichkeitsstufen_V1_2.Rechtsvorschriften')
        ) AS t_datasetname,
        0 AS t_seq,
        rechtsvorschrften_dokument.t_id AS rechtsvrschrftn_dkment_textimweb
    FROM
        arp_laermempfindlichkeitsstufen_mgdm_v1.rechtsvorschrften_dokument AS rechtsvorschrften_dokument
    WHERE 
        t_datasetname = xxx_1::TEXT 
    RETURNING *
)
,
localiseduri AS 
(
    SELECT 
        nextval('arp_laermempfindlichkeitsstufen_mgdm_v1.t_ili2db_seq'::regclass) AS t_id,
        (SELECT 
             t_id 
         FROM 
             arp_laermempfindlichkeitsstufen_mgdm_v1.t_ili2db_basket 
         WHERE 
             topic = 'Laermempfindlichkeitsstufen_V1_2.Rechtsvorschriften'
        ) AS t_basket, 
        xxx_1 AS t_datasetname,      
        0 AS t_seq,
        'de' AS alanguage,
        textimweb AS atext,
        multilingualuri.t_id AS multilingualuri_localisedtext
    FROM
        arp_nutzungsplanung_v1.rechtsvorschrften_dokument AS rechtsvorschrften_dokument
        RIGHT JOIN multilingualuri 
        ON multilingualuri.rechtsvrschrftn_dkment_textimweb = rechtsvorschrften_dokument.t_id
    WHERE 
        rechtsvorschrften_dokument.t_datasetname::int4 = xxx_1
)
INSERT INTO
    arp_laermempfindlichkeitsstufen_mgdm_v1.localiseduri
    (
        t_id,
        t_basket,
        t_datasetname,
        t_seq,
        alanguage,
        atext,
        multilingualuri_localisedtext
    )
    SELECT 
        t_id,
        t_basket,
        t_datasetname,
        t_seq,
        alanguage,
        coalesce (atext,'https://planregister-data.so.ch/public/kanton/Dokument-nicht-digital-verfuegbar.pdf') AS atext, --Wenn kein Dokument vorhanden, soll auf dieses Dokument verwiesen werden.
        multilingualuri_localisedtext
    FROM 
        localiseduri (class net.sf.jsqlparser.statement.insert.ParenthesedInsert cannot be cast to class net.sf.jsqlparser.statement.select.ParenthesedSelect (net.sf.jsqlparser.statement.insert.ParenthesedInsert and net.sf.jsqlparser.statement.select.ParenthesedSelect are in unnamed module of loader 'app'))
********************************************************************************
--------------------------------------------------------------------------------
arp_nutzungsplanung_pub/arp_nutzungsplanung_kommunal_mgdm.sql
class java.lang.ClassCastException
class net.sf.jsqlparser.statement.insert.ParenthesedInsert cannot be cast to class net.sf.jsqlparser.statement.select.ParenthesedSelect (net.sf.jsqlparser.statement.insert.ParenthesedInsert and net.sf.jsqlparser.statement.select.ParenthesedSelect are in unnamed module of loader 'app')
Error parsing: WITH typ_kt_grundnutzung AS (
    INSERT INTO arp_nutzungsplanung_mgdm_v1.geobasisdaten_typ_kt
        (
        t_basket, 
        t_datasetname,
        acode,
        bezeichnung,
        abkuerzung,
        catalogue_ch
        )
    SELECT
        (SELECT 
             t_id 
         FROM 
             arp_nutzungsplanung_mgdm_v1.t_ili2db_basket 
         WHERE 
             topic = 'Nutzungsplanung_V1_2.Geobasisdaten'
        ) AS t_basket, 
        (SELECT 
             datasetname 
         FROM 
             arp_nutzungsplanung_mgdm_v1.t_ili2db_dataset tid 
         WHERE 
             t_id = (SELECT 
                         dataset 
                     FROM 
                         arp_nutzungsplanung_mgdm_v1.t_ili2db_basket 
                     WHERE 
                         topic = 'Nutzungsplanung_V1_2.Geobasisdaten')
        ) AS t_datasetname,
        substring(ilicode FROM 2 FOR 3) AS code, 
        replace(substring(ilicode FROM 6), '_', ' ') AS bezeichnung, 
        substring(ilicode FROM 1 FOR 4) AS abkuerzung,
        hauptnutzung.t_id AS catalogue_ch
    FROM
        arp_nutzungsplanung_v1.nutzungsplanung_np_typ_kanton_grundnutzung AS grundnutzung
        LEFT JOIN arp_nutzungsplanung_mgdm_v1.catalogue_ch_catalogue_ch AS hauptnutzung
        ON hauptnutzung.acode::text = substring(ilicode FROM 2 FOR 2)
    RETURNING *  
)

INSERT INTO arp_nutzungsplanung_mgdm_v1.geobasisdaten_typ 
    (
        t_id,
        t_basket, 
        t_datasetname,
        acode,
        bezeichnung,
        abkuerzung,
        verbindlichkeit,
        nutzungsziffer,
        nutzungsziffer_art,
        bemerkungen,
        typ_kt 
    )
SELECT 
    typ.t_id,
    (SELECT 
         t_id 
     FROM 
         arp_nutzungsplanung_mgdm_v1.t_ili2db_basket 
     WHERE 
         topic = 'Nutzungsplanung_V1_2.Geobasisdaten'
    ) AS t_basket, 
    (SELECT 
         datasetname 
     FROM 
         arp_nutzungsplanung_mgdm_v1.t_ili2db_dataset tid 
     WHERE 
         t_id = (SELECT 
                     dataset 
                 FROM 
                     arp_nutzungsplanung_mgdm_v1.t_ili2db_basket 
                 WHERE 
                     topic = 'Nutzungsplanung_V1_2.Geobasisdaten')
    ) AS t_datasetname,
    typ.code_kommunal AS acode,
    typ.bezeichnung,
    typ.abkuerzung,
    typ.verbindlichkeit,
    typ.nutzungsziffer,
    typ.nutzungsziffer_art,
    typ.bemerkungen,
    typ_kt.t_id
    
FROM
    arp_nutzungsplanung_v1.nutzungsplanung_typ_grundnutzung AS typ
    LEFT JOIN typ_kt_grundnutzung AS typ_kt
    ON typ_kt.acode = substring(typ.typ_kt FROM 2 FOR 3)
WHERE 
    typ.t_datasetname::int4 = xxx_1 (class net.sf.jsqlparser.statement.insert.ParenthesedInsert cannot be cast to class net.sf.jsqlparser.statement.select.ParenthesedSelect (net.sf.jsqlparser.statement.insert.ParenthesedInsert and net.sf.jsqlparser.statement.select.ParenthesedSelect are in unnamed module of loader 'app'))
********************************************************************************
class java.lang.ClassCastException
class net.sf.jsqlparser.statement.insert.ParenthesedInsert cannot be cast to class net.sf.jsqlparser.statement.select.ParenthesedSelect (net.sf.jsqlparser.statement.insert.ParenthesedInsert and net.sf.jsqlparser.statement.select.ParenthesedSelect are in unnamed module of loader 'app')
Error parsing: WITH typ_kt_flaeche AS (
    INSERT INTO arp_nutzungsplanung_mgdm_v1.geobasisdaten_typ_kt
        (
        t_basket, 
        t_datasetname,
        acode,
        bezeichnung,
        abkuerzung,
        catalogue_ch
        )
    SELECT
        (SELECT 
             t_id 
         FROM 
             arp_nutzungsplanung_mgdm_v1.t_ili2db_basket 
         WHERE 
             topic = 'Nutzungsplanung_V1_2.Geobasisdaten'
        ) AS t_basket, 
        (SELECT 
             datasetname 
         FROM 
             arp_nutzungsplanung_mgdm_v1.t_ili2db_dataset tid 
         WHERE 
             t_id = (SELECT 
                         dataset 
                     FROM 
                         arp_nutzungsplanung_mgdm_v1.t_ili2db_basket 
                     WHERE 
                         topic = 'Nutzungsplanung_V1_2.Geobasisdaten')
        ) AS t_datasetname,
        substring(ilicode FROM 2 FOR 3) AS code, 
        replace(substring(ilicode FROM 6), '_', ' ') AS bezeichnung, 
        substring(ilicode FROM 1 FOR 4) AS abkuerzung,
        hauptnutzung.t_id AS catalogue_ch
    FROM
        arp_nutzungsplanung_v1.nutzungsplanung_np_typ_kanton_ueberlagernd_flaeche AS flaeche
        LEFT JOIN arp_nutzungsplanung_mgdm_v1.catalogue_ch_catalogue_ch AS hauptnutzung
        ON hauptnutzung.acode::text = substring(ilicode FROM 2 FOR 2)
    WHERE 
        substring(ilicode FROM 2 FOR 3) 
        NOT IN 
        (
            '593', 
            '594', 
            '595', 
            '596', 
            '680', 
            '680', 
            '680', 
            '681', 
            '682', 
            '683', 
            '684', 
            '685', 
            '686'
        )
        -- 800er-Werte für Flächen müssen dem MGDM-Wert 69 zugewiesen werden.
        AND 
            substring(ilicode FROM 2 FOR 3)::int < 800
  
        UNION 
  
    SELECT
        (SELECT 
             t_id 
         FROM 
             arp_nutzungsplanung_mgdm_v1.t_ili2db_basket 
         WHERE 
             topic = 'Nutzungsplanung_V1_2.Geobasisdaten'
        ) AS t_basket, 
        (SELECT 
             datasetname 
         FROM 
             arp_nutzungsplanung_mgdm_v1.t_ili2db_dataset tid 
         WHERE 
             t_id = (SELECT 
                         dataset 
                     FROM 
                         arp_nutzungsplanung_mgdm_v1.t_ili2db_basket 
                     WHERE 
                         topic = 'Nutzungsplanung_V1_2.Geobasisdaten')
        ) AS t_datasetname,
        substring(ilicode FROM 2 FOR 3) AS code, 
        replace(substring(ilicode FROM 6), '_', ' ') AS bezeichnung, 
        substring(ilicode FROM 1 FOR 4) AS abkuerzung,
        hauptnutzung.t_id AS catalogue_ch
        FROM
            arp_nutzungsplanung_v1.nutzungsplanung_np_typ_kanton_ueberlagernd_flaeche AS flaeche
            LEFT JOIN 
            (
                SELECT 
                    t_id
                FROM
                    arp_nutzungsplanung_mgdm_v1.catalogue_ch_catalogue_ch
                WHERE
                    acode = 69
            ) AS hauptnutzung
            ON 
                1=1
        WHERE 
            substring(ilicode FROM 2 FOR 3)::int >= 800
    RETURNING *  
)

INSERT INTO arp_nutzungsplanung_mgdm_v1.geobasisdaten_typ 
    (
        t_id,
        t_basket, 
        t_datasetname,
        acode,
        bezeichnung,
        abkuerzung,
        verbindlichkeit,
        bemerkungen,
        typ_kt 
    )
SELECT 
    typ.t_id,
    (SELECT 
         t_id 
     FROM 
         arp_nutzungsplanung_mgdm_v1.t_ili2db_basket 
     WHERE 
         topic = 'Nutzungsplanung_V1_2.Geobasisdaten'
    ) AS t_basket, 
    (SELECT 
         datasetname 
     FROM 
         arp_nutzungsplanung_mgdm_v1.t_ili2db_dataset tid 
     WHERE 
         t_id = (SELECT 
                     dataset 
                 FROM 
                     arp_nutzungsplanung_mgdm_v1.t_ili2db_basket 
                 WHERE 
                     topic = 'Nutzungsplanung_V1_2.Geobasisdaten')
    ) AS t_datasetname,
    typ.code_kommunal AS acode,
    typ.bezeichnung,
    typ.abkuerzung,
    typ.verbindlichkeit,
    typ.bemerkungen,
    typ_kt.t_id
    
FROM
    arp_nutzungsplanung_v1.nutzungsplanung_typ_ueberlagernd_flaeche AS typ 
    JOIN typ_kt_flaeche AS typ_kt
    ON typ_kt.acode = substring(typ.typ_kt FROM 2 FOR 3)
WHERE 
    typ.t_datasetname::int4 = xxx_1 (class net.sf.jsqlparser.statement.insert.ParenthesedInsert cannot be cast to class net.sf.jsqlparser.statement.select.ParenthesedSelect (net.sf.jsqlparser.statement.insert.ParenthesedInsert and net.sf.jsqlparser.statement.select.ParenthesedSelect are in unnamed module of loader 'app'))
********************************************************************************
class java.lang.ClassCastException
class net.sf.jsqlparser.statement.insert.ParenthesedInsert cannot be cast to class net.sf.jsqlparser.statement.select.ParenthesedSelect (net.sf.jsqlparser.statement.insert.ParenthesedInsert and net.sf.jsqlparser.statement.select.ParenthesedSelect are in unnamed module of loader 'app')
Error parsing: WITH typ_kt_linie AS (
    INSERT INTO arp_nutzungsplanung_mgdm_v1.geobasisdaten_typ_kt
        (
        t_basket, 
        t_datasetname,
        acode,
        bezeichnung,
        abkuerzung,
        catalogue_ch
        )
    SELECT
        (SELECT 
             t_id 
         FROM 
             arp_nutzungsplanung_mgdm_v1.t_ili2db_basket 
         WHERE 
             topic = 'Nutzungsplanung_V1_2.Geobasisdaten'
        ) AS t_basket, 
        (SELECT 
             datasetname 
         FROM 
             arp_nutzungsplanung_mgdm_v1.t_ili2db_dataset tid 
         WHERE 
             t_id = (SELECT 
                         dataset 
                     FROM 
                         arp_nutzungsplanung_mgdm_v1.t_ili2db_basket 
                     WHERE 
                         topic = 'Nutzungsplanung_V1_2.Geobasisdaten')
        ) AS t_datasetname,
        substring(ilicode FROM 2 FOR 3) AS code, 
        replace(substring(ilicode FROM 6), '_', ' ') AS bezeichnung, 
        substring(ilicode FROM 1 FOR 4) AS abkuerzung,
        hauptnutzung.t_id AS catalogue_ch
    FROM
        arp_nutzungsplanung_kanton_v1.nutzungsplanung_np_typ_kanton_ueberlagernd_linie AS linie
        LEFT JOIN arp_nutzungsplanung_mgdm_v1.catalogue_ch_catalogue_ch AS hauptnutzung
        ON hauptnutzung.acode::text = substring(ilicode FROM 2 FOR 2)
    WHERE 
        substring(ilicode FROM 2 FOR 3) 
        NOT IN 
        (
        '792', 
        '793'
        )
    RETURNING *
)
INSERT INTO arp_nutzungsplanung_mgdm_v1.geobasisdaten_typ 
    (
        t_id,
        t_basket, 
        t_datasetname,
        acode,
        bezeichnung,
        abkuerzung,
        verbindlichkeit,
        bemerkungen,
        typ_kt 
    )
SELECT 
    typ.t_id,
    (SELECT 
         t_id 
     FROM 
         arp_nutzungsplanung_mgdm_v1.t_ili2db_basket 
     WHERE 
         topic = 'Nutzungsplanung_V1_2.Geobasisdaten'
    ) AS t_basket, 
    (SELECT 
         datasetname 
     FROM 
         arp_nutzungsplanung_mgdm_v1.t_ili2db_dataset tid 
     WHERE 
         t_id = (SELECT 
                     dataset 
                 FROM 
                     arp_nutzungsplanung_mgdm_v1.t_ili2db_basket 
                 WHERE 
                     topic = 'Nutzungsplanung_V1_2.Geobasisdaten')
    ) AS t_datasetname,
    typ.code_kommunal AS acode,
    typ.bezeichnung,
    typ.abkuerzung,
    typ.verbindlichkeit,
    typ.bemerkungen,
    typ_kt.t_id
    
FROM
    arp_nutzungsplanung_v1.nutzungsplanung_typ_ueberlagernd_linie  AS typ 
    JOIN typ_kt_linie AS typ_kt
    ON typ_kt.acode = substring(typ.typ_kt FROM 2 FOR 3)
WHERE 
    typ.t_datasetname::int4 = xxx_1 (class net.sf.jsqlparser.statement.insert.ParenthesedInsert cannot be cast to class net.sf.jsqlparser.statement.select.ParenthesedSelect (net.sf.jsqlparser.statement.insert.ParenthesedInsert and net.sf.jsqlparser.statement.select.ParenthesedSelect are in unnamed module of loader 'app'))
********************************************************************************
class java.lang.ClassCastException
class net.sf.jsqlparser.statement.insert.ParenthesedInsert cannot be cast to class net.sf.jsqlparser.statement.select.ParenthesedSelect (net.sf.jsqlparser.statement.insert.ParenthesedInsert and net.sf.jsqlparser.statement.select.ParenthesedSelect are in unnamed module of loader 'app')
Error parsing: WITH typ_kt_linie_erschliessung AS (
    INSERT INTO arp_nutzungsplanung_mgdm_v1.geobasisdaten_typ_kt
        (
        t_basket, 
        t_datasetname,
        acode,
        bezeichnung,
        abkuerzung,
        catalogue_ch
        )
    SELECT
        (SELECT 
             t_id 
         FROM 
             arp_nutzungsplanung_mgdm_v1.t_ili2db_basket 
         WHERE 
             topic = 'Nutzungsplanung_V1_2.Geobasisdaten'
        ) AS t_basket, 
        (SELECT 
             datasetname 
         FROM 
             arp_nutzungsplanung_mgdm_v1.t_ili2db_dataset tid 
         WHERE 
             t_id = (SELECT 
                         dataset 
                     FROM 
                         arp_nutzungsplanung_mgdm_v1.t_ili2db_basket 
                     WHERE 
                         topic = 'Nutzungsplanung_V1_2.Geobasisdaten')
        ) AS t_datasetname,
        substring(ilicode FROM 2 FOR 3) AS code, 
        replace(substring(ilicode FROM 6), '_', ' ') AS bezeichnung, 
        substring(ilicode FROM 1 FOR 4) AS abkuerzung,
        hauptnutzung.t_id AS catalogue_ch
    FROM
        arp_nutzungsplanung_v1.erschlssngsplnung_ep_typ_kanton_erschliessung_linienobjekt AS linie
        LEFT JOIN arp_nutzungsplanung_mgdm_v1.catalogue_ch_catalogue_ch AS hauptnutzung
        ON hauptnutzung.acode::INTEGER in (71,71,73,74,75,76,77,78) --Ganzer range der Baulinien
    WHERE 
        hauptnutzung.t_ili_tid IS NOT NULL 
    RETURNING *
)

INSERT INTO arp_nutzungsplanung_mgdm_v1.geobasisdaten_typ 
    (
        t_id,
        t_basket, 
        t_datasetname,
        acode,
        bezeichnung,
        abkuerzung,
        verbindlichkeit,
        bemerkungen,
        typ_kt 
    )
SELECT 
    typ.t_id,
    (SELECT 
         t_id 
     FROM 
         arp_nutzungsplanung_mgdm_v1.t_ili2db_basket 
     WHERE 
         topic = 'Nutzungsplanung_V1_2.Geobasisdaten'
    ) AS t_basket, 
    (SELECT 
         datasetname 
     FROM 
         arp_nutzungsplanung_mgdm_v1.t_ili2db_dataset tid 
     WHERE 
         t_id = (SELECT 
                     dataset 
                 FROM 
                     arp_nutzungsplanung_mgdm_v1.t_ili2db_basket 
                 WHERE 
                     topic = 'Nutzungsplanung_V1_2.Geobasisdaten')
    ) AS t_datasetname,
    typ.code_kommunal AS acode,
    typ.bezeichnung,
    typ.abkuerzung,
    typ.verbindlichkeit,
    typ.bemerkungen,
    typ_kt.t_id
    
FROM
    arp_nutzungsplanung_v1.erschlssngsplnung_typ_erschliessung_linienobjekt AS typ 
    JOIN typ_kt_linie_erschliessung AS typ_kt
    ON typ_kt.acode = substring(typ.typ_kt FROM 2 FOR 3)
WHERE 
    typ.t_datasetname::int4 = xxx_1 (class net.sf.jsqlparser.statement.insert.ParenthesedInsert cannot be cast to class net.sf.jsqlparser.statement.select.ParenthesedSelect (net.sf.jsqlparser.statement.insert.ParenthesedInsert and net.sf.jsqlparser.statement.select.ParenthesedSelect are in unnamed module of loader 'app'))
********************************************************************************
class java.lang.ClassCastException
class net.sf.jsqlparser.statement.insert.ParenthesedInsert cannot be cast to class net.sf.jsqlparser.statement.select.ParenthesedSelect (net.sf.jsqlparser.statement.insert.ParenthesedInsert and net.sf.jsqlparser.statement.select.ParenthesedSelect are in unnamed module of loader 'app')
Error parsing: --HIER 

WITH typ_kt_ueberlagernd_punkt AS (
    INSERT INTO arp_nutzungsplanung_mgdm_v1.geobasisdaten_typ_kt
        (
        t_basket, 
        t_datasetname,
        acode,
        bezeichnung,
        abkuerzung,
        catalogue_ch
        )
    SELECT
        (SELECT 
             t_id 
         FROM 
             arp_nutzungsplanung_mgdm_v1.t_ili2db_basket 
         WHERE 
             topic = 'Nutzungsplanung_V1_2.Geobasisdaten'
        ) AS t_basket, 
        (SELECT 
             datasetname 
         FROM 
             arp_nutzungsplanung_mgdm_v1.t_ili2db_dataset tid 
         WHERE 
             t_id = (SELECT 
                         dataset 
                     FROM 
                         arp_nutzungsplanung_mgdm_v1.t_ili2db_basket 
                     WHERE 
                         topic = 'Nutzungsplanung_V1_2.Geobasisdaten')
        ) AS t_datasetname,
        substring(ilicode FROM 2 FOR 3) AS acode, 
        replace(substring(ilicode FROM 6), '_', ' ') AS bezeichnung, 
        substring(ilicode FROM 1 FOR 4) AS abkuerzung,
        hauptnutzung.t_id AS hauptnutzung_ch
    FROM
        arp_nutzungsplanung_v1.nutzungsplanung_np_typ_kanton_ueberlagernd_punkt AS punkt
        LEFT JOIN arp_nutzungsplanung_mgdm_v1.catalogue_ch_catalogue_ch AS hauptnutzung
        ON hauptnutzung.acode::text = substring(ilicode FROM 2 FOR 2)
    RETURNING *
)

INSERT INTO arp_nutzungsplanung_mgdm_v1.geobasisdaten_typ 
    (
        t_id,
        t_basket, 
        t_datasetname,
        acode,
        bezeichnung,
        abkuerzung,
        verbindlichkeit,
        bemerkungen,
        typ_kt 
    )
SELECT 
    typ.t_id,
    (SELECT 
         t_id 
     FROM 
         arp_nutzungsplanung_mgdm_v1.t_ili2db_basket 
     WHERE 
         topic = 'Nutzungsplanung_V1_2.Geobasisdaten'
    ) AS t_basket, 
    (SELECT 
         datasetname 
     FROM 
         arp_nutzungsplanung_mgdm_v1.t_ili2db_dataset tid 
     WHERE 
         t_id = (SELECT 
                     dataset 
                 FROM 
                     arp_nutzungsplanung_mgdm_v1.t_ili2db_basket 
                 WHERE 
                     topic = 'Nutzungsplanung_V1_2.Geobasisdaten')
    ) AS t_datasetname,
    typ.code_kommunal AS acode,
    typ.bezeichnung,
    typ.abkuerzung,
    typ.verbindlichkeit,
    typ.bemerkungen,
    typ_kt.t_id
    
FROM
    arp_nutzungsplanung_v1.nutzungsplanung_typ_ueberlagernd_punkt AS typ 
    JOIN typ_kt_ueberlagernd_punkt AS typ_kt
    ON typ_kt.acode = substring(typ.typ_kt FROM 2 FOR 3)
WHERE 
    typ.t_datasetname::int4 = xxx_1 (class net.sf.jsqlparser.statement.insert.ParenthesedInsert cannot be cast to class net.sf.jsqlparser.statement.select.ParenthesedSelect (net.sf.jsqlparser.statement.insert.ParenthesedInsert and net.sf.jsqlparser.statement.select.ParenthesedSelect are in unnamed module of loader 'app'))
********************************************************************************
class java.lang.ClassCastException
class net.sf.jsqlparser.statement.insert.ParenthesedInsert cannot be cast to class net.sf.jsqlparser.statement.select.ParenthesedSelect (net.sf.jsqlparser.statement.insert.ParenthesedInsert and net.sf.jsqlparser.statement.select.ParenthesedSelect are in unnamed module of loader 'app')
Error parsing: WITH multilingualuri AS
(
    INSERT INTO
        arp_nutzungsplanung_mgdm_v1.multilingualuri
        (
            t_id,
            t_basket,
            t_datasetname,
            t_seq,
            rechtsvrschrftn_dkment_textimweb
        )
    SELECT
        nextval('arp_nutzungsplanung_mgdm_v1.t_ili2db_seq'::regclass) AS t_id,
        (SELECT 
             t_id 
         FROM 
             arp_nutzungsplanung_mgdm_v1.t_ili2db_basket 
         WHERE 
             topic = 'Nutzungsplanung_V1_2.Rechtsvorschriften'
        ) AS t_basket, 
        (SELECT 
             datasetname 
         FROM 
             arp_nutzungsplanung_mgdm_v1.t_ili2db_dataset tid 
         WHERE 
             t_id = (SELECT 
                         dataset 
                     FROM 
                         arp_nutzungsplanung_mgdm_v1.t_ili2db_basket 
                     WHERE 
                         topic = 'Nutzungsplanung_V1_2.Rechtsvorschriften')
        ) AS t_datasetname,
        0 AS t_seq,
        rechtsvorschrften_dokument.t_id AS rechtsvrschrftn_dkment_textimweb
    FROM
        arp_nutzungsplanung_mgdm_v1.rechtsvorschrften_dokument AS rechtsvorschrften_dokument
    WHERE 
        t_datasetname::int4 = xxx_1 
    RETURNING *
)
,
localiseduri AS 
(
    SELECT 
        nextval('arp_nutzungsplanung_mgdm_v1.t_ili2db_seq'::regclass) AS t_id,
        (SELECT 
             t_id 
         FROM 
             arp_nutzungsplanung_mgdm_v1.t_ili2db_basket 
         WHERE 
             topic = 'Nutzungsplanung_V1_2.Rechtsvorschriften'
        ) AS t_basket, 
        (SELECT 
             datasetname 
         FROM 
             arp_nutzungsplanung_mgdm_v1.t_ili2db_dataset tid 
         WHERE 
             t_id = (SELECT 
                         dataset 
                     FROM 
                         arp_nutzungsplanung_mgdm_v1.t_ili2db_basket 
                     WHERE 
                         topic = 'Nutzungsplanung_V1_2.Rechtsvorschriften')
        ) AS t_datasetname,      
        0 AS t_seq,
        'de' AS alanguage,
        textimweb AS atext,
        multilingualuri.t_id AS multilingualuri_localisedtext
    FROM
        arp_nutzungsplanung_v1.rechtsvorschrften_dokument AS rechtsvorschrften_dokument
        RIGHT JOIN multilingualuri 
        ON multilingualuri.rechtsvrschrftn_dkment_textimweb = rechtsvorschrften_dokument.t_id
    WHERE 
        rechtsvorschrften_dokument.t_datasetname::int4 = xxx_1
)
INSERT INTO
    arp_nutzungsplanung_mgdm_v1.localiseduri
    (
        t_id,
        t_basket,
        t_datasetname,
        t_seq,
        alanguage,
        atext,
        multilingualuri_localisedtext
    )
    SELECT 
        t_id,
        t_basket,
        t_datasetname,
        t_seq,
        alanguage,
        coalesce (atext,'https://planregister-data.so.ch/public/kanton/Dokument-nicht-digital-verfuegbar.pdf') AS atext, --Wenn kein Dokument vorhanden, soll auf dieses Dokument verwiesen werden,
        multilingualuri_localisedtext
    FROM 
        localiseduri (class net.sf.jsqlparser.statement.insert.ParenthesedInsert cannot be cast to class net.sf.jsqlparser.statement.select.ParenthesedSelect (net.sf.jsqlparser.statement.insert.ParenthesedInsert and net.sf.jsqlparser.statement.select.ParenthesedSelect are in unnamed module of loader 'app'))
********************************************************************************
--------------------------------------------------------------------------------
arp_nutzungsplanung_pub/truncate_all_arp_planungszonen_mgdm_tables.sql
--------------------------------------------------------------------------------
arp_nutzungsplanung_pub/truncate_all_arp_npl_mgdm_tables.sql
--------------------------------------------------------------------------------
arp_nutzungsplanung_pub/delete_arp_nutzungsplanung_transfer_pub.sql
--------------------------------------------------------------------------------
arp_nutzungsplanung_pub/delete_arp_nutzungsplanung_planregister_pub_doppelte_dokumente.sql
--------------------------------------------------------------------------------
arp_nutzungsplanung_pub/insert_arp_nutzungsplanung_planregister_pub_kommunal.sql
--------------------------------------------------------------------------------
awjf_gesuchsteller/delete_from_awjf_gesuchsteller.sql
--------------------------------------------------------------------------------
afu_abwasserbauwerke_pub/afu_abwasserbauwerke_pub_schaechte_und_bauwerke.sql
--------------------------------------------------------------------------------
afu_abwasserbauwerke_pub/afu_abwasserbauwerke_pub_leitungen.sql
--------------------------------------------------------------------------------
afu_abwasserbauwerke_pub/afu_abwasserbauwerke_pub_ara.sql
--------------------------------------------------------------------------------
avt_oevkov/insert_haltestellenbuffer.sql
--------------------------------------------------------------------------------
avt_oevkov/insert_gtfs_auswertung.sql
--------------------------------------------------------------------------------
avt_oevkov/update_linie_stichtag.sql
--------------------------------------------------------------------------------
avt_oevkov/insert_gesamtauswertung_korrekturen.sql
--------------------------------------------------------------------------------
avt_oevkov/update_gtfs_auswertung_gewichtung.sql
--------------------------------------------------------------------------------
avt_oevkov/insert_gesamtauswertung.sql
--------------------------------------------------------------------------------
avt_oevkov/update_kosten.sql
--------------------------------------------------------------------------------
awjf_seltene_baeume_pub/awjf_seltene_baeume_freistellung.sql
--------------------------------------------------------------------------------
awjf_seltene_baeume_pub/awjf_seltene_baeume_pflanzung.sql
--------------------------------------------------------------------------------
agi_mopublic_pub/dataset/create_bfs_dsets.sql
class net.sf.jsqlparser.JSQLParserException
net.sf.jsqlparser.parser.ParseException: Encountered unexpected token: "xxx_1" <S_IDENTIFIER>
    at line 1, column 20.

Was expecting one of:

    ","
    <EOF>
    <ST_SEMICOLON>

Error parsing: SET search_path TO xxx_1 (net.sf.jsqlparser.parser.ParseException: Encountered unexpected token: "xxx_1" <S_IDENTIFIER>
    at line 1, column 20.

Was expecting one of:

    ","
    <EOF>
    <ST_SEMICOLON>
)
********************************************************************************
class java.lang.ClassCastException
class net.sf.jsqlparser.statement.insert.ParenthesedInsert cannot be cast to class net.sf.jsqlparser.statement.select.ParenthesedSelect (net.sf.jsqlparser.statement.insert.ParenthesedInsert and net.sf.jsqlparser.statement.select.ParenthesedSelect are in unnamed module of loader 'app')
Error parsing: WITH 

bfs_nr AS (
    SELECT DISTINCT 
        bfs_nr::text AS bfs_nr_txt
    FROM
        mopublic_gemeindegrenze
),

dataset AS (
    INSERT INTO 
        t_ili2db_dataset(
            t_id,
            datasetname 
        )
    SELECT 
        nextval('t_ili2db_seq'),
        bfs_nr_txt
    FROM
        bfs_nr
    RETURNING *
),

topic AS (
    SELECT 
        topic
    FROM 
        t_ili2db_basket
    WHERE 
        t_id = 1
)

INSERT INTO 
    t_ili2db_basket(
        t_id,
        dataset,
        topic,
        t_ili_tid,
        attachmentkey
    )
SELECT 
    nextval('t_ili2db_seq') AS t_id,
    ds.t_id,
    topic,
    bfs_nr_txt AS t_ili_tid,
    bfs_nr_txt AS attachmentkey
FROM 
    bfs_nr bfs
JOIN
    dataset ds ON bfs.bfs_nr_txt = ds.datasetname
CROSS JOIN 
    topic (class net.sf.jsqlparser.statement.insert.ParenthesedInsert cannot be cast to class net.sf.jsqlparser.statement.select.ParenthesedSelect (net.sf.jsqlparser.statement.insert.ParenthesedInsert and net.sf.jsqlparser.statement.select.ParenthesedSelect are in unnamed module of loader 'app'))
********************************************************************************
--------------------------------------------------------------------------------
agi_mopublic_pub/dataset/update_basket_refs.sql
class net.sf.jsqlparser.JSQLParserException
net.sf.jsqlparser.parser.ParseException: Encountered unexpected token: "xxx_1" <S_IDENTIFIER>
    at line 1, column 20.

Was expecting one of:

    ","
    <EOF>
    <ST_SEMICOLON>

Error parsing: SET search_path TO xxx_1 (net.sf.jsqlparser.parser.ParseException: Encountered unexpected token: "xxx_1" <S_IDENTIFIER>
    at line 1, column 20.

Was expecting one of:

    ","
    <EOF>
    <ST_SEMICOLON>
)
********************************************************************************
--------------------------------------------------------------------------------
agi_mopublic_pub/db2db/agi_mopublic_pub_mopublic_rohrleitung.sql
--------------------------------------------------------------------------------
agi_mopublic_pub/db2db/agi_mopublic_pub_mopublic_flurname.sql
--------------------------------------------------------------------------------
agi_mopublic_pub/db2db/agi_mopublic_pub_mopublic_einzelobjekt_flaeche.sql
--------------------------------------------------------------------------------
agi_mopublic_pub/db2db/agi_mopublic_pub_mopublic_einzelobjekt_linie.sql
--------------------------------------------------------------------------------
agi_mopublic_pub/db2db/agi_mopublic_pub_mopublic_grundstueck_proj_linie.sql
--------------------------------------------------------------------------------
agi_mopublic_pub/db2db/agi_mopublic_pub_mopublic_objektname_pos.sql
--------------------------------------------------------------------------------
agi_mopublic_pub/db2db/agi_mopublic_pub_mopublic_strassenachse.sql
--------------------------------------------------------------------------------
agi_mopublic_pub/db2db/agi_mopublic_pub_mopublic_hoheitsgrenzpunkt.sql
--------------------------------------------------------------------------------
agi_mopublic_pub/db2db/agi_mopublic_pub_mopublic_grundstueck_proj.sql
--------------------------------------------------------------------------------
agi_mopublic_pub/db2db/agi_mopublic_pub_mopublic_ortsname.sql
--------------------------------------------------------------------------------
agi_mopublic_pub/db2db/agi_mopublic_pub_mopublic_gebaeudeadresse.sql
--------------------------------------------------------------------------------
agi_mopublic_pub/db2db/agi_mopublic_pub_mopublic_bodenbedeckung_proj.sql
--------------------------------------------------------------------------------
agi_mopublic_pub/db2db/agi_mopublic_pub_mopublic_bodenbedeckung.sql
--------------------------------------------------------------------------------
agi_mopublic_pub/db2db/agi_mopublic_pub_mopublic_gemeindegrenze.sql
--------------------------------------------------------------------------------
agi_mopublic_pub/db2db/agi_mopublic_pub_mopublic_fixpunkt.sql
--------------------------------------------------------------------------------
agi_mopublic_pub/db2db/agi_mopublic_pub_mopublic_einzelobjekt_punkt.sql
--------------------------------------------------------------------------------
agi_mopublic_pub/db2db/agi_mopublic_pub_mopublic_gemeindegrenze_proj.sql
--------------------------------------------------------------------------------
agi_mopublic_pub/db2db/agi_mopublic_pub_mopublic_grenzpunkt.sql
--------------------------------------------------------------------------------
agi_mopublic_pub/db2db/agi_mopublic_pub_mopublic_grundstueck.sql
--------------------------------------------------------------------------------
agi_mopublic_pub/db2db/agi_mopublic_pub_mopublic_grundstueck_linie.sql
--------------------------------------------------------------------------------
agi_mopublic_pub/db2db/agi_mopublic_pub_mopublic_strassenname_pos.sql
--------------------------------------------------------------------------------
agi_mopublic_pub/db2db/agi_mopublic_pub_mopublic_gelaendename.sql
--------------------------------------------------------------------------------
awjf_waldplan_bestandeskarte_staging/awjf_waldplan_bestandeskarte_staging_review.sql
--------------------------------------------------------------------------------
awjf_waldplan_bestandeskarte_staging/awjf_waldplan_bestandeskarte_staging.sql
class net.sf.jsqlparser.JSQLParserException
net.sf.jsqlparser.parser.ParseException: Encountered unexpected token: "xxx_1" <S_IDENTIFIER>
    at line 177, column 1.

Was expecting one of:

    <EOF>
    <ST_SEMICOLON>

Error parsing: SELECT
    waldplan_bestandeskarte.geometrie,
    id_wp,
    fid_amtei,
    fid_fk,
    fid_fr,
    wirt_zone,
    gem_bfs,
    fid_we,
    round(gb_flaeche,0) AS gb_flaeche,
    we_text,
    fid_eigcod,
    fid_eig,
    fid_prod,
    wpnr,
    wptyp,
    betriebsteil,
    fid_abt,
    bstnr,
    bsttyp,
    wpinfo,
    bemerkung,
    round(flae_gis::numeric,0) AS flae_gis,
    zeitstand,
    beschrift,
    x_beschr,
    y_beschr,
    objnummer,
    weidewald,
    gb_gem_bfs,
    astatus,
    hoheitsgrenzen_gemeindegrenze.gemeindename,
    CASE 
        WHEN fid_eig = 1000
            THEN '1000 - Bundeswald' 
        WHEN fid_eig = 2000
            THEN '2000 - Staatswald'
        WHEN fid_eig = 3100
            THEN '3100 - Bürgergemeinde'
        WHEN fid_eig = 3200
            THEN '3200 - Einwohnergemeinde'
        WHEN fid_eig = 3300
            THEN '3300 - Einheitsgemeinde'
        WHEN fid_eig = 4000
            THEN '4000 - Öffentlich (gemischt)'
        WHEN fid_eig = 5000
            THEN '5000 - Gemischt öffentlich privat'
        WHEN fid_eig = 6000
            THEN '6000 - Privat'
        WHEN fid_eig = 7000
            THEN '7000 - Privat (gemischt)'
    END AS fid_eig_text,
    CASE 
        WHEN wpnr = 501 
            THEN '501 - Wirtschaftswald' 
        WHEN wpnr = 502 
            THEN '502 - Schutzwald' 
        WHEN wpnr = 503 
            THEN '503 - Erholungswald' 
        WHEN wpnr = 504 
            THEN '504 - Natur und Landschaft'
        WHEN wpnr = 505 
            THEN '505 - Schutzwald / Natur und Landschaft' 
        WHEN wpnr = 509 
            THEN '509 - Nicht Wald'
    END AS wpnr_text,
    CASE 
        WHEN wptyp = 1 
            THEN '1 - Mit Wald bestockt' 
        WHEN wptyp = 2
            THEN '2 - Niederhaltezone'
        WHEN wptyp = 3 
            THEN '3 - Waldstrasse'
        WHEN wptyp = 4
            THEN '4 - Maschinenweg'
        WHEN wptyp = 5
            THEN '5 - Bauten und Anlagen'
        WHEN wptyp = 6
            THEN '6 - Rodungsfläche (temporär)'
        WHEN wptyp = 7
            THEN '7 - Gewässer'
        WHEN wptyp = 8
            THEN '8 - Abbaustelle'
        WHEN wptyp = 9
            THEN '9 - Nicht Wald'
    END AS wptyp_text,
    CASE
        WHEN betriebsteil = 1
            THEN concat_ws(' - ', betriebsteil, 'Talwald')
        WHEN betriebsteil = 2
            THEN concat_ws(' - ', betriebsteil, 'Bergwald')
        WHEN betriebsteil = 3
            THEN concat_ws(' - ', betriebsteil, 'Vorberg')
        WHEN betriebsteil = 4
            THEN concat_ws(' - ', betriebsteil, 'Sonnseite')
        WHEN betriebsteil = 5
            THEN concat_ws(' - ', betriebsteil, 'Schattseite')
        WHEN betriebsteil = 6
            THEN concat_ws(' - ', betriebsteil, 'Lebern-Klus')
        WHEN betriebsteil = 7
            THEN concat_ws(' - ', betriebsteil, 'Aebisholz')
        WHEN betriebsteil = 8
            THEN concat_ws(' - ', betriebsteil, 'Jurawald')
        WHEN  betriebsteil = 9
            THEN concat_ws(' - ', betriebsteil, 'Bornwald')
    END AS betriebsteil_text,
    CASE
        WHEN
            bsttyp >= 10
            AND
            bsttyp <= 14
                THEN 'Jungwuchs/Dickung (10-14)'
        WHEN
            bsttyp >= 21
            AND
            bsttyp <= 24
                THEN 'Stangenholz (21-24)'
        WHEN
            bsttyp >= 31
            AND
            bsttyp <= 34
                THEN 'Schwaches Baumholz (31-34)'
        WHEN
            bsttyp >= 41
            AND
            bsttyp <= 44
                THEN 'Mittleres Baumholz (41-44)'
        WHEN
            bsttyp >= 51
            AND
            bsttyp <= 54
                THEN 'Starkes Baumholz (51-54)'
        WHEN
            bsttyp >= 61
            AND
            bsttyp <= 64
                THEN 'St. Baumholz aufgelockert (61-64)'
        WHEN 
            bsttyp >= 70
            AND
            bsttyp <= 74
                THEN 'Übriger Wald ausser Bewirtschaftung (70-74)'
        WHEN bsttyp = 75
            THEN 'Altholzinsel (75)'
        WHEN bsttyp = 76
            THEN 'Andere Förderfläche (76)'
        WHEN bsttyp = 77
            THEN 'Waldrand (77)'
        WHEN bsttyp = 79
            THEN 'Waldreservat mit Vereinbarung (79)'
        WHEN
            bsttyp >= 81
            AND
            bsttyp <= 84
                THEN 'Dauerwald / Plenterwald (81-84)'
        WHEN
            bsttyp >= 210
            AND
            bsttyp <= 214
                THEN 'Mittelwald (210-214)'
        WHEN
            bsttyp >= 200
            AND
            bsttyp <= 204
                THEN 'Niederwald (200-204)'
    END AS bsttyp_text
FROM
    awjf_waldplan_bestandeskarte_v1.waldplan_bestandeskarte
    LEFT JOIN agi_hoheitsgrenzen_pub.hoheitsgrenzen_gemeindegrenze
    ON hoheitsgrenzen_gemeindegrenze.bfs_gemeindenummer = waldplan_bestandeskarte.gem_bfs
WHERE
    astatus = 'abgeschlossen'
AND
    id_wp > 0
AND
    wptyp < 9
xxx_1 (net.sf.jsqlparser.parser.ParseException: Encountered unexpected token: "xxx_1" <S_IDENTIFIER>
    at line 177, column 1.

Was expecting one of:

    <EOF>
    <ST_SEMICOLON>
)
********************************************************************************
--------------------------------------------------------------------------------
awjf_waldplan_bestandeskarte_staging/delete_awjf_waldplan_bestandeskarte_staging.sql
--------------------------------------------------------------------------------
amb_sirenenplanung_pub/amb_sirenenplanung_pub.sql
--------------------------------------------------------------------------------
alw_zonengrenzen_import/alw_zonengrenzen_pub.sql
--------------------------------------------------------------------------------
alw_zonengrenzen_import/delete_landwirtschaftliche_zonengrenzen_tables.sql
--------------------------------------------------------------------------------
agi_baulinien_pub/agi_baulinien_pub_baulinie.sql
--------------------------------------------------------------------------------
afu_fischwanderhindernisse_pub/afu_fischwanderhindernisse_pub.sql
--------------------------------------------------------------------------------
afu_naturereigniskataster_mgdm_import/prozessraum_prozess_anderer_pub.sql
--------------------------------------------------------------------------------
afu_naturereigniskataster_mgdm_import/sammelereignis_pub.sql
--------------------------------------------------------------------------------
afu_naturereigniskataster_mgdm_import/prozessraum_rutschung_pub.sql
--------------------------------------------------------------------------------
afu_naturereigniskataster_mgdm_import/prozessraum_sturz_pub.sql
--------------------------------------------------------------------------------
afu_naturereigniskataster_mgdm_import/prozessraum_wasser_pub.sql
--------------------------------------------------------------------------------
afu_naturereigniskataster_mgdm_import/basisinformationen_pub.sql
--------------------------------------------------------------------------------
afu_naturereigniskataster_mgdm_import/prozessraum_einsturz_absenkung_pub.sql
--------------------------------------------------------------------------------
afu_naturereigniskataster_mgdm_import/prozessraum_lawine_pub.sql
--------------------------------------------------------------------------------
awjf_efj/efj.sql
--------------------------------------------------------------------------------
sk_plakatstandorte/standorte_pub.sql
--------------------------------------------------------------------------------
sk_plakatstandorte/delete_sk_plakatstandorte_standorte.sql
--------------------------------------------------------------------------------
sk_plakatstandorte/addgeometrie.sql
--------------------------------------------------------------------------------
afu_naturgefahren_freigeben/freigeben.sql
--------------------------------------------------------------------------------
afu_stoerfallverordnung_pub/afu_stoerfallverordnung_pub_durchgangsstrassen.sql
--------------------------------------------------------------------------------
afu_stoerfallverordnung_pub/afu_stoerfallverordnung_pub_nationalstrassen.sql
--------------------------------------------------------------------------------
afu_stoerfallverordnung_pub/afu_stoerfallverordnung_pub_erdgasroehrenspeicher.sql
--------------------------------------------------------------------------------
afu_stoerfallverordnung_pub/afu_stoerfallverordnung_pub_durchgangsstrassen_kb.sql
--------------------------------------------------------------------------------
afu_stoerfallverordnung_pub/afu_stoerfallverordnung_pub_betriebe_kb.sql
--------------------------------------------------------------------------------
afu_stoerfallverordnung_pub/afu_stoerfallverordnung_pub_betriebsareal.sql
--------------------------------------------------------------------------------
afu_stoerfallverordnung_pub/afu_stoerfallverordnung_pub_erdgasroehrenspeicher_kb.sql
--------------------------------------------------------------------------------
afu_stoerfallverordnung_pub/afu_stoerfallverordnung_pub_betriebe.sql
--------------------------------------------------------------------------------
afu_stoerfallverordnung_pub/afu_stoerfallverordnung_pub_nationalstrassen_kb.sql
--------------------------------------------------------------------------------
arp_wanderwege_pub/arp_wanderwege_pub_route.sql
--------------------------------------------------------------------------------
arp_wanderwege_pub/arp_wanderwege_pub_signalisation.sql
--------------------------------------------------------------------------------
arp_wanderwege_pub/update_standort_link.sql
--------------------------------------------------------------------------------
arp_wanderwege_pub/arp_wanderwege_pub_wanderweg.sql
--------------------------------------------------------------------------------
afu_gewaesser_oekomorphologie_pub/bauwerk.sql
--------------------------------------------------------------------------------
afu_gewaesser_oekomorphologie_pub/update_boolean_enum_txt_col.sql
--------------------------------------------------------------------------------
afu_gewaesser_oekomorphologie_pub/update_enum_txt_col.sql
--------------------------------------------------------------------------------
afu_gewaesser_oekomorphologie_pub/absturz.sql
--------------------------------------------------------------------------------
afu_gewaesser_oekomorphologie_pub/oekomorphologie.sql
--------------------------------------------------------------------------------
afu_klimaanalyse_windpfeile_pub/windpfeile_300m_zukunft_pub.sql
--------------------------------------------------------------------------------
afu_klimaanalyse_windpfeile_pub/windpfeile_500m_zukunft_pub.sql
--------------------------------------------------------------------------------
afu_klimaanalyse_windpfeile_pub/windpfeile_300m_ist_pub.sql
--------------------------------------------------------------------------------
afu_klimaanalyse_windpfeile_pub/windpfeile_500m_ist_pub.sql
--------------------------------------------------------------------------------
afu_klimaanalyse_windpfeile_pub/windpfeile_200m_ist_pub.sql
--------------------------------------------------------------------------------
afu_klimaanalyse_windpfeile_pub/windpfeile_50m_zukunft_pub.sql
--------------------------------------------------------------------------------
afu_klimaanalyse_windpfeile_pub/windpfeile_200m_zukunft_pub.sql
--------------------------------------------------------------------------------
afu_klimaanalyse_windpfeile_pub/windpfeile_100m_zukunft_pub.sql
--------------------------------------------------------------------------------
afu_klimaanalyse_windpfeile_pub/windpfeile_10m_ist_pub.sql
--------------------------------------------------------------------------------
afu_klimaanalyse_windpfeile_pub/windpfeile_100m_ist_pub.sql
--------------------------------------------------------------------------------
afu_klimaanalyse_windpfeile_pub/windpfeile_10m_zukunft_pub.sql
--------------------------------------------------------------------------------
afu_klimaanalyse_windpfeile_pub/windpfeile_50m_ist_pub.sql
--------------------------------------------------------------------------------
afu_immissionskarten_luft_pub/afu_immissionskarten_pub_luftbelastung_2010_2020.sql
--------------------------------------------------------------------------------
afu_neophyten_pub/publish.sql
--------------------------------------------------------------------------------
afu_neophyten_pub/csv_to_tbl.sql
class java.lang.UnsupportedOperationException
Finding tables from SetStatement is not supported
Error parsing: SET file_search_path = xxx_1 (Finding tables from SetStatement is not supported)
********************************************************************************
--------------------------------------------------------------------------------
awjf_silvaprotect_pub/awjf_silvaprotect_lawine.sql
--------------------------------------------------------------------------------
awjf_silvaprotect_pub/awjf_silvaprotect_rutschung.sql
--------------------------------------------------------------------------------
awjf_silvaprotect_pub/awjf_silvaprotect_andere_kt.sql
--------------------------------------------------------------------------------
awjf_silvaprotect_pub/awjf_silvaprotect_gerinne.sql
--------------------------------------------------------------------------------
awjf_silvaprotect_pub/awjf_silvaprotect_steinschlag.sql
--------------------------------------------------------------------------------
agi_dmav_plz_ortschaft_export/delete_data.sql
--------------------------------------------------------------------------------
agi_dmav_plz_ortschaft_export/insert_data.sql
class java.lang.ClassCastException
class net.sf.jsqlparser.statement.insert.ParenthesedInsert cannot be cast to class net.sf.jsqlparser.statement.select.ParenthesedSelect (net.sf.jsqlparser.statement.insert.ParenthesedInsert and net.sf.jsqlparser.statement.select.ParenthesedSelect are in unnamed module of loader 'app')
Error parsing: -- Die TID werden einfach rüberkopiert. Das funktioniert
-- weil wir keine neuen Daten / neue Records erzeugen.
WITH basket AS 
(
    SELECT 
        t_id AS basket_t_id
    FROM 
        agi_dmav_plz_ortschaften_export_v1.t_ili2db_basket
)
,
gemeinde AS 
(
    SELECT
        bfs_gemeindenummer AS bfsnr,
        geometrie
    FROM 
        agi_hoheitsgrenzen_pub.hoheitsgrenzen_gemeindegrenze 
    WHERE 
        bfs_gemeindenummer = xxx_1
) 
-- Weil beide Klassen eine Geometrie haben, kann es mit beiden
-- Geometrie zu Overlaps führen und wegen der Beziehung zwischen
-- beiden Klassen muss ich jeweils auch beide Klassen miteinbeziehen.
-- Im Anschluss wird gemerged und allensfalls doppelte Einträge
-- ignoriert.
,
plz_ortschaft_top_down AS 
(
    SELECT 
        --ST_Area(ST_CollectionExtract(ST_Intersection(gemeinde.geometrie, ortschaft.ageometry), 3)),
        --ST_MaximumInscribedCircle(ST_CollectionExtract(ST_Intersection(gemeinde.geometrie, ortschaft.ageometry), 3)),
        ortschaft.t_id AS o_t_id,
        basket.basket_t_id,
        ortschaft.ageometry AS ortschaft_geometrie,
        ortschaft.localityname AS amtlicherortschaftsname,
        plz.t_id AS p_t_id,
        plz.ageometry AS plz_geometrie,
        plz.zip4 AS plz4,
        plz.additionalnumber AS zusatzziffer
    
    FROM 
        agi_plz_ortschaften_v1.officlndxflclties_locality AS ortschaft
        LEFT JOIN gemeinde 
        ON ST_Intersects(gemeinde.geometrie, ortschaft.ageometry)
        LEFT JOIN agi_plz_ortschaften_v1.officlndxflclties_zip AS plz 
        ON plz.locality = ortschaft.t_id 
        LEFT JOIN basket
        ON 1=1
    WHERE 
        bfsnr = xxx_1
    AND 
        -- Zukünftig mit ST_MaximumInscribedCircle 
        ST_Area(ST_CollectionExtract(ST_Intersection(gemeinde.geometrie, ortschaft.ageometry), 3)) > 1
)
,
plz_ortschaft_bottom_up AS 
(
    SELECT 
        --ST_Area(ST_CollectionExtract(ST_Intersection(gemeinde.geometrie, ortschaft.ageometry), 3)),
        --ST_MaximumInscribedCircle(ST_CollectionExtract(ST_Intersection(gemeinde.geometrie, ortschaft.ageometry), 3)),
        ortschaft.t_id AS o_t_id,
        basket.basket_t_id,
        ortschaft.ageometry AS ortschaft_geometrie,
        ortschaft.localityname AS amtlicherortschaftsname,
        plz.t_id AS p_t_id,
        plz.ageometry AS plz_geometrie,
        plz.zip4 AS plz4,
        plz.additionalnumber AS zusatzziffer
    
    FROM 
        agi_plz_ortschaften_v1.officlndxflclties_zip AS plz
        LEFT JOIN gemeinde 
        ON ST_Intersects(gemeinde.geometrie, plz.ageometry)
        LEFT JOIN agi_plz_ortschaften_v1.officlndxflclties_locality AS ortschaft 
        ON plz.locality = ortschaft.t_id 
        LEFT JOIN basket
        ON 1=1
    WHERE 
        bfsnr = xxx_1
    AND 
        -- Zukünftig mit ST_MaximumInscribedCircle 
        ST_Area(ST_CollectionExtract(ST_Intersection(gemeinde.geometrie, ortschaft.ageometry), 3)) > 1
)
,
plz_ortschaft_merge AS 
(
    SELECT 
        o_t_id,
        basket_t_id,
        ortschaft_geometrie,
        amtlicherortschaftsname,
        p_t_id, 
        plz_geometrie,
        plz4,
        zusatzziffer
    FROM 
        plz_ortschaft_top_down
    UNION 
    SELECT 
        o_t_id,
        basket_t_id,
        ortschaft_geometrie,
        amtlicherortschaftsname,
        p_t_id, 
        plz_geometrie,
        plz4,
        zusatzziffer
    FROM 
        plz_ortschaft_bottom_up
)
,
-- Ortschaften können mehrmals vorkommen, da das Merge-Resultat 
-- denormalisiert ist und eine Ortschaft mehrere PLZ haben kann.
ortschaft_insert AS 
(
    INSERT INTO
        agi_dmav_plz_ortschaften_export_v1.plz_ortschaft_ortschaft 
    (
        t_id,
        t_basket,
        geometrie,
        amtlicherortschaftsname
    )
    SELECT DISTINCT ON (o_t_id)
        o_t_id,
        basket_t_id,
        ortschaft_geometrie,
        amtlicherortschaftsname
    FROM 
        plz_ortschaft_merge
)
-- PLZ kommen im Merge-Resultate nur einmal vor und es muss
-- nicht distinct werden.
INSERT INTO
    agi_dmav_plz_ortschaften_export_v1.plz_ortschaft_plz 
    (
        t_id,
        t_basket,
        geometrie,
        plz4,
        zusatzziffer,
        ortschaft
    )
    SELECT 
        p_t_id, 
        basket_t_id,
        plz_geometrie,
        plz4,
        CAST(zusatzziffer AS int),
        o_t_id
    FROM 
        plz_ortschaft_merge (class net.sf.jsqlparser.statement.insert.ParenthesedInsert cannot be cast to class net.sf.jsqlparser.statement.select.ParenthesedSelect (net.sf.jsqlparser.statement.insert.ParenthesedInsert and net.sf.jsqlparser.statement.select.ParenthesedSelect are in unnamed module of loader 'app'))
********************************************************************************
--------------------------------------------------------------------------------
alw_fruchtfolgeflaechen_pub/fff_statistik.sql
--------------------------------------------------------------------------------
alw_fruchtfolgeflaechen_pub/fff_to_pub_db.sql
--------------------------------------------------------------------------------
arp_mjpnl_auszahlung/update_mjpnl_abrechnung_per_vereinbarung.sql
--------------------------------------------------------------------------------
arp_mjpnl_auszahlung/update_mjpnl_abrechnung_per_leistung.sql
--------------------------------------------------------------------------------
arp_mjpnl_auszahlung/update_mjpnl_abrechnung_per_bewirtschafter.sql
--------------------------------------------------------------------------------
agi_gb2av_controlling/agi_gb2av_controlling_pub_controlling_av2gb_mutationen.sql
--------------------------------------------------------------------------------
agi_gb2av_controlling/agi_gb2av_controlling_av_mutationen.sql
--------------------------------------------------------------------------------
agi_gb2av_controlling/agi_gb2av_controlling_pub_controlling_gb2av_vollzugsmeldung_delta.sql
--------------------------------------------------------------------------------
agi_gb2av_controlling/agi_gb2av_controlling_vollzugsmeldungen.sql
--------------------------------------------------------------------------------
awjf_wildtierkorridore_pub/awjf_wildstrukturen_pub.sql
--------------------------------------------------------------------------------
awjf_wildtierkorridore_pub/awjf_wildtierkorridore_pub.sql
--------------------------------------------------------------------------------
awjf_wildtierkorridore_pub/awjf_wildbarriere_linien_pub.sql
--------------------------------------------------------------------------------
awjf_wildtierkorridore_pub/awjf_wildbarriere_flaechen_pub.sql
--------------------------------------------------------------------------------
agi_av_dm01_mopublic_pub/2_mopublic/dataset/create_bfs_dsets.sql
class net.sf.jsqlparser.JSQLParserException
net.sf.jsqlparser.parser.ParseException: Encountered unexpected token: "xxx_1" <S_IDENTIFIER>
    at line 1, column 20.

Was expecting one of:

    ","
    <EOF>
    <ST_SEMICOLON>

Error parsing: SET search_path TO xxx_1 (net.sf.jsqlparser.parser.ParseException: Encountered unexpected token: "xxx_1" <S_IDENTIFIER>
    at line 1, column 20.

Was expecting one of:

    ","
    <EOF>
    <ST_SEMICOLON>
)
********************************************************************************
class java.lang.ClassCastException
class net.sf.jsqlparser.statement.insert.ParenthesedInsert cannot be cast to class net.sf.jsqlparser.statement.select.ParenthesedSelect (net.sf.jsqlparser.statement.insert.ParenthesedInsert and net.sf.jsqlparser.statement.select.ParenthesedSelect are in unnamed module of loader 'app')
Error parsing: WITH 

bfs_nr AS (
    SELECT DISTINCT 
        bfs_nr::text AS bfs_nr_txt
    FROM
        mopublic_gemeindegrenze
),

dataset AS (
    INSERT INTO 
        t_ili2db_dataset(
            t_id,
            datasetname 
        )
    SELECT 
        nextval('t_ili2db_seq'),
        bfs_nr_txt
    FROM
        bfs_nr
    RETURNING *
),

topic AS (
    SELECT 
        topic
    FROM 
        t_ili2db_basket
    WHERE 
        t_id = 1
)

INSERT INTO 
    t_ili2db_basket(
        t_id,
        dataset,
        topic,
        t_ili_tid,
        attachmentkey
    )
SELECT 
    nextval('t_ili2db_seq') AS t_id,
    ds.t_id,
    topic,
    bfs_nr_txt AS t_ili_tid,
    bfs_nr_txt AS attachmentkey
FROM 
    bfs_nr bfs
JOIN
    dataset ds ON bfs.bfs_nr_txt = ds.datasetname
CROSS JOIN 
    topic (class net.sf.jsqlparser.statement.insert.ParenthesedInsert cannot be cast to class net.sf.jsqlparser.statement.select.ParenthesedSelect (net.sf.jsqlparser.statement.insert.ParenthesedInsert and net.sf.jsqlparser.statement.select.ParenthesedSelect are in unnamed module of loader 'app'))
********************************************************************************
--------------------------------------------------------------------------------
agi_av_dm01_mopublic_pub/2_mopublic/dataset/update_basket_refs.sql
class net.sf.jsqlparser.JSQLParserException
net.sf.jsqlparser.parser.ParseException: Encountered unexpected token: "xxx_1" <S_IDENTIFIER>
    at line 1, column 20.

Was expecting one of:

    ","
    <EOF>
    <ST_SEMICOLON>

Error parsing: SET search_path TO xxx_1 (net.sf.jsqlparser.parser.ParseException: Encountered unexpected token: "xxx_1" <S_IDENTIFIER>
    at line 1, column 20.

Was expecting one of:

    ","
    <EOF>
    <ST_SEMICOLON>
)
********************************************************************************
--------------------------------------------------------------------------------
agi_av_dm01_mopublic_pub/2_mopublic/db2db/agi_mopublic_pub_mopublic_rohrleitung.sql
--------------------------------------------------------------------------------
agi_av_dm01_mopublic_pub/2_mopublic/db2db/agi_mopublic_pub_mopublic_flurname.sql
--------------------------------------------------------------------------------
agi_av_dm01_mopublic_pub/2_mopublic/db2db/agi_mopublic_pub_mopublic_einzelobjekt_flaeche.sql
--------------------------------------------------------------------------------
agi_av_dm01_mopublic_pub/2_mopublic/db2db/agi_mopublic_pub_mopublic_einzelobjekt_linie.sql
--------------------------------------------------------------------------------
agi_av_dm01_mopublic_pub/2_mopublic/db2db/agi_mopublic_pub_mopublic_grundstueck_proj_linie.sql
--------------------------------------------------------------------------------
agi_av_dm01_mopublic_pub/2_mopublic/db2db/agi_mopublic_pub_mopublic_objektname_pos.sql
--------------------------------------------------------------------------------
agi_av_dm01_mopublic_pub/2_mopublic/db2db/agi_mopublic_pub_mopublic_strassenachse.sql
--------------------------------------------------------------------------------
agi_av_dm01_mopublic_pub/2_mopublic/db2db/agi_mopublic_pub_mopublic_hoheitsgrenzpunkt.sql
--------------------------------------------------------------------------------
agi_av_dm01_mopublic_pub/2_mopublic/db2db/agi_mopublic_pub_mopublic_grundstueck_proj.sql
--------------------------------------------------------------------------------
agi_av_dm01_mopublic_pub/2_mopublic/db2db/agi_mopublic_pub_mopublic_ortsname.sql
--------------------------------------------------------------------------------
agi_av_dm01_mopublic_pub/2_mopublic/db2db/agi_mopublic_pub_mopublic_gebaeudeadresse.sql
--------------------------------------------------------------------------------
agi_av_dm01_mopublic_pub/2_mopublic/db2db/agi_mopublic_pub_mopublic_bodenbedeckung_proj.sql
--------------------------------------------------------------------------------
agi_av_dm01_mopublic_pub/2_mopublic/db2db/agi_mopublic_pub_mopublic_bodenbedeckung.sql
--------------------------------------------------------------------------------
agi_av_dm01_mopublic_pub/2_mopublic/db2db/agi_mopublic_pub_mopublic_gemeindegrenze.sql
--------------------------------------------------------------------------------
agi_av_dm01_mopublic_pub/2_mopublic/db2db/agi_mopublic_pub_mopublic_fixpunkt.sql
--------------------------------------------------------------------------------
agi_av_dm01_mopublic_pub/2_mopublic/db2db/agi_mopublic_pub_mopublic_einzelobjekt_punkt.sql
--------------------------------------------------------------------------------
agi_av_dm01_mopublic_pub/2_mopublic/db2db/agi_mopublic_pub_mopublic_gemeindegrenze_proj.sql
--------------------------------------------------------------------------------
agi_av_dm01_mopublic_pub/2_mopublic/db2db/agi_mopublic_pub_mopublic_grenzpunkt.sql
--------------------------------------------------------------------------------
agi_av_dm01_mopublic_pub/2_mopublic/db2db/agi_mopublic_pub_mopublic_grundstueck.sql
--------------------------------------------------------------------------------
agi_av_dm01_mopublic_pub/2_mopublic/db2db/agi_mopublic_pub_mopublic_grundstueck_linie.sql
--------------------------------------------------------------------------------
agi_av_dm01_mopublic_pub/2_mopublic/db2db/agi_mopublic_pub_mopublic_strassenname_pos.sql
--------------------------------------------------------------------------------
agi_av_dm01_mopublic_pub/2_mopublic/db2db/agi_mopublic_pub_mopublic_gelaendename.sql
--------------------------------------------------------------------------------
afu_grundwassergeometrie_pub/isohypse_mittlerer_grundwasserstand_pub.sql
--------------------------------------------------------------------------------
afu_grundwassergeometrie_pub/grundwasserstauer_pub.sql
--------------------------------------------------------------------------------
afu_grundwassergeometrie_pub/grundwasserspiegel_mittel_tief_pub.sql
--------------------------------------------------------------------------------
afu_grundwassergeometrie_pub/grundwasser_wasseramt_pub.sql
--------------------------------------------------------------------------------
afu_grundwassergeometrie_pub/grundwasser_mittelstand_pub.sql
--------------------------------------------------------------------------------
afu_grundwassergeometrie_pub/isohypse_hoechster_grundwasserstand_pub.sql
--------------------------------------------------------------------------------
afu_grundwassergeometrie_pub/grundwasser_maechtigkeit_pub.sql
--------------------------------------------------------------------------------
afu_grundwassergeometrie_pub/isohypse_tiefer_grundwasserstand_pub.sql
--------------------------------------------------------------------------------
afu_grundwassergeometrie_pub/grundwasserstrom_begrenzung_pub.sql
--------------------------------------------------------------------------------
afu_grundwassergeometrie_pub/grundwasser_tiefstand_pub.sql
--------------------------------------------------------------------------------
alw_drainagen_bemerkungen_pub/alw_drainagen_bemerkungen_pub_v1.sql
--------------------------------------------------------------------------------
arp_fledermaus/arp_fledermaus_pub.sql
--------------------------------------------------------------------------------
arp_fledermaus/truncate_table.sql
--------------------------------------------------------------------------------
afu_gewaesser_revitalisierung_pub/afu_gewaesser_revitalisierung_nutzen.sql
--------------------------------------------------------------------------------
afu_gewaesser_revitalisierung_pub/afu_gewaesser_revitalisierung_priorisierung.sql
--------------------------------------------------------------------------------
agi_gebaeudeinformationen_pub/bodenbedeckung_gebaeude.sql
--------------------------------------------------------------------------------
awjf_biotopbaeume_import/awjf_biotopbaeume_import_delete.sql
--------------------------------------------------------------------------------
awjf_biotopbaeume_import/awjf_biotopbaeume_transfer.sql
--------------------------------------------------------------------------------
afu_onlinerisk_transfer/update_fehlende_koordinaten_betrieb.sql
--------------------------------------------------------------------------------
afu_onlinerisk_transfer/bereich.sql
--------------------------------------------------------------------------------
afu_onlinerisk_transfer/untersuchungseinheit.sql
--------------------------------------------------------------------------------
afu_onlinerisk_transfer/stoff.sql
--------------------------------------------------------------------------------
afu_onlinerisk_transfer/gebaeude.sql
--------------------------------------------------------------------------------
afu_onlinerisk_transfer/betrieb.sql
--------------------------------------------------------------------------------
afu_onlinerisk_transfer/stoff_in_bereich.sql
--------------------------------------------------------------------------------
afu_schadstoffbelastete_boeden_pub/afu_schadstoffbelastete_boeden_pub_schdstfflstt_bden_eisenbahn.sql
--------------------------------------------------------------------------------
afu_schadstoffbelastete_boeden_pub/afu_schadstoffbelastete_boeden_pub_schdstfflstt_bden_stahlmast.sql
--------------------------------------------------------------------------------
afu_schadstoffbelastete_boeden_pub/afu_schadstoffbelastete_boeden_pub_schdstfflstt_bden_schiessanlage.sql
--------------------------------------------------------------------------------
afu_schadstoffbelastete_boeden_pub/afu_schadstoffbelastete_boeden_pub_schdstfflstt_bden_siedlungsgebiet.sql
--------------------------------------------------------------------------------
afu_schadstoffbelastete_boeden_pub/afu_schadstoffbelastete_boeden_pub_schdstfflstt_bden_schrebergarten.sql
--------------------------------------------------------------------------------
afu_schadstoffbelastete_boeden_pub/afu_schadstoffbelastete_boeden_pub_schdstfflstt_bden_militaerischer_schiessplatz.sql
--------------------------------------------------------------------------------
afu_schadstoffbelastete_boeden_pub/afu_schadstoffbelastete_boeden_pub_schdstfflstt_bden_flugplatz.sql
--------------------------------------------------------------------------------
afu_schadstoffbelastete_boeden_pub/afu_schadstoffbelastete_boeden_pub_schdstfflstt_bden_hopfenbau.sql
--------------------------------------------------------------------------------
afu_schadstoffbelastete_boeden_pub/afu_schadstoffbelastete_boeden_pub_schdstfflstt_bden_stahlkonstruktion.sql
--------------------------------------------------------------------------------
afu_schadstoffbelastete_boeden_pub/afu_schadstoffbelastete_boeden_pub_schdstfflstt_bden_strasse.sql
--------------------------------------------------------------------------------
afu_schadstoffbelastete_boeden_pub/afu_schadstoffbelastete_boeden_pub_schdstfflstt_bden_bodenbelastungsgebiet.sql
class net.sf.jsqlparser.JSQLParserException
net.sf.jsqlparser.parser.ParseException: Encountered unexpected token: "\n\n\n" <ST_SEMICOLON>
    at line 126, column 2.

Was expecting one of:

    "("
    ","
    "DELETE"
    "FROM"
    "INSERT"
    "MERGE"
    "UPDATE"
    "VALUE"
    "VALUES"
    "WITH"
    <K_SELECT>

Error parsing: WITH dokumente AS (
    SELECT
        schdstfflstt_bden_dokument.t_id,
        schdstfflstt_bden_dokument.t_ili_tid,
        schdstfflstt_bden_dokument.dokumentname,
        schdstfflstt_bden_dokument.dateipfad,
        schdstfflstt_bden_bodenbelastungsgebiet.t_id AS bodenbelastungsgebiet
    FROM
        afu_schadstoffbelastete_boeden.schdstfflstt_bden_dokument_bodenbelastungsflaeche
        LEFT JOIN afu_schadstoffbelastete_boeden.schdstfflstt_bden_bodenbelastungsgebiet
            ON schdstfflstt_bden_bodenbelastungsgebiet.t_id = schdstfflstt_bden_dokument_bodenbelastungsflaeche.bodenbelastungsflaeche
        LEFT JOIN afu_schadstoffbelastete_boeden.schdstfflstt_bden_dokument
            ON schdstfflstt_bden_dokument.t_id = schdstfflstt_bden_dokument_bodenbelastungsflaeche.dokument
), dokumente_json AS (
    SELECT
        array_to_json(
            array_agg(
                row_to_json((
                    SELECT
                        docs
                    FROM 
                        (
                            select
                                'SO_AFU_Verzeichnis_schadstoffbelastete_Boeden_Publikation_20200701.Dokument' as "@type",
                                dokumentname as "Name",
                                dateipfad as "URL"
                        ) docs
                ))
            )
        ) AS dokumente,
        bodenbelastungsgebiet
    FROM
        dokumente
    GROUP BY
        bodenbelastungsgebiet
), schadstoffe AS (
    SELECT
        schdstfflstt_bden_schadstoff.t_id,
        schdstfflstt_bden_schadstoff.t_ili_tid,
        schdstfflstt_bden_schadstoff.schadstoffname,
        schdstfflstt_bden_schadstoff.kuerzel,
        schdstfflstt_bden_bodenbelastungsgebiet.t_id AS bodenbelastungsgebiet
    FROM
        afu_schadstoffbelastete_boeden.schdstfflstt_bden_schadstoff_bodenbelastungsflaeche
        LEFT JOIN afu_schadstoffbelastete_boeden.schdstfflstt_bden_bodenbelastungsgebiet
            ON schdstfflstt_bden_bodenbelastungsgebiet.t_id = schdstfflstt_bden_schadstoff_bodenbelastungsflaeche.bodenbelastungsflaeche
        LEFT JOIN afu_schadstoffbelastete_boeden.schdstfflstt_bden_schadstoff
            ON schdstfflstt_bden_schadstoff.t_id = schdstfflstt_bden_schadstoff_bodenbelastungsflaeche.schadstoff
), schadstoffe_json AS (
    SELECT
        array_to_json(
            array_agg(
                row_to_json((
                    SELECT
                        schadstoffe
                    FROM 
                        (
                            select
                                'SO_AFU_Verzeichnis_schadstoffbelastete_Boeden_Publikation_20200701.Schadstoff' as "@type",
                                schadstoffname AS "Schadstoffname",
                                kuerzel AS "Kuerzel"
                        ) schadstoffe
                ))
            )
        ) AS schadstoffe,
        bodenbelastungsgebiet
    FROM
        schadstoffe
    GROUP BY
        bodenbelastungsgebiet
), gemeinden AS (
    SELECT
        schdstfflstt_bden_bodenbelastungsgebiet.t_id,
        string_agg(DISTINCT hoheitsgrenzen_gemeindegrenze.gemeindename, ', ' ORDER BY hoheitsgrenzen_gemeindegrenze.gemeindename ASC) AS gemeinden
    FROM
        agi_hoheitsgrenzen_pub.hoheitsgrenzen_gemeindegrenze,
        afu_schadstoffbelastete_boeden.schdstfflstt_bden_bodenbelastungsgebiet
    WHERE
        ST_DWithin(schdstfflstt_bden_bodenbelastungsgebiet.geometrie, hoheitsgrenzen_gemeindegrenze.geometrie, 0)
    GROUP BY
        schdstfflstt_bden_bodenbelastungsgebiet.t_id
), bfs_nummern AS (
    SELECT
        schdstfflstt_bden_bodenbelastungsgebiet.t_id,
        string_agg(DISTINCT CAST(hoheitsgrenzen_gemeindegrenze.bfs_gemeindenummer AS varchar), ', ' ORDER BY CAST(hoheitsgrenzen_gemeindegrenze.bfs_gemeindenummer AS varchar) ASC) AS bfs_nummern
    FROM
        agi_hoheitsgrenzen_pub.hoheitsgrenzen_gemeindegrenze,
        afu_schadstoffbelastete_boeden.schdstfflstt_bden_bodenbelastungsgebiet
    WHERE
        ST_DWithin(schdstfflstt_bden_bodenbelastungsgebiet.geometrie, hoheitsgrenzen_gemeindegrenze.geometrie, 0)
    GROUP BY
        schdstfflstt_bden_bodenbelastungsgebiet.t_id
), parzellennummern AS (
    SELECT
        schdstfflstt_bden_bodenbelastungsgebiet.t_id,
        string_agg(DISTINCT liegen.nummer || '(' || liegen.bfs_nr|| ')', ', ' ORDER BY liegen.nummer || '(' || liegen.bfs_nr || ')') AS grundbuchnummern
    FROM
        (SELECT liegenschaften_grundstueck.nummer, 
		         liegenschaften_grundstueck.t_datasetname AS bfs_nr,
		         liegenschaften_liegenschaft.geometrie 
		 FROM agi_dm01avso24.liegenschaften_grundstueck 
		 LEFT JOIN agi_dm01avso24.liegenschaften_liegenschaft 
		     ON liegenschaften_liegenschaft.liegenschaft_von = liegenschaften_grundstueck.t_id
		) liegen,
        afu_schadstoffbelastete_boeden.schdstfflstt_bden_bodenbelastungsgebiet
    WHERE
        ST_DWithin(schdstfflstt_bden_bodenbelastungsgebiet.geometrie, liegen.geometrie, 0)
    GROUP BY
        schdstfflstt_bden_bodenbelastungsgebiet.t_id
), flurnamen AS (
    SELECT
        schdstfflstt_bden_bodenbelastungsgebiet.t_id,
         string_agg(DISTINCT flurname.flurname, ', ' ORDER BY flurname.flurname) AS flurname
    FROM
        ( SELECT 
		     aname AS flurname, 
		     geometrie 
		 FROM 
		     agi_dm01avso24.nomenklatur_flurname
		 ) flurname,
        afu_schadstoffbelastete_boeden.schdstfflstt_bden_bodenbelastungsgebiet
    WHERE
        ST_DWithin(schdstfflstt_bden_bodenbelastungsgebiet.geometrie, flurname.geometrie, 0)
    GROUP BY
        schdstfflstt_bden_bodenbelastungsgebiet.t_id
)


SELECT
    schdstfflstt_bden_bodenbelastungsgebiet.t_ili_tid,
    schdstfflstt_bden_bodenbelastungsgebiet.verursacher,
    schdstfflstt_bden_bodenbelastungsgebiet.belastungsstufe,
    schdstfflstt_bden_bodenbelastungsgebiet.pruefwert,
    schdstfflstt_bden_bodenbelastungsgebiet.probenanzahl,
    schdstfflstt_bden_bodenbelastungsgebiet.grundbucheintrag,
    schdstfflstt_bden_bodenbelastungsgebiet.flaechentyp,
    dokumente_json.dokumente,
    schadstoffe_json.schadstoffe,
    schdstfflstt_bden_gebiet.gebietsname AS gebietsname,
    schdstfflstt_bden_bodenbelastungsgebiet.bezeichnung,
    schdstfflstt_bden_bodenbelastungsgebiet.astatus,
    schdstfflstt_bden_bodenbelastungsgebiet.aktiv,
    schdstfflstt_bden_bodenbelastungsgebiet.erfassungsdatum,
    schdstfflstt_bden_bodenbelastungsgebiet.datenerfasser,
    schdstfflstt_bden_bodenbelastungsgebiet.begruendung_aus_vsb_entlassen,
    schdstfflstt_bden_bodenbelastungsgebiet.datum_aus_vsb_entlassen,
    schdstfflstt_bden_bodenbelastungsgebiet.bemerkung,
    schdstfflstt_bden_bodenbelastungsgebiet.nutzungseinschraenkung,
    schdstfflstt_bden_bodenbelastungsgebiet.nutzungsverbot,
    schdstfflstt_bden_bodenbelastungsgebiet.geometrie,
    bfs_nummern.bfs_nummern AS bfs_gemeindenummern,
    gemeinden.gemeinden AS gemeindenamen,
    parzellennummern.grundbuchnummern,
    flurnamen.flurname AS flurnamen,
    belastungsstufe.description AS belastungsstufe_txt,
    status.description AS status_txt,
    begruendung_vsb_entlassen.description AS begruendung_aus_vsb_entlassen_txt,
    flaechentyp.description AS flaechentyp_txt,
    verursacher.description AS verursacher_txt
FROM
    afu_schadstoffbelastete_boeden.schdstfflstt_bden_bodenbelastungsgebiet
    LEFT JOIN afu_schadstoffbelastete_boeden.schdstfflstt_bden_gebiet
        ON schdstfflstt_bden_bodenbelastungsgebiet.bodenbelastungsgebiet = schdstfflstt_bden_gebiet.t_id
    LEFT JOIN dokumente_json
        ON dokumente_json.bodenbelastungsgebiet = schdstfflstt_bden_bodenbelastungsgebiet.t_id
    LEFT JOIN schadstoffe_json
        ON schadstoffe_json.bodenbelastungsgebiet = schdstfflstt_bden_bodenbelastungsgebiet.t_id
    LEFT JOIN gemeinden
        ON gemeinden.t_id = schdstfflstt_bden_bodenbelastungsgebiet.t_id
    LEFT JOIN bfs_nummern
        ON bfs_nummern.t_id = schdstfflstt_bden_bodenbelastungsgebiet.t_id
    LEFT JOIN parzellennummern
        ON parzellennummern.t_id = schdstfflstt_bden_bodenbelastungsgebiet.t_id
    LEFT JOIN flurnamen
        ON flurnamen.t_id = schdstfflstt_bden_bodenbelastungsgebiet.t_id
    LEFT JOIN afu_schadstoffbelastete_boeden.schdstfstt_bden_bodenbelastungsgebiet_belastungsstufe AS belastungsstufe
        ON belastungsstufe.ilicode = schdstfflstt_bden_bodenbelastungsgebiet.belastungsstufe
    LEFT JOIN afu_schadstoffbelastete_boeden.schadstoffbelasteter_boden_status status
        ON status.ilicode = schdstfflstt_bden_bodenbelastungsgebiet.astatus
    LEFT JOIN afu_schadstoffbelastete_boeden.schadstoffbelasteter_boden_begruendung_aus_vsb_entlassen begruendung_vsb_entlassen
        ON begruendung_vsb_entlassen.ilicode = schdstfflstt_bden_bodenbelastungsgebiet.begruendung_aus_vsb_entlassen
    LEFT JOIN afu_schadstoffbelastete_boeden.schdstfstt_bden_eisenbahn_flaechentyp flaechentyp
        ON flaechentyp.ilicode = schdstfflstt_bden_bodenbelastungsgebiet.flaechentyp
    LEFT JOIN afu_schadstoffbelastete_boeden.schdstfstt_bden_bodenbelastungsgebiet_verursacher verursacher
        ON verursacher.ilicode = schdstfflstt_bden_bodenbelastungsgebiet.verursacher (net.sf.jsqlparser.parser.ParseException: Encountered unexpected token: "\n\n\n" <ST_SEMICOLON>
    at line 126, column 2.

Was expecting one of:

    "("
    ","
    "DELETE"
    "FROM"
    "INSERT"
    "MERGE"
    "UPDATE"
    "VALUE"
    "VALUES"
    "WITH"
    <K_SELECT>
)
********************************************************************************
--------------------------------------------------------------------------------
afu_schadstoffbelastete_boeden_pub/afu_schadstoffbelastete_boeden_pub_schdstfflstt_bden_gaertnerei.sql
--------------------------------------------------------------------------------
afu_schadstoffbelastete_boeden_pub/afu_schadstoffbelastete_boeden_pub_schdstfflstt_bden_geogene_bodenbelastung.sql
--------------------------------------------------------------------------------
afu_schadstoffbelastete_boeden_pub/afu_schadstoffbelastete_boeden_pub_schdstfflstt_bden_stahlbruecke.sql
--------------------------------------------------------------------------------
afu_schadstoffbelastete_boeden_pub/afu_schadstoffbelastete_boeden_pub_schdstfflstt_bden_rebbau.sql
--------------------------------------------------------------------------------
arp_naturreservate_pub/insert_arp_nutzungsplanung_planregister_pub_naturreservate.sql
--------------------------------------------------------------------------------
arp_naturreservate_pub/arp_naturreservate_pub_naturreservate_teilgebiete.sql
class net.sf.jsqlparser.JSQLParserException
net.sf.jsqlparser.parser.TokenMgrException: Lexical error at line 98, column 16.  Encountered: <EOF>
Error parsing: WITH documents AS (
    SELECT DISTINCT 
        bezeichnung, 
        typ, 
        reservate_dokument.rechtsstatus, 
        reservate_dokument.publiziertab, 
        rechtsvorschrift, 
        offiziellenr,
        reservate_reservat_dokument.reservat,
        reservate_teilgebiet.t_id AS teilgebiet_id,
        CASE
            WHEN 
                reservate_dokument.typ = 'RRB' 
                
                THEN replace(reservate_dokument.dateipfad,'G:\documents\ch.so.arp.naturreservate\rrb\', 'https://geo.so.ch/docs/ch.so.arp.naturreservate/rrb/')
                
                
            WHEN 
                reservate_dokument.typ = 'Bericht'
        
                THEN replace(reservate_dokument.dateipfad,'G:\documents\ch.so.arp.naturreservate\bericht\','https://geo.so.ch/docs/ch.so.arp.naturreservate/bericht/')
                
            WHEN 
                reservate_dokument.typ = 'Kommunale_Inventare'
        
                THEN replace(reservate_dokument.dateipfad,'G:\documents\ch.so.arp.naturreservate\kommunale_inventare\','https://geo.so.ch/docs/ch.so.arp.naturreservate/kommunale_inventare/')
                    
            WHEN 
                reservate_dokument.typ = 'Pflegekonzept'
        
                THEN replace(reservate_dokument.dateipfad,'G:\documents\ch.so.arp.naturreservate\pflegekonzept\','https://geo.so.ch/docs/ch.so.arp.naturreservate/pflegekonzept/')
                
            WHEN 
                reservate_dokument.typ = 'Gestaltungsplan'
        
                THEN replace(reservate_dokument.dateipfad,'G:\documents\ch.so.arp.naturreservate\gestaltungsplan\','https://geo.so.ch/docs/ch.so.arp.naturreservate/gestaltungsplan/')

            WHEN 
                reservate_dokument.typ = 'Sonderbauvorschriften'
        
                THEN replace(reservate_dokument.dateipfad,'G:\documents\ch.so.arp.naturreservate\sonderbauvorschriften\','https://geo.so.ch/docs/ch.so.arp.naturreservate/sonderbauvorschriften/') 
           
        END AS dokumente
    FROM 
        arp_naturreservate.reservate_reservat_dokument
        LEFT JOIN arp_naturreservate.reservate_dokument
            ON reservate_dokument.t_id = reservate_reservat_dokument.dokument
        RIGHT JOIN arp_naturreservate.reservate_teilgebiet
            ON reservate_reservat_dokument.reservat= reservate_teilgebiet.reservat
           
), documents_json AS (
    SELECT 
        array_to_json(array_agg(row_to_json(documents)))::text AS dokumente, 
        teilgebiet_id
    FROM 
        documents
    GROUP BY 
        teilgebiet_id
), mjpnatur AS (
    SELECT 
        reservate_teilgebiet.t_id,
        string_agg(DISTINCT flaechen_geom.vereinbarungsnummer, ', ' ORDER BY flaechen_geom.vereinbarungsnummer) AS vereinbarungsflaechen,
        string_agg(DISTINCT 
            CASE
                WHEN 
                    personen.aname IS NOT NULL 
                    AND 
                    personen.aname != '' 
                    AND 
                    personen.vorname IS NOT NULL 
                    AND 
                    personen.vorname != ''
                        THEN personen.aname || ', ' || personen.vorname
                WHEN 
                    (
                        personen.aname IS NULL 
                        OR 
                        personen.aname = ''
                    ) 
                    AND 
                    personen.vorname IS NOT NULL 
                    AND 
                    personen.vorname != ''
                        THEN personen.vorname
                WHEN 
                    personen.aname IS NOT NULL 
                    AND 
                    personen.aname != '' 
                    AND 
                    (
                        personen.vorname IS NULL 
                        OR 
                        personen.vorname = ''
                    )
                        THEN personen.aname
                ELSE NULL 
            END
            , ' (net.sf.jsqlparser.parser.TokenMgrException: Lexical error at line 98, column 16.  Encountered: <EOF>)
********************************************************************************
class net.sf.jsqlparser.JSQLParserException
net.sf.jsqlparser.parser.ParseException: Encountered unexpected token: "\') AS bewirtschafter\n    FROM \n        arp_naturreservate.reservate_teilgebiet,\n        arp_mehrjahresprogramm.mehrjahresprgramm_vereinbarungensflaechen flaechen_geom \n        LEFT JOIN arp_mehrjahresprogramm.mehrjahresprgramm_person personen\n            ON personen.personenid = flaechen_geom.personenid\n    WHERE \n        ST_Intersects(reservate_teilgebiet.geometrie, flaechen_geom.geometrie) = TRUE\n    GROUP BY \n        reservate_teilgebiet.t_id\n)\n\n\n\nSELECT\n    reservate_teilgebiet.t_id,\n    reservate_teilgebiet.teilgebietsname AS aname,\n    reservate_teilgebiet.beschreibung,\n    ST_Area(reservate_teilgebiet.geometrie)/10000 AS flaeche,\n    string_agg(DISTINCT hoheitsgrenzen_gemeindegrenze.gemeindename, \'" <S_CHAR_LITERAL>
    at line 1, column 1.

Was expecting one of:

    "("
    "ALTER"
    "ANALYZE"
    "BEGIN"
    "CALL"
    "COMMENT"
    "COMMIT"
    "CREATE"
    "DECLARE"
    "DELETE"
    "DESC"
    "DESCRIBE"
    "DROP"
    "EXEC"
    "EXECUTE"
    "EXPLAIN"
    "FROM"
    "GRANT"
    "IF"
    "INSERT"
    "MERGE"
    "PURGE"
    "REFRESH"
    "RENAME"
    "REPLACE"
    "RESET"
    "ROLLBACK"
    "SAVEPOINT"
    "SET"
    "SHOW"
    "SUMMARIZE"
    "TABLE"
    "TRUNCATE"
    "UPDATE"
    "UPSERT"
    "USE"
    "VALUE"
    "VALUES"
    "WITH"
    <K_SELECT>

Error parsing: ') AS bewirtschafter
    FROM 
        arp_naturreservate.reservate_teilgebiet,
        arp_mehrjahresprogramm.mehrjahresprgramm_vereinbarungensflaechen flaechen_geom 
        LEFT JOIN arp_mehrjahresprogramm.mehrjahresprgramm_person personen
            ON personen.personenid = flaechen_geom.personenid
    WHERE 
        ST_Intersects(reservate_teilgebiet.geometrie, flaechen_geom.geometrie) = TRUE
    GROUP BY 
        reservate_teilgebiet.t_id
)



SELECT
    reservate_teilgebiet.t_id,
    reservate_teilgebiet.teilgebietsname AS aname,
    reservate_teilgebiet.beschreibung,
    ST_Area(reservate_teilgebiet.geometrie)/10000 AS flaeche,
    string_agg(DISTINCT hoheitsgrenzen_gemeindegrenze.gemeindename, ', ' ORDER BY hoheitsgrenzen_gemeindegrenze.gemeindename) AS gemeinden,
    documents_json.dokumente AS dokumente,
    string_agg(DISTINCT liegen.nummer || '(' || liegen.t_datasetname|| ')', ', ' ORDER BY liegen.nummer || '(' || liegen.t_datasetname || ')') AS parzellennummern,
    reservate_reservat.nummer AS reservatsnummer,
    reservate_reservat.reservatsname AS reservatsname,
    mjpnatur.vereinbarungsflaechen,
    mjpnatur.bewirtschafter,
    reservate_teilgebiet.geometrie,
    reservate_reservat.einzelschutz
FROM
    agi_hoheitsgrenzen_pub.hoheitsgrenzen_gemeindegrenze,
    (SELECT nummer, 
            liegenschaften_grundstueck.t_datasetname, 
            geometrie 
     FROM agi_dm01avso24.liegenschaften_grundstueck 
     LEFT JOIN agi_dm01avso24.liegenschaften_liegenschaft 
         ON liegenschaften_liegenschaft.liegenschaft_von = liegenschaften_grundstueck.t_id) 
    liegen,
    arp_naturreservate.reservate_teilgebiet
    LEFT JOIN arp_naturreservate.reservate_reservat
        ON reservate_teilgebiet.reservat = reservate_reservat.t_id
    LEFT JOIN documents_json
        ON documents_json.teilgebiet_id = reservate_teilgebiet.t_id
    LEFT JOIN mjpnatur
        ON mjpnatur.t_id = reservate_teilgebiet.t_id
WHERE 
    ST_Intersects(reservate_teilgebiet.geometrie, hoheitsgrenzen_gemeindegrenze.geometrie) = TRUE 
    AND
    ST_Intersects(reservate_teilgebiet.geometrie, liegen.geometrie) = TRUE
GROUP BY
    reservate_teilgebiet.t_id,
    reservate_reservat.t_id,
    mjpnatur.vereinbarungsflaechen,
    mjpnatur.bewirtschafter,
    documents_json.dokumente (net.sf.jsqlparser.parser.ParseException: Encountered unexpected token: "\') AS bewirtschafter\n    FROM \n        arp_naturreservate.reservate_teilgebiet,\n        arp_mehrjahresprogramm.mehrjahresprgramm_vereinbarungensflaechen flaechen_geom \n        LEFT JOIN arp_mehrjahresprogramm.mehrjahresprgramm_person personen\n            ON personen.personenid = flaechen_geom.personenid\n    WHERE \n        ST_Intersects(reservate_teilgebiet.geometrie, flaechen_geom.geometrie) = TRUE\n    GROUP BY \n        reservate_teilgebiet.t_id\n)\n\n\n\nSELECT\n    reservate_teilgebiet.t_id,\n    reservate_teilgebiet.teilgebietsname AS aname,\n    reservate_teilgebiet.beschreibung,\n    ST_Area(reservate_teilgebiet.geometrie)/10000 AS flaeche,\n    string_agg(DISTINCT hoheitsgrenzen_gemeindegrenze.gemeindename, \'" <S_CHAR_LITERAL>
    at line 1, column 1.

Was expecting one of:

    "("
    "ALTER"
    "ANALYZE"
    "BEGIN"
    "CALL"
    "COMMENT"
    "COMMIT"
    "CREATE"
    "DECLARE"
    "DELETE"
    "DESC"
    "DESCRIBE"
    "DROP"
    "EXEC"
    "EXECUTE"
    "EXPLAIN"
    "FROM"
    "GRANT"
    "IF"
    "INSERT"
    "MERGE"
    "PURGE"
    "REFRESH"
    "RENAME"
    "REPLACE"
    "RESET"
    "ROLLBACK"
    "SAVEPOINT"
    "SET"
    "SHOW"
    "SUMMARIZE"
    "TABLE"
    "TRUNCATE"
    "UPDATE"
    "UPSERT"
    "USE"
    "VALUE"
    "VALUES"
    "WITH"
    <K_SELECT>
)
********************************************************************************
--------------------------------------------------------------------------------
arp_naturreservate_pub/delete_arp_naturreservate_staging.sql
--------------------------------------------------------------------------------
arp_naturreservate_pub/delete_arp_nutzungsplanung_planregister_pub_naturreservate.sql
--------------------------------------------------------------------------------
arp_naturreservate_pub/arp_naturreservate_pub_naturreservate_pflanzenliste.sql
--------------------------------------------------------------------------------
arp_naturreservate_pub/arp_naturreservate_pub_naturreservate_reservate.sql
class net.sf.jsqlparser.JSQLParserException
net.sf.jsqlparser.parser.ParseException: Encountered unexpected token: "\n\n\n" <ST_SEMICOLON>
    at line 92, column 2.

Was expecting one of:

    "("
    ","
    "DELETE"
    "FROM"
    "INSERT"
    "MERGE"
    "UPDATE"
    "VALUE"
    "VALUES"
    "WITH"
    <K_SELECT>

Error parsing: WITH documents AS (
    SELECT DISTINCT 
        reservate_dokument.bezeichnung, 
        reservate_dokument.typ, 
        reservate_dokument.rechtsstatus, 
        reservate_dokument.publiziertab, 
        reservate_dokument.rechtsvorschrift, 
        reservate_dokument.offiziellenr,
        reservate_reservat_dokument.reservat,
        
        CASE
            WHEN 
                reservate_dokument.typ = 'RRB' 
                
                THEN replace(reservate_dokument.dateipfad,'G:\documents\ch.so.arp.naturreservate\rrb\', 'https://geo.so.ch/docs/ch.so.arp.naturreservate/rrb/')
                
                
            WHEN 
                reservate_dokument.typ = 'Bericht'
        
                THEN replace(reservate_dokument.dateipfad,'G:\documents\ch.so.arp.naturreservate\bericht\','https://geo.so.ch/docs/ch.so.arp.naturreservate/bericht/')
                
            WHEN 
                reservate_dokument.typ = 'Kommunale_Inventare'
        
                THEN replace(reservate_dokument.dateipfad,'G:\documents\ch.so.arp.naturreservate\kommunale_inventare\','https://geo.so.ch/docs/ch.so.arp.naturreservate/kommunale_inventare/')
                    
            WHEN 
                reservate_dokument.typ = 'Pflegekonzept'
        
                THEN replace(reservate_dokument.dateipfad,'G:\documents\ch.so.arp.naturreservate\pflegekonzept\','https://geo.so.ch/docs/ch.so.arp.naturreservate/pflegekonzept/')
                
            WHEN 
                reservate_dokument.typ = 'Gestaltungsplan'
        
                THEN replace(reservate_dokument.dateipfad,'G:\documents\ch.so.arp.naturreservate\gestaltungsplan\','https://geo.so.ch/docs/ch.so.arp.naturreservate/gestaltungsplan/') 

            WHEN 
                reservate_dokument.typ = 'Sonderbauvorschriften'
        
                THEN replace(reservate_dokument.dateipfad,'G:\documents\ch.so.arp.naturreservate\sonderbauvorschriften\','https://geo.so.ch/docs/ch.so.arp.naturreservate/sonderbauvorschriften/') 
                                     
         END AS dokumente,
         
         reservate_reservat.einzelschutz
   FROM 
        arp_naturreservate.reservate_reservat_dokument
        LEFT JOIN arp_naturreservate.reservate_dokument
            ON reservate_dokument.t_id = reservate_reservat_dokument.dokument
        LEFT JOIN arp_naturreservate.reservate_reservat
            ON reservate_reservat.t_id = reservate_reservat_dokument.reservat
    
    UNION
    
    SELECT 
        'Objektblatt' AS bezeichnung, 
        'Objektblatt' AS typ, 
        'laufendeAenderung' AS rechtsstatus, 
        NULL AS publiziertab, 
        FALSE AS rechtsvorschrift, 
        NULL AS offiziellenr,
        reservate_reservat.t_id,
        'https://geo.so.ch/api/v1/document/Naturreservate?feature=' || reservate_reservat.t_id,
	einzelschutz
    FROM
        arp_naturreservate.reservate_reservat
        
    UNION
    
    SELECT 
        'Fotos' AS bezeichnung, 
        'Fotos' AS typ, 
        'laufendeAenderung' AS rechtsstatus, 
        NULL AS publiziertab, 
        FALSE AS rechtsvorschrift, 
        NULL AS offiziellenr,
        reservate_reservat.t_id,
        'http://faust.so.ch/suche_start.fau?prj=ARP&dm=FVARP02&rpos=3&ro_zeile_2=' || reservate_reservat.nummer,
	einzelschutz
    FROM
        arp_naturreservate.reservate_reservat
    ORDER BY reservat, typ DESC
    
), documents_json AS (
    SELECT 
        array_to_json(array_agg(row_to_json(documents)))::text AS dokumente, 
        reservat
    FROM 
        documents
    GROUP BY 
        reservat
)


SELECT
    reservate_reservat.t_id,
    reservate_reservat.nummer,
    reservate_reservat.nsi_nummer,
    reservate_reservat.reservatsname as aname,
    reservate_reservat.beschreibung,
    reservate_reservat.einzelschutz,
    ST_Area(ST_Union(reservate_teilgebiet.geometrie))/10000 AS flaeche,
    string_agg(DISTINCT reservate_teilgebiet.teilgebietsname, ', ' ORDER BY reservate_teilgebiet.teilgebietsname) AS teilgebietsnamen,
    string_agg(DISTINCT hoheitsgrenzen_gemeindegrenze.gemeindename, ', ' ORDER BY hoheitsgrenzen_gemeindegrenze.gemeindename) AS gemeinden,
    documents_json.dokumente AS dokumente,
    string_agg(
        DISTINCT
            CASE
                WHEN reservate_zustaendiger.zustaendigername IS NOT NULL
                    AND reservate_zustaendiger.organisation IS NOT NULL
                    THEN reservate_zustaendiger.zustaendigername || ' (' || reservate_zustaendiger.organisation || ')'
                WHEN reservate_zustaendiger.zustaendigername IS NOT NULL AND reservate_zustaendiger.organisation IS NULL
                    THEN reservate_zustaendiger.zustaendigername
                WHEN reservate_zustaendiger.zustaendigername IS NULL AND reservate_zustaendiger.organisation IS NOT NULL
                    THEN reservate_zustaendiger.organisation
                ELSE NULL 
            END
    , ', ') AS zustaendiger,
    ST_Multi(ST_Union(reservate_teilgebiet.geometrie)) AS geometrie
    
FROM
    agi_hoheitsgrenzen_pub.hoheitsgrenzen_gemeindegrenze,
    arp_naturreservate.reservate_reservat
    LEFT JOIN arp_naturreservate.reservate_teilgebiet
        ON reservate_teilgebiet.reservat = reservate_reservat.t_id
    LEFT JOIN documents_json
        ON documents_json.reservat = reservate_reservat.t_id
    LEFT JOIN arp_naturreservate.reservate_reservat_zustaendiger
        ON reservate_reservat_zustaendiger.reservat = reservate_reservat.t_id
    LEFT JOIN arp_naturreservate.reservate_zustaendiger
        ON reservate_zustaendiger.t_id = reservate_reservat_zustaendiger.zustaendiger
WHERE 
    ST_Intersects(reservate_teilgebiet.geometrie, hoheitsgrenzen_gemeindegrenze.geometrie) = TRUE
GROUP BY 
    reservate_reservat.t_id,
    documents_json.dokumente (net.sf.jsqlparser.parser.ParseException: Encountered unexpected token: "\n\n\n" <ST_SEMICOLON>
    at line 92, column 2.

Was expecting one of:

    "("
    ","
    "DELETE"
    "FROM"
    "INSERT"
    "MERGE"
    "UPDATE"
    "VALUE"
    "VALUES"
    "WITH"
    <K_SELECT>
)
********************************************************************************
--------------------------------------------------------------------------------
arp_naturreservate_pub/delete_arp_nutzungsplanung_planregister_pub_doppelte_dokumente.sql
--------------------------------------------------------------------------------
dsbjd_ausgleichsabgabe_pub/dsbjd_ausgleichsabgabe_pub.sql
--------------------------------------------------------------------------------
agi_av_kaso_abgleich_pub/agi_av_kaso_abgleich_pub_uebersicht_des_vergleichs.sql
--------------------------------------------------------------------------------
agi_av_kaso_abgleich_pub/delete_from_agi_av_kaso_abgleich_import.sql
--------------------------------------------------------------------------------
agi_av_kaso_abgleich_pub/agi_av_kaso_abgleich_pub_differenzen.sql
--------------------------------------------------------------------------------
agi_av_kaso_abgleich_pub/agi_av_kaso_abgleich_import_differenzen_staging.sql
--------------------------------------------------------------------------------
agi_av_kaso_abgleich_pub/agi_av_kaso_abgleich_import_kaso_daten.sql
--------------------------------------------------------------------------------
agi_av_kaso_abgleich_pub/agi_av_kaso_abgleich_import_uebersicht_des_vergleichs_staging.sql
--------------------------------------------------------------------------------
gesa_leistungserbringerstandorte_analyse_pub/analyse_standort.sql
class net.sf.jsqlparser.JSQLParserException
net.sf.jsqlparser.parser.ParseException: Encountered unexpected token:<EOF>
    at line 6, column 73.

Was expecting one of:

    "("
    "ALTER"
    "ANALYZE"
    "BEGIN"
    "CALL"
    "COMMENT"
    "COMMIT"
    "CREATE"
    "DECLARE"
    "DELETE"
    "DESC"
    "DESCRIBE"
    "DROP"
    "EXEC"
    "EXECUTE"
    "EXPLAIN"
    "FROM"
    "GRANT"
    "IF"
    "INSERT"
    "MERGE"
    "PURGE"
    "REFRESH"
    "RENAME"
    "REPLACE"
    "RESET"
    "ROLLBACK"
    "SAVEPOINT"
    "SET"
    "SHOW"
    "SUMMARIZE"
    "TABLE"
    "TRUNCATE"
    "UPDATE"
    "UPSERT"
    "USE"
    "VALUE"
    "VALUES"
    "WITH"
    <K_SELECT>

Error parsing: --Wohnbevölkerung: Summe aus Hektarraster = 274710:

--SELECT 
--    sum(wohnbevoelkerung_staendig)
--FROM 
--    gesa_leistungserbringerstandorte_analyse_v1.stammdaten_hektarraster (net.sf.jsqlparser.parser.ParseException: Encountered unexpected token:<EOF>
    at line 6, column 73.

Was expecting one of:

    "("
    "ALTER"
    "ANALYZE"
    "BEGIN"
    "CALL"
    "COMMENT"
    "COMMIT"
    "CREATE"
    "DECLARE"
    "DELETE"
    "DESC"
    "DESCRIBE"
    "DROP"
    "EXEC"
    "EXECUTE"
    "EXPLAIN"
    "FROM"
    "GRANT"
    "IF"
    "INSERT"
    "MERGE"
    "PURGE"
    "REFRESH"
    "RENAME"
    "REPLACE"
    "RESET"
    "ROLLBACK"
    "SAVEPOINT"
    "SET"
    "SHOW"
    "SUMMARIZE"
    "TABLE"
    "TRUNCATE"
    "UPDATE"
    "UPSERT"
    "USE"
    "VALUE"
    "VALUES"
    "WITH"
    <K_SELECT>
)
********************************************************************************
--------------------------------------------------------------------------------
arp_nutzungsplanung_kanton_pub/delete_arp_nutzungsplanung_export.sql
--------------------------------------------------------------------------------
arp_nutzungsplanung_kanton_pub/insert_arp_nutzungsplanung_planregister_pub_kantonal.sql
--------------------------------------------------------------------------------
arp_nutzungsplanung_kanton_pub/insert_arp_nutzungsplanung_transfer_pub.sql
--------------------------------------------------------------------------------
arp_nutzungsplanung_kanton_pub/delete_arp_nutzungsplanung_planregister_pub_kantonal.sql
--------------------------------------------------------------------------------
arp_nutzungsplanung_kanton_pub/insert_arp_nutzungsplanung_export_kanton_20222208.sql
--------------------------------------------------------------------------------
arp_nutzungsplanung_kanton_pub/arp_nutzungsplanung_mgdm.sql
class java.lang.ClassCastException
class net.sf.jsqlparser.statement.insert.ParenthesedInsert cannot be cast to class net.sf.jsqlparser.statement.select.ParenthesedSelect (net.sf.jsqlparser.statement.insert.ParenthesedInsert and net.sf.jsqlparser.statement.select.ParenthesedSelect are in unnamed module of loader 'app')
Error parsing: -- CTE braucht es, damit man anschliessend nur auf Punkttypen
-- joined und nicht auf andere Typen mit dem gleiche Code.

WITH typ_kt_grundnutzung AS (
    INSERT INTO arp_nutzungsplanung_mgdm_v1.geobasisdaten_typ_kt
        (
        t_basket, 
        t_datasetname,
        acode,
        bezeichnung,
        abkuerzung,
        catalogue_ch
        )
    SELECT
        (SELECT 
             t_id 
         FROM 
             arp_nutzungsplanung_mgdm_v1.t_ili2db_basket 
         WHERE 
             topic = 'Nutzungsplanung_V1_2.Geobasisdaten'
        ) AS t_basket, 
        (SELECT 
             datasetname 
         FROM 
             arp_nutzungsplanung_mgdm_v1.t_ili2db_dataset tid 
         WHERE 
             t_id = (SELECT 
                         dataset 
                     FROM 
                         arp_nutzungsplanung_mgdm_v1.t_ili2db_basket 
                     WHERE 
                         topic = 'Nutzungsplanung_V1_2.Geobasisdaten')
        ) AS t_datasetname,
        substring(ilicode FROM 2 FOR 3) AS code, 
        replace(substring(ilicode FROM 6), '_', ' ') AS bezeichnung, 
        substring(ilicode FROM 1 FOR 4) AS abkuerzung,
        hauptnutzung.t_id AS catalogue_ch
    FROM
        arp_nutzungsplanung_kanton_v1.nutzungsplanung_np_typ_kanton_grundnutzung  AS grundnutzung
        LEFT JOIN arp_nutzungsplanung_mgdm_v1.catalogue_ch_catalogue_ch AS hauptnutzung
        ON hauptnutzung.acode::text = substring(ilicode FROM 2 FOR 2)
    RETURNING *  
)

INSERT INTO arp_nutzungsplanung_mgdm_v1.geobasisdaten_typ 
    (
        t_id,
        t_basket, 
        t_datasetname,
        acode,
        bezeichnung,
        abkuerzung,
        verbindlichkeit,
        nutzungsziffer,
        nutzungsziffer_art,
        bemerkungen,
        typ_kt 
    )
SELECT 
    typ.t_id,
   (SELECT 
         t_id 
     FROM 
         arp_nutzungsplanung_mgdm_v1.t_ili2db_basket 
     WHERE 
         topic = 'Nutzungsplanung_V1_2.Geobasisdaten'
    ) AS t_basket, 
    (SELECT 
         datasetname 
     FROM 
         arp_nutzungsplanung_mgdm_v1.t_ili2db_dataset tid 
     WHERE 
         t_id = (SELECT 
                     dataset 
                 FROM 
                     arp_nutzungsplanung_mgdm_v1.t_ili2db_basket 
                 WHERE 
                     topic = 'Nutzungsplanung_V1_2.Geobasisdaten')
    ) AS t_datasetname,
    typ.code_kommunal AS acode,
    typ.bezeichnung,
    typ.abkuerzung,
    typ.verbindlichkeit,
    typ.nutzungsziffer,
    typ.nutzungsziffer_art,
    typ.bemerkungen,
    typ_kt.t_id
    
FROM
    arp_nutzungsplanung_kanton_v1.nutzungsplanung_typ_grundnutzung AS typ
    LEFT JOIN typ_kt_grundnutzung AS typ_kt
    ON typ_kt.acode = substring(typ.typ_kt FROM 2 FOR 3) (class net.sf.jsqlparser.statement.insert.ParenthesedInsert cannot be cast to class net.sf.jsqlparser.statement.select.ParenthesedSelect (net.sf.jsqlparser.statement.insert.ParenthesedInsert and net.sf.jsqlparser.statement.select.ParenthesedSelect are in unnamed module of loader 'app'))
********************************************************************************
class java.lang.ClassCastException
class net.sf.jsqlparser.statement.insert.ParenthesedInsert cannot be cast to class net.sf.jsqlparser.statement.select.ParenthesedSelect (net.sf.jsqlparser.statement.insert.ParenthesedInsert and net.sf.jsqlparser.statement.select.ParenthesedSelect are in unnamed module of loader 'app')
Error parsing: --Grundnutzung wurde rausgenommen, da diese bei Kanton immer leer ist.

WITH typ_kt_flaeche AS (
    INSERT INTO arp_nutzungsplanung_mgdm_v1.geobasisdaten_typ_kt
        (
        t_basket, 
        t_datasetname,
        acode,
        bezeichnung,
        abkuerzung,
        catalogue_ch
        )
    SELECT
        (SELECT 
             t_id 
         FROM 
             arp_nutzungsplanung_mgdm_v1.t_ili2db_basket 
         WHERE 
             topic = 'Nutzungsplanung_V1_2.Geobasisdaten'
        ) AS t_basket, 
        (SELECT 
             datasetname 
         FROM 
             arp_nutzungsplanung_mgdm_v1.t_ili2db_dataset tid 
         WHERE 
             t_id = (SELECT 
                         dataset 
                     FROM 
                         arp_nutzungsplanung_mgdm_v1.t_ili2db_basket 
                     WHERE 
                         topic = 'Nutzungsplanung_V1_2.Geobasisdaten')
        ) AS t_datasetname,
        substring(ilicode FROM 2 FOR 3) AS code, 
        replace(substring(ilicode FROM 6), '_', ' ') AS bezeichnung, 
        substring(ilicode FROM 1 FOR 4) AS abkuerzung,
        hauptnutzung.t_id AS catalogue_ch
    FROM
        arp_nutzungsplanung_kanton_v1.nutzungsplanung_np_typ_kanton_ueberlagernd_flaeche AS flaeche
        LEFT JOIN arp_nutzungsplanung_mgdm_v1.catalogue_ch_catalogue_ch AS hauptnutzung
        ON hauptnutzung.acode::text = substring(ilicode FROM 2 FOR 2)
    WHERE 
        substring(ilicode FROM 2 FOR 3) 
        NOT IN 
        (
            '593', 
            '594', 
            '595', 
            '596', 
            '680', 
            '680', 
            '680', 
            '681', 
            '682', 
            '683', 
            '684', 
            '685', 
            '686'
        )
        -- 800er-Werte für Flächen müssen dem MGDM-Wert 69 zugewiesen werden.
        AND 
            substring(ilicode FROM 2 FOR 3)::int < 800
  
        UNION 
  
    SELECT
        (SELECT 
             t_id 
         FROM 
             arp_nutzungsplanung_mgdm_v1.t_ili2db_basket 
         WHERE 
             topic = 'Nutzungsplanung_V1_2.Geobasisdaten'
        ) AS t_basket, 
        (SELECT 
             datasetname 
         FROM 
             arp_nutzungsplanung_mgdm_v1.t_ili2db_dataset tid 
         WHERE 
             t_id = (SELECT 
                         dataset 
                     FROM 
                         arp_nutzungsplanung_mgdm_v1.t_ili2db_basket 
                     WHERE 
                         topic = 'Nutzungsplanung_V1_2.Geobasisdaten')
        ) AS t_datasetname,
        substring(ilicode FROM 2 FOR 3) AS code, 
        replace(substring(ilicode FROM 6), '_', ' ') AS bezeichnung, 
        substring(ilicode FROM 1 FOR 4) AS abkuerzung,
        hauptnutzung.t_id AS catalogue_ch
        FROM
            arp_nutzungsplanung_kanton_v1.nutzungsplanung_np_typ_kanton_ueberlagernd_flaeche AS flaeche
            LEFT JOIN 
            (
                SELECT 
                    t_id
                FROM
                    arp_nutzungsplanung_mgdm_v1.catalogue_ch_catalogue_ch
                WHERE
                    acode = 69
            ) AS hauptnutzung
            ON 
                1=1
        WHERE 
            substring(ilicode FROM 2 FOR 3)::int >= 800
    RETURNING *  
)

INSERT INTO arp_nutzungsplanung_mgdm_v1.geobasisdaten_typ 
    (
        t_id,
        t_basket, 
        t_datasetname,
        acode,
        bezeichnung,
        abkuerzung,
        verbindlichkeit,
        bemerkungen,
        typ_kt 
    )
SELECT 
    typ.t_id,
   (SELECT 
         t_id 
     FROM 
         arp_nutzungsplanung_mgdm_v1.t_ili2db_basket 
     WHERE 
         topic = 'Nutzungsplanung_V1_2.Geobasisdaten'
    ) AS t_basket, 
    (SELECT 
         datasetname 
     FROM 
         arp_nutzungsplanung_mgdm_v1.t_ili2db_dataset tid 
     WHERE 
         t_id = (SELECT 
                     dataset 
                 FROM 
                     arp_nutzungsplanung_mgdm_v1.t_ili2db_basket 
                 WHERE 
                     topic = 'Nutzungsplanung_V1_2.Geobasisdaten')
    ) AS t_datasetname,
    typ.code_kommunal AS acode,
    typ.bezeichnung,
    typ.abkuerzung,
    typ.verbindlichkeit,
    typ.bemerkungen,
    typ_kt.t_id
    
FROM
    arp_nutzungsplanung_kanton_v1.nutzungsplanung_typ_ueberlagernd_flaeche AS typ 
    JOIN typ_kt_flaeche AS typ_kt
    ON typ_kt.acode = substring(typ.typ_kt FROM 2 FOR 3) (class net.sf.jsqlparser.statement.insert.ParenthesedInsert cannot be cast to class net.sf.jsqlparser.statement.select.ParenthesedSelect (net.sf.jsqlparser.statement.insert.ParenthesedInsert and net.sf.jsqlparser.statement.select.ParenthesedSelect are in unnamed module of loader 'app'))
********************************************************************************
class java.lang.ClassCastException
class net.sf.jsqlparser.statement.insert.ParenthesedInsert cannot be cast to class net.sf.jsqlparser.statement.select.ParenthesedSelect (net.sf.jsqlparser.statement.insert.ParenthesedInsert and net.sf.jsqlparser.statement.select.ParenthesedSelect are in unnamed module of loader 'app')
Error parsing: WITH typ_kt_linie AS (
    INSERT INTO arp_nutzungsplanung_mgdm_v1.geobasisdaten_typ_kt
        (
        t_basket, 
        t_datasetname,
        acode,
        bezeichnung,
        abkuerzung,
        catalogue_ch
        )
    SELECT
        (SELECT 
             t_id 
         FROM 
             arp_nutzungsplanung_mgdm_v1.t_ili2db_basket 
         WHERE 
             topic = 'Nutzungsplanung_V1_2.Geobasisdaten'
        ) AS t_basket, 
        (SELECT 
             datasetname 
         FROM 
             arp_nutzungsplanung_mgdm_v1.t_ili2db_dataset tid 
         WHERE 
             t_id = (SELECT 
                         dataset 
                     FROM 
                         arp_nutzungsplanung_mgdm_v1.t_ili2db_basket 
                     WHERE 
                         topic = 'Nutzungsplanung_V1_2.Geobasisdaten')
        ) AS t_datasetname,
        substring(ilicode FROM 2 FOR 3) AS code, 
        replace(substring(ilicode FROM 6), '_', ' ') AS bezeichnung, 
        substring(ilicode FROM 1 FOR 4) AS abkuerzung,
        hauptnutzung.t_id AS catalogue_ch
    FROM
        arp_nutzungsplanung_kanton_v1.nutzungsplanung_np_typ_kanton_ueberlagernd_linie AS linie
        LEFT JOIN arp_nutzungsplanung_mgdm_v1.catalogue_ch_catalogue_ch AS hauptnutzung
        ON hauptnutzung.acode::text = substring(ilicode FROM 2 FOR 2)
    WHERE 
        substring(ilicode FROM 2 FOR 3) 
        NOT IN 
        (
        '792', 
        '793'
        )
    RETURNING *
)
INSERT INTO arp_nutzungsplanung_mgdm_v1.geobasisdaten_typ 
    (
        t_id,
        t_basket, 
        t_datasetname,
        acode,
        bezeichnung,
        abkuerzung,
        verbindlichkeit,
        bemerkungen,
        typ_kt 
    )
SELECT 
    typ.t_id,
   (SELECT 
         t_id 
     FROM 
         arp_nutzungsplanung_mgdm_v1.t_ili2db_basket 
     WHERE 
         topic = 'Nutzungsplanung_V1_2.Geobasisdaten'
    ) AS t_basket, 
    (SELECT 
         datasetname 
     FROM 
         arp_nutzungsplanung_mgdm_v1.t_ili2db_dataset tid 
     WHERE 
         t_id = (SELECT 
                     dataset 
                 FROM 
                     arp_nutzungsplanung_mgdm_v1.t_ili2db_basket 
                 WHERE 
                     topic = 'Nutzungsplanung_V1_2.Geobasisdaten')
    ) AS t_datasetname,
    typ.code_kommunal AS acode,
    typ.bezeichnung,
    typ.abkuerzung,
    typ.verbindlichkeit,
    typ.bemerkungen,
    typ_kt.t_id
    
FROM
    arp_nutzungsplanung_kanton_v1.nutzungsplanung_typ_ueberlagernd_linie  AS typ 
    JOIN typ_kt_linie AS typ_kt
    ON typ_kt.acode = substring(typ.typ_kt FROM 2 FOR 3) (class net.sf.jsqlparser.statement.insert.ParenthesedInsert cannot be cast to class net.sf.jsqlparser.statement.select.ParenthesedSelect (net.sf.jsqlparser.statement.insert.ParenthesedInsert and net.sf.jsqlparser.statement.select.ParenthesedSelect are in unnamed module of loader 'app'))
********************************************************************************
class java.lang.ClassCastException
class net.sf.jsqlparser.statement.insert.ParenthesedInsert cannot be cast to class net.sf.jsqlparser.statement.select.ParenthesedSelect (net.sf.jsqlparser.statement.insert.ParenthesedInsert and net.sf.jsqlparser.statement.select.ParenthesedSelect are in unnamed module of loader 'app')
Error parsing: WITH typ_kt_linie_erschliessung AS (
    INSERT INTO arp_nutzungsplanung_mgdm_v1.geobasisdaten_typ_kt
        (
        t_basket, 
        t_datasetname,
        acode,
        bezeichnung,
        abkuerzung,
        catalogue_ch
        )
    SELECT
        (SELECT 
             t_id 
         FROM 
             arp_nutzungsplanung_mgdm_v1.t_ili2db_basket 
         WHERE 
             topic = 'Nutzungsplanung_V1_2.Geobasisdaten'
        ) AS t_basket, 
        (SELECT 
             datasetname 
         FROM 
             arp_nutzungsplanung_mgdm_v1.t_ili2db_dataset tid 
         WHERE 
             t_id = (SELECT 
                         dataset 
                     FROM 
                         arp_nutzungsplanung_mgdm_v1.t_ili2db_basket 
                     WHERE 
                         topic = 'Nutzungsplanung_V1_2.Geobasisdaten')
        ) AS t_datasetname,
        substring(ilicode FROM 2 FOR 3) AS code, 
        replace(substring(ilicode FROM 6), '_', ' ') AS bezeichnung, 
        substring(ilicode FROM 1 FOR 4) AS abkuerzung,
        hauptnutzung.t_id AS catalogue_ch
    FROM
        arp_nutzungsplanung_kanton_v1.erschlssngsplnung_ep_typ_kanton_erschliessung_linienobjekt AS linie
        LEFT JOIN arp_nutzungsplanung_mgdm_v1.catalogue_ch_catalogue_ch AS hauptnutzung
        ON hauptnutzung.acode::text = substring(ilicode FROM 2 FOR 2)
    WHERE 
        hauptnutzung.t_ili_tid IS NOT NULL 
    RETURNING *
)
INSERT INTO arp_nutzungsplanung_mgdm_v1.geobasisdaten_typ 
    (
        t_id,
        t_basket, 
        t_datasetname,
        acode,
        bezeichnung,
        abkuerzung,
        verbindlichkeit,
        bemerkungen,
        typ_kt 
    )
SELECT 
    typ.t_id,
   (SELECT 
         t_id 
     FROM 
         arp_nutzungsplanung_mgdm_v1.t_ili2db_basket 
     WHERE 
         topic = 'Nutzungsplanung_V1_2.Geobasisdaten'
    ) AS t_basket, 
    (SELECT 
         datasetname 
     FROM 
         arp_nutzungsplanung_mgdm_v1.t_ili2db_dataset tid 
     WHERE 
         t_id = (SELECT 
                     dataset 
                 FROM 
                     arp_nutzungsplanung_mgdm_v1.t_ili2db_basket 
                 WHERE 
                     topic = 'Nutzungsplanung_V1_2.Geobasisdaten')
    ) AS t_datasetname,
    typ.code_kommunal AS acode,
    typ.bezeichnung,
    typ.abkuerzung,
    typ.verbindlichkeit,
    typ.bemerkungen,
    typ_kt.t_id
    
FROM
    arp_nutzungsplanung_kanton_v1.erschlssngsplnung_typ_erschliessung_linienobjekt AS typ 
    JOIN typ_kt_linie_erschliessung AS typ_kt
    ON typ_kt.acode = substring(typ.typ_kt FROM 2 FOR 3) (class net.sf.jsqlparser.statement.insert.ParenthesedInsert cannot be cast to class net.sf.jsqlparser.statement.select.ParenthesedSelect (net.sf.jsqlparser.statement.insert.ParenthesedInsert and net.sf.jsqlparser.statement.select.ParenthesedSelect are in unnamed module of loader 'app'))
********************************************************************************
class java.lang.ClassCastException
class net.sf.jsqlparser.statement.insert.ParenthesedInsert cannot be cast to class net.sf.jsqlparser.statement.select.ParenthesedSelect (net.sf.jsqlparser.statement.insert.ParenthesedInsert and net.sf.jsqlparser.statement.select.ParenthesedSelect are in unnamed module of loader 'app')
Error parsing: WITH typ_kt_ueberlagernd_punkt AS (
    INSERT INTO arp_nutzungsplanung_mgdm_v1.geobasisdaten_typ_kt
        (
        t_basket, 
        t_datasetname,
        acode,
        bezeichnung,
        abkuerzung,
        catalogue_ch
        )
    SELECT
        (SELECT 
             t_id 
         FROM 
             arp_nutzungsplanung_mgdm_v1.t_ili2db_basket 
         WHERE 
             topic = 'Nutzungsplanung_V1_2.Geobasisdaten'
        ) AS t_basket, 
        (SELECT 
             datasetname 
         FROM 
             arp_nutzungsplanung_mgdm_v1.t_ili2db_dataset tid 
         WHERE 
             t_id = (SELECT 
                         dataset 
                     FROM 
                         arp_nutzungsplanung_mgdm_v1.t_ili2db_basket 
                     WHERE 
                         topic = 'Nutzungsplanung_V1_2.Geobasisdaten')
        ) AS t_datasetname,
        substring(ilicode FROM 2 FOR 3) AS acode, 
        replace(substring(ilicode FROM 6), '_', ' ') AS bezeichnung, 
        substring(ilicode FROM 1 FOR 4) AS abkuerzung,
        hauptnutzung.t_id AS hauptnutzung_ch
    FROM
        arp_nutzungsplanung_kanton_v1.nutzungsplanung_np_typ_kanton_ueberlagernd_punkt AS punkt
        LEFT JOIN arp_nutzungsplanung_mgdm_v1.catalogue_ch_catalogue_ch AS hauptnutzung
        ON hauptnutzung.acode::text = substring(ilicode FROM 2 FOR 2)
    RETURNING *
)

INSERT INTO arp_nutzungsplanung_mgdm_v1.geobasisdaten_typ 
    (
        t_id,
        t_basket, 
        t_datasetname,
        acode,
        bezeichnung,
        abkuerzung,
        verbindlichkeit,
        bemerkungen,
        typ_kt 
    )
SELECT 
    typ.t_id,
   (SELECT 
         t_id 
     FROM 
         arp_nutzungsplanung_mgdm_v1.t_ili2db_basket 
     WHERE 
         topic = 'Nutzungsplanung_V1_2.Geobasisdaten'
    ) AS t_basket, 
    (SELECT 
         datasetname 
     FROM 
         arp_nutzungsplanung_mgdm_v1.t_ili2db_dataset tid 
     WHERE 
         t_id = (SELECT 
                     dataset 
                 FROM 
                     arp_nutzungsplanung_mgdm_v1.t_ili2db_basket 
                 WHERE 
                     topic = 'Nutzungsplanung_V1_2.Geobasisdaten')
    ) AS t_datasetname,
    typ.code_kommunal AS acode,
    typ.bezeichnung,
    typ.abkuerzung,
    typ.verbindlichkeit,
    typ.bemerkungen,
    typ_kt.t_id
    
FROM
    arp_nutzungsplanung_kanton_v1.nutzungsplanung_typ_ueberlagernd_punkt AS typ 
    JOIN typ_kt_ueberlagernd_punkt AS typ_kt
    ON typ_kt.acode = substring(typ.typ_kt FROM 2 FOR 3) (class net.sf.jsqlparser.statement.insert.ParenthesedInsert cannot be cast to class net.sf.jsqlparser.statement.select.ParenthesedSelect (net.sf.jsqlparser.statement.insert.ParenthesedInsert and net.sf.jsqlparser.statement.select.ParenthesedSelect are in unnamed module of loader 'app'))
********************************************************************************
class java.lang.ClassCastException
class net.sf.jsqlparser.statement.insert.ParenthesedInsert cannot be cast to class net.sf.jsqlparser.statement.select.ParenthesedSelect (net.sf.jsqlparser.statement.insert.ParenthesedInsert and net.sf.jsqlparser.statement.select.ParenthesedSelect are in unnamed module of loader 'app')
Error parsing: WITH multilingualuri AS
(
    INSERT INTO
        arp_nutzungsplanung_mgdm_v1.multilingualuri
        (
            t_id,
            t_basket,
            t_datasetname,
            t_seq,
            rechtsvrschrftn_dkment_textimweb
        )
    SELECT
        nextval('arp_nutzungsplanung_mgdm_v1.t_ili2db_seq'::regclass) AS t_id,
        basket.t_id AS t_basket,
        t_datasetname.datasetname AS t_datasetname,
        0 AS t_seq,
        rechtsvorschrften_dokument.t_id AS rechtsvrschrftn_dkment_textimweb
    FROM
        arp_nutzungsplanung_mgdm_v1.rechtsvorschrften_dokument AS rechtsvorschrften_dokument,
        (
            SELECT
                t_id
            FROM
                arp_nutzungsplanung_mgdm_v1.t_ili2db_basket
            WHERE
                t_ili_tid = 'Nutzungsplanung_V1_2.Geobasisdaten' -- ODER HIER WAS ANDERES
        ) AS basket, 
        (
            SELECT 
                datasetname 
            FROM 
                arp_nutzungsplanung_mgdm_v1.t_ili2db_dataset tid 
            WHERE 
                t_id = (SELECT 
                            dataset 
                        FROM 
                            arp_nutzungsplanung_mgdm_v1.t_ili2db_basket 
                        WHERE 
                            topic = 'Nutzungsplanung_V1_2.Geobasisdaten')
        ) AS t_datasetname
    RETURNING *
)
,
localiseduri AS 
(
    SELECT 
        nextval('arp_nutzungsplanung_mgdm_v1.t_ili2db_seq'::regclass) AS t_id,
        basket.t_id AS t_basket,
        t_datasetname.datasetname AS t_datasetname,        
        0 AS t_seq,
        'de' AS alanguage,
        textimweb AS atext,
        multilingualuri.t_id AS multilingualuri_localisedtext
    FROM
        arp_nutzungsplanung_kanton_v1.rechtsvorschrften_dokument AS rechtsvorschrften_dokument
        RIGHT JOIN multilingualuri 
        ON multilingualuri.rechtsvrschrftn_dkment_textimweb = rechtsvorschrften_dokument.t_id,
        (
            SELECT
                t_id
            FROM
                arp_nutzungsplanung_mgdm_v1.t_ili2db_basket
            WHERE
                t_ili_tid = 'Nutzungsplanung_V1_2.Geobasisdaten' 
        ) AS basket,
        (
            SELECT 
                datasetname 
            FROM 
                arp_nutzungsplanung_mgdm_v1.t_ili2db_dataset tid 
            WHERE 
                t_id = (SELECT 
                            dataset 
                        FROM 
                            arp_nutzungsplanung_mgdm_v1.t_ili2db_basket 
                        WHERE 
                            topic = 'Nutzungsplanung_V1_2.Geobasisdaten')
        ) AS t_datasetname
)
INSERT INTO
    arp_nutzungsplanung_mgdm_v1.localiseduri
    (
        t_id,
        t_basket,
        t_datasetname,
        t_seq,
        alanguage,
        atext,
        multilingualuri_localisedtext
    )
    SELECT 
        t_id,
        t_basket,
        t_datasetname,
        t_seq,
        alanguage,
        coalesce (atext,'https://planregister-data.so.ch/public/kanton/Dokument-nicht-digital-verfuegbar.pdf') AS atext, --Wenn kein Dokument vorhanden, soll auf dieses Dokument verwiesen werden
        multilingualuri_localisedtext
    FROM 
        localiseduri (class net.sf.jsqlparser.statement.insert.ParenthesedInsert cannot be cast to class net.sf.jsqlparser.statement.select.ParenthesedSelect (net.sf.jsqlparser.statement.insert.ParenthesedInsert and net.sf.jsqlparser.statement.select.ParenthesedSelect are in unnamed module of loader 'app'))
********************************************************************************
--------------------------------------------------------------------------------
arp_nutzungsplanung_kanton_pub/truncate_all_arp_npl_mgdm_tables.sql
--------------------------------------------------------------------------------
arp_nutzungsplanung_kanton_pub/delete_arp_nutzungsplanung_transfer_pub.sql
--------------------------------------------------------------------------------
arp_nutzungsplanung_kanton_pub/delete_arp_nutzungsplanung_planregister_pub_doppelte_dokumente.sql
--------------------------------------------------------------------------------
afu_qrcat_migration/delete_qrcat.sql
--------------------------------------------------------------------------------
afu_qrcat_migration/qrcat_fwert.sql
--------------------------------------------------------------------------------
afu_qrcat_migration/qrcat_postprocessing_referenzen.sql
--------------------------------------------------------------------------------
afu_qrcat_migration/qrcat_detailszenario_grundhaeufigkeit.sql
--------------------------------------------------------------------------------
afu_qrcat_migration/qrcat_letalflaeche.sql
--------------------------------------------------------------------------------
afu_qrcat_migration/qrcat_postprocessing_remove_bemerkungen.sql
--------------------------------------------------------------------------------
afu_qrcat_migration/qrcat_toxreferenzszenario.sql
--------------------------------------------------------------------------------
afu_qrcat_migration/qrcat_toxischunguenstigster_sektor.sql
--------------------------------------------------------------------------------
afu_qrcat_migration/qrcat_szenario.sql
--------------------------------------------------------------------------------
afu_bodenprofilstandorte_nabodat_pub/bodenprofilstandorte.sql
--------------------------------------------------------------------------------
agi_av_gb_administrative_einteilungen_pub/transform_nachfuehrngskrise_gemeinde.sql
--------------------------------------------------------------------------------
agi_av_gb_administrative_einteilungen_pub/transform_grundbuchkreise_grundbuchkreis.sql
--------------------------------------------------------------------------------
agi_plz_ortschaften_pub_manueller_import/insert_postleitzahl.sql
--------------------------------------------------------------------------------
agi_plz_ortschaften_pub_manueller_import/plzortschaften_ortschaft.sql
--------------------------------------------------------------------------------
agi_plz_ortschaften_pub_manueller_import/insert_ortschaft.sql
--------------------------------------------------------------------------------
agi_plz_ortschaften_pub_manueller_import/plzortschaften_postleitzahl.sql
--------------------------------------------------------------------------------
agi_plz_ortschaften_pub_manueller_import/delete_postleitzahl.sql
--------------------------------------------------------------------------------
agi_plz_ortschaften_pub_manueller_import/delete_ortschaft.sql
--------------------------------------------------------------------------------
agi_dummy_raster_export/raster.sql
--------------------------------------------------------------------------------
awjf_waldpflege_kontrolle_pub/delete_from_awjf_waldpflege_kontrolle.sql
--------------------------------------------------------------------------------
awjf_waldpflege_kontrolle_pub/awjf_waldpflege_kontrolle_pub.sql
--------------------------------------------------------------------------------
awjf_statische_waldgrenzen_export_ai/awjf_statische_waldgrenzen_mgdm.sql
class java.lang.ClassCastException
class net.sf.jsqlparser.statement.insert.ParenthesedInsert cannot be cast to class net.sf.jsqlparser.statement.select.ParenthesedSelect (net.sf.jsqlparser.statement.insert.ParenthesedInsert and net.sf.jsqlparser.statement.select.ParenthesedSelect are in unnamed module of loader 'app')
Error parsing: WITH waldgrenzen AS 
(
    SELECT 
        waldgrenze.*
    FROM 
        awjf_statische_waldgrenze.geobasisdaten_waldgrenze_linie AS waldgrenze
    WHERE 
        waldgrenze.rechtsstatus = 'inKraft'
)
,
basket AS 
(
    select 
        t_id
    from 
        awjf_statische_waldgrenze_mgdm_v1.t_ili2db_basket 
    where 
        topic = 'Waldgrenzen_V1_2.Geobasisdaten'
)
,
geobasisdaten_typ AS 
(
    INSERT INTO 
        awjf_statische_waldgrenze_mgdm_v1.geobasisdaten_typ 
        (
            t_id, 
            t_basket, 
            acode,
            bezeichnung,
            abkuerzung,
            verbindlichkeit,
            bemerkungen,
            art
        )
    SELECT 
        DISTINCT ON (typ.t_id)
        typ.t_id as t_id,
        basket.t_id as t_basket,
        CASE 
            WHEN typ.art = 'Nutzungsplanung_in_Bauzonen' THEN 'in_BZ'
            ELSE 'ausserh_BZ'
        END AS acode,
        typ.bezeichnung,
        typ.abkuerzung,
        CASE 
            WHEN typ.verbindlichkeit = 'orientierend' THEN 'Orientierend'
            ELSE typ.verbindlichkeit 
        END AS verbindlichkeit,
        typ.bemerkungen,
        CASE 
            WHEN typ.art = 'Nutzungsplanung_in_Bauzonen' THEN 'in_Bauzonen'
            ELSE 'ausserhalb_Bauzonen'
        END AS art
        
    FROM 
        waldgrenzen
        LEFT JOIN 
            awjf_statische_waldgrenze.geobasisdaten_typ AS typ
            ON 
            typ.t_id = waldgrenze_typ, 
        basket
    WHERE 
    verbindlichkeit = 'Nutzungsplanfestlegung' OR verbindlichkeit = 'orientierend'
)

INSERT INTO 
    awjf_statische_waldgrenze_mgdm_v1.geobasisdaten_waldgrenze_linie 
    (
        t_id,
        t_basket,
        geometrie,
        rechtsstatus,
        publiziertab,
        bemerkungen,
        wg
    )
    SELECT 
        waldgrenzen.t_id as t_id,
        basket.t_id as t_basket,
        geometrie,
        rechtsstatus,
        publiziert_ab,
        bemerkungen,
        waldgrenze_typ
    FROM 
        waldgrenzen, 
        basket (class net.sf.jsqlparser.statement.insert.ParenthesedInsert cannot be cast to class net.sf.jsqlparser.statement.select.ParenthesedSelect (net.sf.jsqlparser.statement.insert.ParenthesedInsert and net.sf.jsqlparser.statement.select.ParenthesedSelect are in unnamed module of loader 'app'))
********************************************************************************
class java.lang.ClassCastException
class net.sf.jsqlparser.statement.insert.ParenthesedInsert cannot be cast to class net.sf.jsqlparser.statement.select.ParenthesedSelect (net.sf.jsqlparser.statement.insert.ParenthesedInsert and net.sf.jsqlparser.statement.select.ParenthesedSelect are in unnamed module of loader 'app')
Error parsing: with basket AS 
(
    select 
        t_id
    from 
        awjf_statische_waldgrenze_mgdm_v1.t_ili2db_basket 
    where 
        topic = 'Waldgrenzen_V1_2.Rechtsvorschriften'
)
,
multilingualuri AS
(
    INSERT INTO
        awjf_statische_waldgrenze_mgdm_v1.multilingualuri
        (
            t_id,
            t_basket,
            t_seq,
            rechtsvrschrftn_dkment_textimweb
        )
    SELECT
        nextval('awjf_statische_waldgrenze_mgdm_v1.t_ili2db_seq'::regclass) AS t_id,
        basket.t_id AS t_basket,
        0 AS t_seq,
        rechtsvorschrften_dokument.t_id AS rechtsvrschrftn_dkment_textimweb
    FROM
        awjf_statische_waldgrenze.dokumente_dokument AS rechtsvorschrften_dokument,
        basket 
    where 
        rechtsstatus in (
                         select 
                             ilicode 
                         from 
                             awjf_statische_waldgrenze_mgdm_v1.rechtsstatus
                     )
    RETURNING *
),

localiseduri AS 
(
    SELECT 
        nextval('awjf_statische_waldgrenze_mgdm_v1.t_ili2db_seq'::regclass) AS t_id,
        basket.t_id AS t_basket,       
        0 AS t_seq,
        'de' AS alanguage,
        text_im_web AS atext,
        multilingualuri.t_id AS multilingualuri_localisedtext
    FROM
        awjf_statische_waldgrenze.dokumente_dokument AS rechtsvorschrften_dokument
        RIGHT JOIN multilingualuri 
        ON multilingualuri.rechtsvrschrftn_dkment_textimweb = rechtsvorschrften_dokument.t_id,
        basket
)

INSERT INTO
    awjf_statische_waldgrenze_mgdm_v1.localiseduri
    (
        t_id,
        t_basket,
        t_seq,
        alanguage,
        atext,
        multilingualuri_localisedtext
    )
    SELECT 
        t_id,
        t_basket,
        t_seq,
        alanguage,
        atext, 
        multilingualuri_localisedtext
    FROM 
        localiseduri (class net.sf.jsqlparser.statement.insert.ParenthesedInsert cannot be cast to class net.sf.jsqlparser.statement.select.ParenthesedSelect (net.sf.jsqlparser.statement.insert.ParenthesedInsert and net.sf.jsqlparser.statement.select.ParenthesedSelect are in unnamed module of loader 'app'))
********************************************************************************
--------------------------------------------------------------------------------
awjf_statische_waldgrenzen_export_ai/truncate_all_awjf_statische_waldgrenzen_mgdm_tables.sql
--------------------------------------------------------------------------------
agi_av_gwr_abgleich_pub/delete_data.sql
--------------------------------------------------------------------------------
agi_av_gwr_abgleich_pub/transfer_data.sql
--------------------------------------------------------------------------------
agi_av_gwr_abgleich_pub/upsert_data.sql
--------------------------------------------------------------------------------
agi_av_gwr_abgleich_pub/truncate_table.sql
--------------------------------------------------------------------------------
afu_ewsabfrage_3d/copy_to_pub/hinweis.sql
--------------------------------------------------------------------------------
afu_ewsabfrage_3d/copy_to_pub/tiefenbeschraenkung.sql
--------------------------------------------------------------------------------
afu_ewsabfrage_3d/delete_stage/hinweis.sql
--------------------------------------------------------------------------------
afu_ewsabfrage_3d/delete_stage/tiefenbeschraenkung.sql
--------------------------------------------------------------------------------
afu_gep_pub/sql/wk/vsadssmini_saa_schacht_se.sql
--------------------------------------------------------------------------------
afu_gep_pub/sql/wk/transfer_vsadssmini_mangel_leitung.sql
--------------------------------------------------------------------------------
afu_gep_pub/sql/wk/transfer_vsadssmini_paa_schacht_se.sql
--------------------------------------------------------------------------------
afu_gep_pub/sql/wk/vsadssmini_saa_leitung_se.sql
--------------------------------------------------------------------------------
afu_gep_pub/sql/wk/transfer_vsadssmini_paa_leitung_se.sql
--------------------------------------------------------------------------------
afu_gep_pub/sql/wk/vsadssmini_paa_schacht_dr.sql
--------------------------------------------------------------------------------
afu_gep_pub/sql/wk/transfer_vsadssmini_saa_schacht_dr.sql
--------------------------------------------------------------------------------
afu_gep_pub/sql/wk/vsadssmini_paa_leitung_dr.sql
--------------------------------------------------------------------------------
afu_gep_pub/sql/wk/transfer_vsadssmini_saa_leitung_dr.sql
--------------------------------------------------------------------------------
afu_gep_pub/sql/wk/transfer_vsadssmini_saa_sbw.sql
--------------------------------------------------------------------------------
afu_gep_pub/sql/wk/delete.sql
--------------------------------------------------------------------------------
afu_gep_pub/sql/wk/vsadssmini_paa_sbw.sql
--------------------------------------------------------------------------------
afu_gep_pub/sql/wk/transfer_vsadssmini_paa_beschriftung_p.sql
--------------------------------------------------------------------------------
afu_gep_pub/sql/wk/transfer_vsadssmini_mangel_knoten.sql
--------------------------------------------------------------------------------
afu_gep_pub/sql/wk/vsadssmini_mangel_knoten.sql
--------------------------------------------------------------------------------
afu_gep_pub/sql/wk/vsadssmini_paa_beschriftung_l.sql
--------------------------------------------------------------------------------
afu_gep_pub/sql/wk/transfer_vsadssmini_paa_bw.sql
--------------------------------------------------------------------------------
afu_gep_pub/sql/wk/vsadssmini_paa_bw.sql
--------------------------------------------------------------------------------
afu_gep_pub/sql/wk/transfer_vsadssmini_paa_beschriftung_l.sql
--------------------------------------------------------------------------------
afu_gep_pub/sql/wk/vsadssmini_saa_sbw.sql
--------------------------------------------------------------------------------
afu_gep_pub/sql/wk/vsadssmini_paa_beschriftung_p.sql
--------------------------------------------------------------------------------
afu_gep_pub/sql/wk/vsadssmini_saa_schacht_dr.sql
--------------------------------------------------------------------------------
afu_gep_pub/sql/wk/transfer_vsadssmini_paa_schacht_dr.sql
--------------------------------------------------------------------------------
afu_gep_pub/sql/wk/transfer_vsadssmini_saa_bw.sql
--------------------------------------------------------------------------------
afu_gep_pub/sql/wk/vsadssmini_saa_leitung_dr.sql
--------------------------------------------------------------------------------
afu_gep_pub/sql/wk/transfer_vsadssmini_paa_leitung_dr.sql
--------------------------------------------------------------------------------
afu_gep_pub/sql/wk/vsadssmini_saa_bw.sql
--------------------------------------------------------------------------------
afu_gep_pub/sql/wk/vsadssmini_paa_schacht_se.sql
--------------------------------------------------------------------------------
afu_gep_pub/sql/wk/transfer_vsadssmini_saa_schacht_se.sql
--------------------------------------------------------------------------------
afu_gep_pub/sql/wk/vsadssmini_mangel_leitung.sql
--------------------------------------------------------------------------------
afu_gep_pub/sql/wk/vsadssmini_paa_leitung_se.sql
--------------------------------------------------------------------------------
afu_gep_pub/sql/wk/transfer_vsadssmini_saa_leitung_se.sql
--------------------------------------------------------------------------------
afu_gep_pub/sql/wk/transfer_vsadssmini_paa_sbw.sql
--------------------------------------------------------------------------------
afu_wasserbewirtschaftung_pub/afu_wasserbewirtschaftung_fassung_pub.sql
--------------------------------------------------------------------------------
afu_wasserbewirtschaftung_pub/afu_wasserbewirtschaftung_trinkwasserobjekte_pub.sql
--------------------------------------------------------------------------------
afu_wasserbewirtschaftung_pub/afu_wasserbewirtschaftung_grundwasserwaermepumpen_entnahmeschacht_pub.sql
class net.sf.jsqlparser.JSQLParserException
net.sf.jsqlparser.parser.ParseException: Encountered unexpected token: "\n\n\n" <ST_SEMICOLON>
    at line 42, column 2.

Was expecting one of:

    "("
    ","
    "DELETE"
    "FROM"
    "INSERT"
    "MERGE"
    "UPDATE"
    "VALUE"
    "VALUES"
    "WITH"
    <K_SELECT>

Error parsing: WITH http_dokument AS (
    SELECT
    	t_id,
    	titel,
    	dokument_beschreibung,
    	typ,
    	datum,
        concat(
            'https://geo.so.ch/docs/ch.so.afu.grundwasserschutz/',
            split_part(
                dateiname, 
                'ch.so.afu.grundwasserschutz\', 
                2
            )
        ) AS dokumentimweb,
        'SO_AFU_Wasserbewirtschaftung_Publikation_20241001.Wasserbewirtschaftung.Dokument' as ili_type
    FROM 
        afu_grundwasserschutz_obj_v1.dokument d    
),

dokumente_grundwasserwaermepumpe AS(
    SELECT
        gd.grundwasserwaermepumpe_r, 
        array_to_json(
            array_agg(
                json_build_object(
                    '@type', d.ili_type,
                    'Titel', d.titel,
                    'Dokument_Beschreibung', d.dokument_beschreibung,
                    'Typ', d.typ,
                    'Datum', d.datum,
                    'DokumentImWeb', d.dokumentimweb
                )
            )
        )::jsonb AS dokumente
    FROM 
        http_dokument d
    JOIN
        afu_grundwasserschutz_obj_v1.grundwasserwaermepumpe__dokument gd ON d.t_id = gd.dokument_r
    GROUP BY
        grundwasserwaermepumpe_r 
)


SELECT 
    CASE
        WHEN aufnahmedatum >= current_date - INTERVAL '5 years' AND zustand = 'Voranfrage'
            THEN 'neue_Voranfrage'
        WHEN aufnahmedatum < current_date - INTERVAL '5 years' AND zustand = 'Voranfrage'
            THEN 'alte_Voranfrage'
        WHEN schachttyp != 'Rueckgabe' AND zustand != 'Voranfrage'
            THEN 'bewilligt'
        ELSE 
            'unbekannter_Verfahrensstand'
    END AS verfahrensstand,
    CASE
        WHEN aufnahmedatum >= current_date - INTERVAL '5 years' AND zustand = 'Voranfrage'
            THEN 'neue Voranfrage'
        WHEN aufnahmedatum < current_date - INTERVAL '5 years' AND zustand = 'Voranfrage'
            THEN 'alte Voranfrage'
        WHEN schachttyp != 'Rueckgabe' AND zustand != 'Voranfrage'
            THEN 'bewilligt'
        ELSE 
            'unbekannter Verfahrensstand'
    END AS verfahrensstand_txt,
    'Grundwasserwärmepumpen Entnahmeschacht' AS objekttyp_anzeige,
    bezeichnung AS objektname,
    objekt_id AS objektnummer,
    beschreibung AS technische_angabe,
    bemerkung,
    dokumente,
    geometrie
FROM
    afu_grundwasserschutz_obj_v1.grundwasserwaermepumpe
LEFT JOIN
    dokumente_grundwasserwaermepumpe dg ON t_id = dg.grundwasserwaermepumpe_r
WHERE
    schachttyp != 'Rueckgabe' (net.sf.jsqlparser.parser.ParseException: Encountered unexpected token: "\n\n\n" <ST_SEMICOLON>
    at line 42, column 2.

Was expecting one of:

    "("
    ","
    "DELETE"
    "FROM"
    "INSERT"
    "MERGE"
    "UPDATE"
    "VALUE"
    "VALUES"
    "WITH"
    <K_SELECT>
)
********************************************************************************
--------------------------------------------------------------------------------
afu_wasserbewirtschaftung_pub/update_enums.sql
--------------------------------------------------------------------------------
afu_wasserbewirtschaftung_pub/afu_wasserbewirtschaftung_quellen_pub.sql
--------------------------------------------------------------------------------
afu_wasserbewirtschaftung_pub/afu_wasserbewirtschaftung_grundwassereinbauten_pub.sql
--------------------------------------------------------------------------------
agi_lk_netzgebiete_pub/select_netzgebiete.sql
--------------------------------------------------------------------------------
agi_lk_netzgebiete_pub/insert_into_mgdm.sql
class java.lang.ClassCastException
class net.sf.jsqlparser.statement.insert.ParenthesedInsert cannot be cast to class net.sf.jsqlparser.statement.select.ParenthesedSelect (net.sf.jsqlparser.statement.insert.ParenthesedInsert and net.sf.jsqlparser.statement.select.ParenthesedSelect are in unnamed module of loader 'app')
Error parsing: WITH orgs AS (
    -- Füge im ersten Schritt die Organisationen in die Datenbank, die t_id 
    -- werden im nächsten Schritt weiterverwendet
    INSERT INTO
        awa_stromversorgungssicherheit_mgdm_v1.organisation (aname, website)
    SELECT
        o.organisation_name AS aname,
        o.web AS website
    FROM
        agi_lk_netzgebiete_v1.organisation o
    LEFT JOIN
        agi_lk_netzgebiete_v1.netzgebiet n
    ON
        n.betreiber = o.t_id
    WHERE
        n.amedium IN ( 'Elektrizitaet.Netzebene_3',
                       'Elektrizitaet.Netzebene_5',
                       'Elektrizitaet.Netzebene_7' )
    GROUP BY
        o.organisation_name, o.web
    RETURNING *
),
netzgebiete AS (
    SELECT
        n.amedium,
        p.geometrie AS ageometry,
        p.bezeichnung AS aname,
        'SO' AS canton,
        TRUE AS legalforce,
        org2.t_id AS operator
    FROM
        agi_lk_netzgebiete_v1.netzgebiet n 
    LEFT JOIN
        agi_lk_netzgebiete_v1.perimeter p 
    ON
        n.perimeter = p.t_id
    LEFT JOIN
        agi_lk_netzgebiete_v1.organisation o
    ON
        n.betreiber = o.t_id
    LEFT JOIN
        orgs org2
    ON
        o.organisation_name = org2.aname
),
level3_inserts AS (
    INSERT INTO
        awa_stromversorgungssicherheit_mgdm_v1.ruledarea_level3 (ageometry, aname, canton, legalforce, operator)
    SELECT
        ageometry,
        aname,
        canton,
        legalforce,
        operator
    FROM
        netzgebiete
    WHERE 
        amedium LIKE 'Elektrizitaet.Netzebene_3'
),
level5_inserts AS (
    INSERT INTO
        awa_stromversorgungssicherheit_mgdm_v1.ruledarea_level5 (ageometry, aname, canton, legalforce, operator)
    SELECT
        ageometry,
        aname,
        canton,
        legalforce,
        operator
    FROM
        netzgebiete
    WHERE 
        amedium LIKE 'Elektrizitaet.Netzebene_5'
)
INSERT INTO
    awa_stromversorgungssicherheit_mgdm_v1.ruledarea_level7 (ageometry, aname, canton, legalforce, operator)
SELECT
    ageometry,
    aname,
    canton,
    legalforce,
    operator
FROM
    netzgebiete
WHERE 
    amedium LIKE 'Elektrizitaet.Netzebene_7' (class net.sf.jsqlparser.statement.insert.ParenthesedInsert cannot be cast to class net.sf.jsqlparser.statement.select.ParenthesedSelect (net.sf.jsqlparser.statement.insert.ParenthesedInsert and net.sf.jsqlparser.statement.select.ParenthesedSelect are in unnamed module of loader 'app'))
********************************************************************************
--------------------------------------------------------------------------------
arp_bauzonengrenzen_pub/create_bauzonengrenzen.sql
--------------------------------------------------------------------------------
arp_statent_import/delete.sql
--------------------------------------------------------------------------------
arp_statent_import/transfer_nutzungszonen.sql
--------------------------------------------------------------------------------
arp_statent_import/transfer_staging_edit.sql
--------------------------------------------------------------------------------
afu_grundlagendaten_ews_import/schicht.sql
--------------------------------------------------------------------------------
afu_grundlagendaten_ews_import/bohrprofil.sql
--------------------------------------------------------------------------------
afu_grundlagendaten_ews_import/standort.sql
--------------------------------------------------------------------------------
afu_grundlagendaten_ews_import/vorkommnis.sql
--------------------------------------------------------------------------------
afu_grundlagendaten_ews_import/bohrung.sql
--------------------------------------------------------------------------------
afu_schadendienst_pub/afu_schadendienst_pub_schadenfall.sql
--------------------------------------------------------------------------------
afu_schadendienst_pub/afu_schadendienst_pub_nichtschadenfall.sql
--------------------------------------------------------------------------------
agi_swisstopo_gebaeudeadressen/transform_swisstopo_gebaeudeadressen_pub.sql
--------------------------------------------------------------------------------
arp_mjpnl_v2_zahlungslauf/calc_mjpnl_abrechnung_per_leistung_obl.sql
--------------------------------------------------------------------------------
arp_mjpnl_v2_zahlungslauf/auswertung_cleanup_rrb_bewirtschafterwechsel.sql
--------------------------------------------------------------------------------
arp_mjpnl_v2_zahlungslauf/auswertung_cleanup_snapshot_wbl_wiese.sql
--------------------------------------------------------------------------------
arp_mjpnl_v2_zahlungslauf/auswertung_cleanup_rrb_neue_vereinbarung.sql
--------------------------------------------------------------------------------
arp_mjpnl_v2_zahlungslauf/auswertung_calc_snapshot_wiese.sql
--------------------------------------------------------------------------------
arp_mjpnl_v2_zahlungslauf/auswertung_cleanup_snapshot_wbl_weide.sql
--------------------------------------------------------------------------------
arp_mjpnl_v2_zahlungslauf/auswertung_cleanup_jahresbericht_abgeltungen.sql
--------------------------------------------------------------------------------
arp_mjpnl_v2_zahlungslauf/auswertung_calc_snapshot_weide.sql
--------------------------------------------------------------------------------
arp_mjpnl_v2_zahlungslauf/calc_mjpnl_abrechnung_per_leistung_wiese.sql
--------------------------------------------------------------------------------
arp_mjpnl_v2_zahlungslauf/cleanup_mjpnl_abrechnung_per_leistung_orphans.sql
--------------------------------------------------------------------------------
arp_mjpnl_v2_zahlungslauf/auswertung_calc_rrb_bewirtschafterwechsel.sql
--------------------------------------------------------------------------------
arp_mjpnl_v2_zahlungslauf/calc_mjpnl_abrechnung_per_leistung_wbl_weide.sql
--------------------------------------------------------------------------------
arp_mjpnl_v2_zahlungslauf/auswertung_calc_snapshot_wbl_wiese.sql
--------------------------------------------------------------------------------
arp_mjpnl_v2_zahlungslauf/auswertung_calc_rrb_neue_vereinbarung.sql
--------------------------------------------------------------------------------
arp_mjpnl_v2_zahlungslauf/auswertung_calc_snapshot_wbl_weide.sql
--------------------------------------------------------------------------------
arp_mjpnl_v2_zahlungslauf/calc_mjpnl_abrechnung_per_leistung_wbl_wiese.sql
--------------------------------------------------------------------------------
arp_mjpnl_v2_zahlungslauf/auswertung_calc_jahresbericht_abgeltungen.sql
class net.sf.jsqlparser.JSQLParserException
net.sf.jsqlparser.parser.ParseException: Encountered unexpected token: "is" "IS"
    at line 50, column 57.

Was expecting one of:

    "THEN"

Error parsing: INSERT INTO xxx_1.auswertung_jahresbericht_abgeltungen
(   t_basket,
    jahr,
    vereinbarungsart,
    bezirksnummer,
    bezirk,
    anzahl_vereinbarungen,
    flaeche_total,
    laufmeter_total,
    baeume_total,
	baeume_baumab40cmdurchmesser_total,
	baeume_erntepflicht_total,
	baeume_oekoplus_total,
	baeume_oekomaxi_total,
	betrag_total,
	anzahl_gemeinden
)
WITH leistungen_per_vereinbarung AS (
    SELECT vereinbarung, SUM(betrag_total) as betrag_total
    FROM xxx_1.mjpnl_abrechnung_per_leistung
    WHERE auszahlungsjahr = xxx_3::integer
    GROUP BY vereinbarung
),
beurteilungs_metainfo_baeume AS (
   SELECT vereinbarung, beurteilungsdatum,
   grundbeitrag_baum_anzahl,
   beitrag_baumab40cmdurchmesser_anzahl,
   beitrag_erntepflicht_anzahl,
   beitrag_oekoplus_anzahl,
   beitrag_oekomaxi_anzahl
   FROM xxx_1.mjpnl_beurteilung_hostet
	UNION 
   SELECT vereinbarung, beurteilungsdatum, 
   grundbeitrag_baum_anzahl,
   beitrag_baumab40cmdurchmesser_anzahl,
   beitrag_erntepflicht_anzahl,
   beitrag_oekoplus_anzahl,
   beitrag_oekomaxi_anzahl
   FROM xxx_1.mjpnl_beurteilung_obl
)
SELECT 
    (SELECT t_id FROM xxx_1.t_ili2db_basket WHERE topic = 'SO_ARP_MJPNL_20240606.Auswertung' LIMIT 1) as t_basket,
    xxx_3::integer as jahr,
    vbg.vereinbarungsart as vereinbarungsart,
	COALESCE(bezirk.bezirksnummer,0),
	COALESCE(bezirk.bezirksname,'unbekannt'),
	COUNT(vbg.vereinbarungs_nr) anzahl_vereinbarungen,
	SUM(vbg.flaeche) as flaeche_total,
    SUM(
    case when (string_to_array(vbg.bemerkung,'***'))[2] is json and json_typeof((string_to_array(vbg.bemerkung,'***'))[2]::json) = 'object' 
    then ((string_to_array(vbg.bemerkung,'***'))[2]::jsonb->>'meter')::integer /
        case when ((string_to_array(vbg.bemerkung,'***'))[2]::jsonb->>'grenze')::boolean is true
        then 2
        else 1
        end
    else 0
    end) as laufmeter,
	SUM(COALESCE(bae.grundbeitrag_baum_anzahl, 0)) as baeume_total,
	SUM(COALESCE(bae.beitrag_baumab40cmdurchmesser_anzahl, 0)) as baeume_baumab40cmdurchmesser_total,
	SUM(COALESCE(bae.beitrag_erntepflicht_anzahl, 0)) as baeume_erntepflicht_total,
	SUM(COALESCE(bae.beitrag_oekoplus_anzahl, 0)) as baeume_oekoplus_total,
	SUM(COALESCE(bae.beitrag_oekomaxi_anzahl, 0)) as baeume_oekomaxi_total,
	SUM(COALESCE(lstg.betrag_total,0)) as betrag_total,
	count(DISTINCT gemeinde.bfs_gemeindenummer) as anzahl_gemeinden
FROM xxx_1.mjpnl_vereinbarung vbg
LEFT JOIN agi_hoheitsgrenzen_v1.hoheitsgrenzen_gemeinde gemeinde
ON gemeinde.bfs_gemeindenummer = vbg.bfs_nr[1]
LEFT JOIN agi_hoheitsgrenzen_v1.hoheitsgrenzen_bezirk bezirk
ON bezirk.t_id = gemeinde.bezirk
LEFT JOIN beurteilungs_metainfo_baeume bae
ON vbg.t_id = bae.vereinbarung
-- berücksichtige nur die neusten (sofern mehrere existieren)
AND bae.beurteilungsdatum = (SELECT MAX(beurteilungsdatum) FROM beurteilungs_metainfo_baeume be WHERE be.vereinbarung = vbg.t_id)
-- wir holen den totalbetrag aus den leistungen, da auch einmalige miteinbezogen werden sollen
LEFT JOIN leistungen_per_vereinbarung lstg
ON lstg.vereinbarung = vbg.t_id
WHERE vbg.status_vereinbarung = 'aktiv' AND vbg.bewe_id_geprueft IS TRUE AND vbg.ist_nutzungsvereinbarung IS NOT TRUE
GROUP BY bezirk.bezirksnummer, bezirk.bezirksname, vbg.vereinbarungsart
ORDER BY vbg.vereinbarungsart, bezirk.bezirksnummer (net.sf.jsqlparser.parser.ParseException: Encountered unexpected token: "is" "IS"
    at line 50, column 57.

Was expecting one of:

    "THEN"
)
********************************************************************************
--------------------------------------------------------------------------------
arp_mjpnl_v2_zahlungslauf/calc_mjpnl_abrechnung_per_leistung_hecke.sql
--------------------------------------------------------------------------------
arp_mjpnl_v2_zahlungslauf/delete_mjpnl_migrierte_leistungen.sql
--------------------------------------------------------------------------------
arp_mjpnl_v2_zahlungslauf/calc_mjpnl_abrechnung_per_vereinbarung.sql
--------------------------------------------------------------------------------
arp_mjpnl_v2_zahlungslauf/cleanup_mjpnl_abrechnung_per_bewirtschafter.sql
--------------------------------------------------------------------------------
arp_mjpnl_v2_zahlungslauf/calc_mjpnl_abrechnung_per_leistung_alr_saum.sql
--------------------------------------------------------------------------------
arp_mjpnl_v2_zahlungslauf/auswertung_cleanup_snapshot_weide.sql
--------------------------------------------------------------------------------
arp_mjpnl_v2_zahlungslauf/copy_mjpnl_abrechnung_per_leistung.sql
--------------------------------------------------------------------------------
arp_mjpnl_v2_zahlungslauf/calc_mjpnl_abrechnung_per_bewirtschafter.sql
--------------------------------------------------------------------------------
arp_mjpnl_v2_zahlungslauf/calc_mjpnl_abrechnung_per_leistung_alr_buntbrache.sql
--------------------------------------------------------------------------------
arp_mjpnl_v2_zahlungslauf/auswertung_cleanup_snapshot_wiese.sql
--------------------------------------------------------------------------------
arp_mjpnl_v2_zahlungslauf/cleanup_mjpnl_abrechnung_per_leistung_status.sql
--------------------------------------------------------------------------------
arp_mjpnl_v2_zahlungslauf/cleanup_mjpnl_abrechnung_per_leistung.sql
--------------------------------------------------------------------------------
arp_mjpnl_v2_zahlungslauf/calc_mjpnl_abrechnung_per_leistung_weide_ln.sql
--------------------------------------------------------------------------------
arp_mjpnl_v2_zahlungslauf/calc_mjpnl_abrechnung_per_leistung_hostet.sql
--------------------------------------------------------------------------------
arp_mjpnl_v2_zahlungslauf/calc_mjpnl_abrechnung_per_leistung_weide_soeg.sql
--------------------------------------------------------------------------------
arp_mjpnl_v2_zahlungslauf/cleanup_mjpnl_abrechnung_per_vereinbarung.sql
--------------------------------------------------------------------------------
afu_isboden_pub/afu_isboden_pub_hinweiskarte_bodenverdichtung.sql
class net.sf.jsqlparser.JSQLParserException
net.sf.jsqlparser.parser.TokenMgrException: Lexical error at line 6, column 46.  Encountered: <EOF> after prefix "\'geringes Verdichtungsrisiko"
Error parsing: SELECT
    ogc_fid AS t_id,
    risk_final,
    CASE
        WHEN risk_final = 1
            THEN 'geringes Verdichtungsrisiko (net.sf.jsqlparser.parser.TokenMgrException: Lexical error at line 6, column 46.  Encountered: <EOF> after prefix "\'geringes Verdichtungsrisiko")
********************************************************************************
class net.sf.jsqlparser.JSQLParserException
net.sf.jsqlparser.parser.ParseException: Encountered unexpected token: "befahren" <S_IDENTIFIER>
    at line 1, column 1.

Was expecting one of:

    "("
    "ALTER"
    "ANALYZE"
    "BEGIN"
    "CALL"
    "COMMENT"
    "COMMIT"
    "CREATE"
    "DECLARE"
    "DELETE"
    "DESC"
    "DESCRIBE"
    "DROP"
    "EXEC"
    "EXECUTE"
    "EXPLAIN"
    "FROM"
    "GRANT"
    "IF"
    "INSERT"
    "MERGE"
    "PURGE"
    "REFRESH"
    "RENAME"
    "REPLACE"
    "RESET"
    "ROLLBACK"
    "SAVEPOINT"
    "SET"
    "SHOW"
    "SUMMARIZE"
    "TABLE"
    "TRUNCATE"
    "UPDATE"
    "UPSERT"
    "USE"
    "VALUE"
    "VALUES"
    "WITH"
    <K_SELECT>

Error parsing: befahren mit üblicher Sorgfalt, weiter Rückegassenabstand empfohlen'
        WHEN risk_final = 2
            THEN 'mittleres Verdichtungsrisiko (net.sf.jsqlparser.parser.ParseException: Encountered unexpected token: "befahren" <S_IDENTIFIER>
    at line 1, column 1.

Was expecting one of:

    "("
    "ALTER"
    "ANALYZE"
    "BEGIN"
    "CALL"
    "COMMENT"
    "COMMIT"
    "CREATE"
    "DECLARE"
    "DELETE"
    "DESC"
    "DESCRIBE"
    "DROP"
    "EXEC"
    "EXECUTE"
    "EXPLAIN"
    "FROM"
    "GRANT"
    "IF"
    "INSERT"
    "MERGE"
    "PURGE"
    "REFRESH"
    "RENAME"
    "REPLACE"
    "RESET"
    "ROLLBACK"
    "SAVEPOINT"
    "SET"
    "SHOW"
    "SUMMARIZE"
    "TABLE"
    "TRUNCATE"
    "UPDATE"
    "UPSERT"
    "USE"
    "VALUE"
    "VALUES"
    "WITH"
    <K_SELECT>
)
********************************************************************************
class net.sf.jsqlparser.JSQLParserException
net.sf.jsqlparser.parser.ParseException: Encountered unexpected token: "nach" <S_IDENTIFIER>
    at line 1, column 1.

Was expecting one of:

    "("
    "ALTER"
    "ANALYZE"
    "BEGIN"
    "CALL"
    "COMMENT"
    "COMMIT"
    "CREATE"
    "DECLARE"
    "DELETE"
    "DESC"
    "DESCRIBE"
    "DROP"
    "EXEC"
    "EXECUTE"
    "EXPLAIN"
    "FROM"
    "GRANT"
    "IF"
    "INSERT"
    "MERGE"
    "PURGE"
    "REFRESH"
    "RENAME"
    "REPLACE"
    "RESET"
    "ROLLBACK"
    "SAVEPOINT"
    "SET"
    "SHOW"
    "SUMMARIZE"
    "TABLE"
    "TRUNCATE"
    "UPDATE"
    "UPSERT"
    "USE"
    "VALUE"
    "VALUES"
    "WITH"
    <K_SELECT>

Error parsing: nach Abtrocknungsphase gut mechanisch belastbar, weiter Rückegassenabstand empfohlen'
        WHEN risk_final = 3
            THEN 'hohes Verdichtungsrisiko (wechselfeucht) (net.sf.jsqlparser.parser.ParseException: Encountered unexpected token: "nach" <S_IDENTIFIER>
    at line 1, column 1.

Was expecting one of:

    "("
    "ALTER"
    "ANALYZE"
    "BEGIN"
    "CALL"
    "COMMENT"
    "COMMIT"
    "CREATE"
    "DECLARE"
    "DELETE"
    "DESC"
    "DESCRIBE"
    "DROP"
    "EXEC"
    "EXECUTE"
    "EXPLAIN"
    "FROM"
    "GRANT"
    "IF"
    "INSERT"
    "MERGE"
    "PURGE"
    "REFRESH"
    "RENAME"
    "REPLACE"
    "RESET"
    "ROLLBACK"
    "SAVEPOINT"
    "SET"
    "SHOW"
    "SUMMARIZE"
    "TABLE"
    "TRUNCATE"
    "UPDATE"
    "UPSERT"
    "USE"
    "VALUE"
    "VALUES"
    "WITH"
    <K_SELECT>
)
********************************************************************************
class net.sf.jsqlparser.JSQLParserException
net.sf.jsqlparser.parser.ParseException: Encountered unexpected token: "erh\u00f6hte" <S_IDENTIFIER>
    at line 1, column 1.

Was expecting one of:

    "("
    "ALTER"
    "ANALYZE"
    "BEGIN"
    "CALL"
    "COMMENT"
    "COMMIT"
    "CREATE"
    "DECLARE"
    "DELETE"
    "DESC"
    "DESCRIBE"
    "DROP"
    "EXEC"
    "EXECUTE"
    "EXPLAIN"
    "FROM"
    "GRANT"
    "IF"
    "INSERT"
    "MERGE"
    "PURGE"
    "REFRESH"
    "RENAME"
    "REPLACE"
    "RESET"
    "ROLLBACK"
    "SAVEPOINT"
    "SET"
    "SHOW"
    "SUMMARIZE"
    "TABLE"
    "TRUNCATE"
    "UPDATE"
    "UPSERT"
    "USE"
    "VALUE"
    "VALUES"
    "WITH"
    <K_SELECT>

Error parsing: erhöhte Sorgfalt beim Befahren notwendig, Trockenphasen optimal nutzen, sehr weiter Rückegassenabstand empfohlen'
        WHEN risk_final = 4
            THEN 'sehr hohes Verdichtungsrisiko (net.sf.jsqlparser.parser.ParseException: Encountered unexpected token: "erh\u00f6hte" <S_IDENTIFIER>
    at line 1, column 1.

Was expecting one of:

    "("
    "ALTER"
    "ANALYZE"
    "BEGIN"
    "CALL"
    "COMMENT"
    "COMMIT"
    "CREATE"
    "DECLARE"
    "DELETE"
    "DESC"
    "DESCRIBE"
    "DROP"
    "EXEC"
    "EXECUTE"
    "EXPLAIN"
    "FROM"
    "GRANT"
    "IF"
    "INSERT"
    "MERGE"
    "PURGE"
    "REFRESH"
    "RENAME"
    "REPLACE"
    "RESET"
    "ROLLBACK"
    "SAVEPOINT"
    "SET"
    "SHOW"
    "SUMMARIZE"
    "TABLE"
    "TRUNCATE"
    "UPDATE"
    "UPSERT"
    "USE"
    "VALUE"
    "VALUES"
    "WITH"
    <K_SELECT>
)
********************************************************************************
class net.sf.jsqlparser.JSQLParserException
net.sf.jsqlparser.parser.ParseException: Encountered unexpected token: "nur" <S_IDENTIFIER>
    at line 1, column 1.

Was expecting one of:

    "("
    "ALTER"
    "ANALYZE"
    "BEGIN"
    "CALL"
    "COMMENT"
    "COMMIT"
    "CREATE"
    "DECLARE"
    "DELETE"
    "DESC"
    "DESCRIBE"
    "DROP"
    "EXEC"
    "EXECUTE"
    "EXPLAIN"
    "FROM"
    "GRANT"
    "IF"
    "INSERT"
    "MERGE"
    "PURGE"
    "REFRESH"
    "RENAME"
    "REPLACE"
    "RESET"
    "ROLLBACK"
    "SAVEPOINT"
    "SET"
    "SHOW"
    "SUMMARIZE"
    "TABLE"
    "TRUNCATE"
    "UPDATE"
    "UPSERT"
    "USE"
    "VALUE"
    "VALUES"
    "WITH"
    <K_SELECT>

Error parsing: nur eingeschränkt mechanisch belastbar, längere Trockenphasen abwarten, ergänzend lastreduzierende und lastverteilende Massnahmen ergreifen, sehr weiter Rückegassenabstand empfohlen'
        WHEN risk_final = 5
            THEN 'nicht befahrbar: Standort zu nass für Befahrung'
        WHEN risk_final = 6
            THEN 'Befahrung nicht empfohlen wegen Topographie (zu steil)'
        WHEN risk_final = 7
            THEN 'seltener Waldstandort: Befahrung nicht abgebracht'
        WHEN risk_final = 8
            THEN 'Ruderalflächen / fehlende Angaben'
    END AS verdempf_t,
    wkb_geometry AS geometrie
FROM
    afu_isboden.hinweiskarte_bodenverdichtung_qgis_server_client_t (net.sf.jsqlparser.parser.ParseException: Encountered unexpected token: "nur" <S_IDENTIFIER>
    at line 1, column 1.

Was expecting one of:

    "("
    "ALTER"
    "ANALYZE"
    "BEGIN"
    "CALL"
    "COMMENT"
    "COMMIT"
    "CREATE"
    "DECLARE"
    "DELETE"
    "DESC"
    "DESCRIBE"
    "DROP"
    "EXEC"
    "EXECUTE"
    "EXPLAIN"
    "FROM"
    "GRANT"
    "IF"
    "INSERT"
    "MERGE"
    "PURGE"
    "REFRESH"
    "RENAME"
    "REPLACE"
    "RESET"
    "ROLLBACK"
    "SAVEPOINT"
    "SET"
    "SHOW"
    "SUMMARIZE"
    "TABLE"
    "TRUNCATE"
    "UPDATE"
    "UPSERT"
    "USE"
    "VALUE"
    "VALUES"
    "WITH"
    <K_SELECT>
)
********************************************************************************
--------------------------------------------------------------------------------
afu_isboden_pub/afu_isboden_pub_bodenerosion.sql
--------------------------------------------------------------------------------
afu_isboden_pub/afu_isboden_pub_bodeneinheit.sql
class net.sf.jsqlparser.JSQLParserException
net.sf.jsqlparser.parser.ParseException: Encountered unexpected token: "\n\n\n" <ST_SEMICOLON>
    at line 125, column 2.

Was expecting one of:

    "("
    ","
    "DELETE"
    "FROM"
    "INSERT"
    "MERGE"
    "UPDATE"
    "VALUE"
    "VALUES"
    "WITH"
    <K_SELECT>

Error parsing: WITH charakter_wasserhaushalt AS (
    SELECT
        bodeneinheit_onlinedata_t.pk_isboden AS t_id,
        CASE
            WHEN wasserhhgr_t.code IN ('a', 'b', 'c', 'd', 'e')
                THEN 'kein Einfluss von Stau- oder Grundwasser'
            WHEN wasserhhgr_t.code IN ('f', 'g', 'h', 'i')
                THEN 'leichter Einfluss von Stauwasser'
            WHEN wasserhhgr_t.code IN ('k', 'l', 'm', 'n')
                THEN 'leichter Einfluss von Grund- oder Hangwasser'
            WHEN wasserhhgr_t.code IN ('o', 'p', 'q', 'r')
                THEN 'starker Einfluss von Stauwasser. Falls nicht drainiert, stellenweise dauernd vernässt'
            WHEN wasserhhgr_t.code IN ('s', 't', 'u', 'v', 'w', 'x', 'y', 'z')
                THEN 'starker Einfluss von Grund- oder Hangwasser. Falls nicht drainiert, stellenweise dauernd vernässt'
        END AS charakter_wasserhaushalt,
        CASE
            WHEN
                bodeneinheit_onlinedata_t.is_wald IS TRUE
                AND
                (
                    wasserhhgr_t.code IN ('a', 'b', 'f', 'k', 's')
                    OR
                    (
                        wasserhhgr_t.code ='o'
                        AND
                        bodeneinheit_auspraegung_t.pflngr >= 70
                    )
                )
                THEN 'tiefgründiger Boden, d.h. pflanzennutzbare Gründigkeit > 70 cm'
            WHEN
                bodeneinheit_onlinedata_t.is_wald IS TRUE         
                AND
                (
                    wasserhhgr_t.code  IN ('c', 'd', 'g', 'h', 'l', 'm', 'q', 't', 'v', 'x')
                    OR
                    (
                        (
                            wasserhhgr_t.code ='o'
                            AND
                            (
                                bodeneinheit_auspraegung_t.pflngr < 70
                                OR
                                bodeneinheit_auspraegung_t.pflngr IS NULL
                            )
                        )
                        OR
                        (
                            wasserhhgr_t.code = 'p'
                            AND
                            bodeneinheit_auspraegung_t.pflngr >= 30
                        )
                        OR
                        (
                            wasserhhgr_t.code = 'u'
                            AND
                            bodeneinheit_auspraegung_t.pflngr >= 30
                        )
                        OR
                        (
                            wasserhhgr_t.code = 'w'
                            AND
                            bodeneinheit_auspraegung_t.pflngr >= 30
                        )
                    )
                )
                THEN 'mittelgründiger Boden, d.h. pflanzennutzbare Gründigkeit 30 - 70 cm'
            WHEN
                bodeneinheit_onlinedata_t.is_wald IS TRUE  
                AND
                ((   
                    wasserhhgr_t.code IN ('e', 'i', 'n')
                    OR
                    (
                        wasserhhgr_t.code ='p'
                        AND
                        (
                            bodeneinheit_auspraegung_t.pflngr < 30
                            OR
                            bodeneinheit_auspraegung_t.pflngr IS NULL
                        )
                    )
                    OR
                    wasserhhgr_t.code = 'r'
                )
                OR
                (
                    (
                        wasserhhgr_t.code = 'u'
                        AND
                        bodeneinheit_auspraegung_t.pflngr < 30
                    )
                    OR
                    (
                        wasserhhgr_t.code = 'w'
                        AND
                        (
                            bodeneinheit_auspraegung_t.pflngr < 30
                            OR
                            bodeneinheit_auspraegung_t.pflngr IS NULL
                        )
                    )
                    OR
                    wasserhhgr_t.code IN ('y', 'z')
                )) 
                THEN 'flachgründiger Boden, d.h. pflanzennutzbare Gründigkeit < 30 cm'
        END AS wald_charakter_wasserhaushalt
    FROM
        afu_isboden.bodeneinheit_onlinedata_t
        LEFT JOIN afu_isboden.bodeneinheit_t
            ON bodeneinheit_onlinedata_t.objnr = bodeneinheit_t.objnr
        LEFT JOIN afu_isboden.bodeneinheit_auspraegung_t
            ON bodeneinheit_auspraegung_t.fk_bodeneinheit = bodeneinheit_t.pk_ogc_fid
        LEFT JOIN afu_isboden.wasserhhgr_t
            ON wasserhhgr_t.pk_wasserhhgr = bodeneinheit_auspraegung_t.fk_wasserhhgr
    WHERE
        bodeneinheit_onlinedata_t.archive = 0
        AND
        bodeneinheit_auspraegung_t.is_hauptauspraegung
        AND
        bodeneinheit_onlinedata_t.gemnr = bodeneinheit_t.gemnr
        AND
        bodeneinheit_t.archive = 0
        AND
        bodeneinheit_t.los = bodeneinheit_onlinedata_t.los
)


SELECT
    bodeneinheit_onlinedata_t.pk_isboden AS t_id,
    bodeneinheit_onlinedata_t.gemnr,
    bodeneinheit_onlinedata_t.objnr,
    wasserhhgr_t.code AS wasserhhgr,
    wasserhhgr_t.beschreibung AS wasserhhgr_beschreibung,
    concat_ws(', ',charakter_wasserhaushalt.wald_charakter_wasserhaushalt, charakter_wasserhaushalt.charakter_wasserhaushalt) AS charakter_wasserhaushalt,
    CASE
        WHEN wasserhhgr_t.code = 'a'
            THEN 'a - sehr tiefgründig'
        WHEN wasserhhgr_t.code = 'b'
            THEN 'b - tiefgründig'
        WHEN wasserhhgr_t.code = 'c'
            THEN 'c - mässig tiefgründig'
        WHEN wasserhhgr_t.code = 'd'
            THEN 'd - ziemlich flachgründig'
        WHEN wasserhhgr_t.code = 'e'
            THEN 'e - flachgründig und sehr flachgründig'
        WHEN wasserhhgr_t.code = 'f'
            THEN 'f - tiefgründig'
        WHEN wasserhhgr_t.code = 'g'
            THEN 'g - mässig tiefgründig'
        WHEN wasserhhgr_t.code = 'h'
            THEN 'h - ziemlich flachgründig' 
        WHEN wasserhhgr_t.code = 'i'
            THEN 'i - flachgründig und sehr flachgründig'
        WHEN wasserhhgr_t.code = 'k'
            THEN 'k - tiefgründig'
        WHEN wasserhhgr_t.code = 'l'
            THEN 'l - mässig tiefgründig'
        WHEN wasserhhgr_t.code = 'm'
            THEN 'm - ziemlich flachgründig'
        WHEN wasserhhgr_t.code = 'n'
            THEN 'n - flachgründig und sehr flachgründig'
        WHEN wasserhhgr_t.code = 'o'
            THEN 'o - mässig tiefgründig und tiefgründig'
        WHEN wasserhhgr_t.code = 'p'
            THEN 'p - ziemlich flachgründig und flachgründig'
        WHEN wasserhhgr_t.code = 'q'
            THEN 'q - ziemlich flachgründig'
        WHEN wasserhhgr_t.code = 'r'
            THEN 'r - flachgründig und sehr flachgründig'
        WHEN wasserhhgr_t.code = 's'
            THEN 's - tiefgründig'
        WHEN wasserhhgr_t.code = 't'
            THEN 't - mässig tiefgründig'
        WHEN wasserhhgr_t.code = 'u'
            THEN 'u - ziemlich flachgründig und flachgründig'
        WHEN wasserhhgr_t.code = 'v'
            THEN 'v - mässig tiefgründig'
        WHEN wasserhhgr_t.code = 'w'
            THEN 'w - ziemlich flachgründig und flachgründig'
        WHEN wasserhhgr_t.code = 'y'
            THEN 'y - flachgründig und sehr flachgründig'
        WHEN wasserhhgr_t.code = 'x'
            THEN 'x - ziemlich flachgründig'
        WHEN wasserhhgr_t.code = 'z'
            THEN 'z - sehr flachgründig'
    END AS wasserhaushalt_spezifisch,
    CASE 
        WHEN wasserhhgr_t.code IN ('a', 'b', 'c', 'd', 'e')
            THEN 'Senkrecht durchwaschen, normal durchlässig und'
        WHEN wasserhhgr_t.code IN ('f', 'g', 'h', 'i')
            THEN 'Senkrecht durchwaschen, stauwasserbeeinflusst und'
        WHEN wasserhhgr_t.code IN ('k', 'l', 'm', 'n')
            THEN 'Senkrecht durchwaschen, grund- oder hangwasserbeeinflusst und'
        WHEN wasserhhgr_t.code IN ('o', 'p')
            THEN 'Stauwassergeprägt, selten bis zur Oberfläche porengesättigt und'
        WHEN wasserhhgr_t.code IN ('q', 'r')
            THEN 'Stauwassergeprägt, häufig bis zur Oberfläche porengesättigt und'
        WHEN wasserhhgr_t.code IN ('s', 't', 'u')
            THEN 'Grund- oder hangwassergeprägt, selten bis zur Oberfläche porengesättigt und'
        WHEN wasserhhgr_t.code IN ('v', 'w')
            THEN 'Grund- oder hangwassergeprägt, häufig bis zur Oberfläche porengesättigt und '
        WHEN wasserhhgr_t.code IN ('x', 'y')
            THEN 'Grund- oder hangwassergeprägt, meist bis zur Oberfläche porengesättigt und'
        WHEN wasserhhgr_t.code = 'z'
            THEN 'Grund- oder hangwassergeprägt, dauernd bis zur Oberfläche porengesättigt und'
    END AS wasserhaushalt_uebergreifend,
    bodentyp_t.code AS bodentyp,
    bodentyp_t.beschreibung AS bodentyp_beschreibung,
    begelfor_t.code AS gelform,
    begelfor_t.beschreibung AS gelform_beschreibung,
    CASE
        WHEN 
            begelfor_t.code IN ('a', 'b', 'c', 'd', 'e')
            AND
            bodeneinheit_onlinedata_t.is_wald IS FALSE
                THEN '0-10%: Keine Einschränkung'
        WHEN
            begelfor_t.code IN ('f', 'g', 'h', 'i')
            AND
            bodeneinheit_onlinedata_t.is_wald IS FALSE
                THEN '10-15%: Hackfruchtanbau und Vollerntemaschine möglich'
        WHEN
            begelfor_t.code IN ('j', 'k', 'l', 'm', 'n')
            AND
            bodeneinheit_onlinedata_t.is_wald IS FALSE
                THEN '15-25%: Hackfruchtanbau stark erschwert, Getreidebau erschwert (net.sf.jsqlparser.parser.ParseException: Encountered unexpected token: "\n\n\n" <ST_SEMICOLON>
    at line 125, column 2.

Was expecting one of:

    "("
    ","
    "DELETE"
    "FROM"
    "INSERT"
    "MERGE"
    "UPDATE"
    "VALUE"
    "VALUES"
    "WITH"
    <K_SELECT>
)
********************************************************************************
class net.sf.jsqlparser.JSQLParserException
net.sf.jsqlparser.parser.ParseException: Encountered unexpected token: "M\u00e4hdrescher" <S_IDENTIFIER>
    at line 1, column 1.

Was expecting one of:

    "("
    "ALTER"
    "ANALYZE"
    "BEGIN"
    "CALL"
    "COMMENT"
    "COMMIT"
    "CREATE"
    "DECLARE"
    "DELETE"
    "DESC"
    "DESCRIBE"
    "DROP"
    "EXEC"
    "EXECUTE"
    "EXPLAIN"
    "FROM"
    "GRANT"
    "IF"
    "INSERT"
    "MERGE"
    "PURGE"
    "REFRESH"
    "RENAME"
    "REPLACE"
    "RESET"
    "ROLLBACK"
    "SAVEPOINT"
    "SET"
    "SHOW"
    "SUMMARIZE"
    "TABLE"
    "TRUNCATE"
    "UPDATE"
    "UPSERT"
    "USE"
    "VALUE"
    "VALUES"
    "WITH"
    <K_SELECT>

Error parsing: Mähdrescher möglich, evtl. Hangmähdrescher'
        WHEN
            begelfor_t.code IN ('o', 'p', 'q', 'r')
            AND
            bodeneinheit_onlinedata_t.is_wald IS FALSE
                THEN '25-35%: Getreideanbau stark eingeschränkt, Hangmähdrescher (net.sf.jsqlparser.parser.ParseException: Encountered unexpected token: "M\u00e4hdrescher" <S_IDENTIFIER>
    at line 1, column 1.

Was expecting one of:

    "("
    "ALTER"
    "ANALYZE"
    "BEGIN"
    "CALL"
    "COMMENT"
    "COMMIT"
    "CREATE"
    "DECLARE"
    "DELETE"
    "DESC"
    "DESCRIBE"
    "DROP"
    "EXEC"
    "EXECUTE"
    "EXPLAIN"
    "FROM"
    "GRANT"
    "IF"
    "INSERT"
    "MERGE"
    "PURGE"
    "REFRESH"
    "RENAME"
    "REPLACE"
    "RESET"
    "ROLLBACK"
    "SAVEPOINT"
    "SET"
    "SHOW"
    "SUMMARIZE"
    "TABLE"
    "TRUNCATE"
    "UPDATE"
    "UPSERT"
    "USE"
    "VALUE"
    "VALUES"
    "WITH"
    <K_SELECT>
)
********************************************************************************
class net.sf.jsqlparser.JSQLParserException
net.sf.jsqlparser.parser.ParseException: Encountered unexpected token: "Hangtraktoren" <S_IDENTIFIER>
    at line 1, column 1.

Was expecting one of:

    "("
    "ALTER"
    "ANALYZE"
    "BEGIN"
    "CALL"
    "COMMENT"
    "COMMIT"
    "CREATE"
    "DECLARE"
    "DELETE"
    "DESC"
    "DESCRIBE"
    "DROP"
    "EXEC"
    "EXECUTE"
    "EXPLAIN"
    "FROM"
    "GRANT"
    "IF"
    "INSERT"
    "MERGE"
    "PURGE"
    "REFRESH"
    "RENAME"
    "REPLACE"
    "RESET"
    "ROLLBACK"
    "SAVEPOINT"
    "SET"
    "SHOW"
    "SUMMARIZE"
    "TABLE"
    "TRUNCATE"
    "UPDATE"
    "UPSERT"
    "USE"
    "VALUE"
    "VALUES"
    "WITH"
    <K_SELECT>

Error parsing: Hangtraktoren.'
        WHEN
            begelfor_t.code IN ('s', 't', 'u', 'v', 'w', 'x', 'y', 'z')
            AND
            bodeneinheit_onlinedata_t.is_wald IS FALSE
                THEN '>35%: nur Mähwiese und Weide möglich (net.sf.jsqlparser.parser.ParseException: Encountered unexpected token: "Hangtraktoren" <S_IDENTIFIER>
    at line 1, column 1.

Was expecting one of:

    "("
    "ALTER"
    "ANALYZE"
    "BEGIN"
    "CALL"
    "COMMENT"
    "COMMIT"
    "CREATE"
    "DECLARE"
    "DELETE"
    "DESC"
    "DESCRIBE"
    "DROP"
    "EXEC"
    "EXECUTE"
    "EXPLAIN"
    "FROM"
    "GRANT"
    "IF"
    "INSERT"
    "MERGE"
    "PURGE"
    "REFRESH"
    "RENAME"
    "REPLACE"
    "RESET"
    "ROLLBACK"
    "SAVEPOINT"
    "SET"
    "SHOW"
    "SUMMARIZE"
    "TABLE"
    "TRUNCATE"
    "UPDATE"
    "UPSERT"
    "USE"
    "VALUE"
    "VALUES"
    "WITH"
    <K_SELECT>
)
********************************************************************************
class net.sf.jsqlparser.JSQLParserException
net.sf.jsqlparser.parser.ParseException: Encountered unexpected token: "spezialisierte" <S_IDENTIFIER>
    at line 1, column 1.

Was expecting one of:

    "("
    "ALTER"
    "ANALYZE"
    "BEGIN"
    "CALL"
    "COMMENT"
    "COMMIT"
    "CREATE"
    "DECLARE"
    "DELETE"
    "DESC"
    "DESCRIBE"
    "DROP"
    "EXEC"
    "EXECUTE"
    "EXPLAIN"
    "FROM"
    "GRANT"
    "IF"
    "INSERT"
    "MERGE"
    "PURGE"
    "REFRESH"
    "RENAME"
    "REPLACE"
    "RESET"
    "ROLLBACK"
    "SAVEPOINT"
    "SET"
    "SHOW"
    "SUMMARIZE"
    "TABLE"
    "TRUNCATE"
    "UPDATE"
    "UPSERT"
    "USE"
    "VALUE"
    "VALUES"
    "WITH"
    <K_SELECT>

Error parsing: spezialisierte Hangmechanisierung'
    END AS gelform_text,
    bodeneinheit_auspraegung_t.geologie,
    concat_ws(', ', untertyp.untertyp_e, untertyp.untertyp_k, untertyp.untertyp_i, untertyp.untertyp_g, untertyp.untertyp_r, untertyp.untertyp_p, untertyp.untertyp_div) AS untertyp,
    skelett_t_ob.code AS skelett_ob,
    skelett_t_ob.beschreibung AS skelett_ob_beschreibung,
    CASE
        WHEN skelett_t_ob.code = 0
            THEN 'keine oder nur wenige Steine (0-5%)'
        WHEN skelett_t_ob.code = 1
            THEN 'mässig viele Steine (5-10%)'
        WHEN skelett_t_ob.code IN (2, 3)
            THEN 'viele Steine (10-20%)'
        WHEN skelett_t_ob.code IN (4, 5)
            THEN 'sehr viele Steine (20-30%)'
        WHEN skelett_t_ob.code >= 6
            THEN 'extrem viele Steine (> 30%)'
    END AS skelett_ob_text,
    skelett_t_ub.code AS skelett_ub,
    skelett_t_ub.beschreibung AS skelett_ub_beschreibung,
    CASE
        WHEN
            skelett_t_ub.code = 0
            AND
            bodeneinheit_onlinedata_t.is_wald IS TRUE
                THEN 'keine oder nur wenige Steine (0-5%)'
        WHEN
            skelett_t_ub.code = 1
            AND
            bodeneinheit_onlinedata_t.is_wald IS TRUE
                THEN 'mässig viele Steine (5-10%)'
        WHEN
            skelett_t_ub.code IN (2, 3)
            AND
            bodeneinheit_onlinedata_t.is_wald IS TRUE
                THEN 'viele Steine (10-20%)'
        WHEN
            skelett_t_ub.code IN (4, 5)
            AND
            bodeneinheit_onlinedata_t.is_wald IS TRUE
                THEN 'sehr viele Steine (20-30%)'
        WHEN
            skelett_t_ub.code >= 6
            AND 
            bodeneinheit_onlinedata_t.is_wald IS TRUE
                THEN 'extrem viele Steine (> 30%)'
    END AS skelett_ub_text,
    koernkl_t_ob.code AS koernkl_ob,
    koernkl_t_ob.beschreibung AS koernkl_ob_beschreibung,
    CASE
        WHEN
            koernkl_t_ob.code IN (7, 8, 9, 13)
            AND
            bodeneinheit_onlinedata_t.is_wald IS FALSE
                THEN 'Schwere, tonige Böden: schwer bearbeitbar, trocknen sehr langsam ab.'
        WHEN
            koernkl_t_ob.code IN (7, 8, 9, 13)
            AND
            bodeneinheit_onlinedata_t.is_wald IS TRUE
                THEN 'Schwere, tonige Böden: trocknen sehr langsam ab.'
        WHEN
            koernkl_t_ob.code IN (5, 6, 10, 11, 12)
            AND
            bodeneinheit_onlinedata_t.is_wald IS FALSE
                THEN 'Mittelschwere, lehmige bis schluffige Böden: normal bearbeitbar, trocknen mässig schnell ab.'
        WHEN
            koernkl_t_ob.code IN (5, 6, 10, 11, 12)
            AND
            bodeneinheit_onlinedata_t.is_wald IS TRUE
                THEN 'Mittelschwere, lehmige bis schluffige Böden: trocknen mässig schnell ab.'
        WHEN 
            koernkl_t_ob.code IN (1, 2, 3, 4)
            AND
            bodeneinheit_onlinedata_t.is_wald IS FALSE
                THEN 'Leichte, sandige Böden: leicht bearbeitbar, trocknen schnell ab.'
        WHEN 
            koernkl_t_ob.code IN (1, 2, 3, 4)
            AND
            bodeneinheit_onlinedata_t.is_wald IS TRUE
                THEN 'Leichte, sandige Böden: trocknen schnell ab.'
    END AS bodenart_bodenbearbeitbarkeit,
    koernkl_t_ub.code AS koernkl_ub,
    koernkl_t_ub.beschreibung AS koernkl_ub_beschreibung,
    bodeneinheit_auspraegung_t.ton_ob,
    bodeneinheit_auspraegung_t.ton_ub,
    bodeneinheit_auspraegung_t.schluff_ob,
    bodeneinheit_auspraegung_t.schluff_ub,
    bodeneinheit_auspraegung_t.karbgrenze,
    kalkgehalt_t_ob.code AS kalkgeh_ob,
    kalkgehalt_t_ob.beschreibung AS kalkgeh_ob_beschreibung,
    kalkgehalt_t_ub.code AS kalkgeh_ub,
    kalkgehalt_t_ub.beschreibung AS kalkgeh_ub_beschreibung,
    bodeneinheit_auspraegung_t.ph_ob,
    CASE
        WHEN
            bodeneinheit_auspraegung_t.ph_ob > 0
            AND
            bodeneinheit_auspraegung_t.ph_ob <= 4.2
            AND
            bodeneinheit_onlinedata_t.is_wald IS FALSE
                THEN 'stark sauer: starke Nährstoffauswaschung (net.sf.jsqlparser.parser.ParseException: Encountered unexpected token: "spezialisierte" <S_IDENTIFIER>
    at line 1, column 1.

Was expecting one of:

    "("
    "ALTER"
    "ANALYZE"
    "BEGIN"
    "CALL"
    "COMMENT"
    "COMMIT"
    "CREATE"
    "DECLARE"
    "DELETE"
    "DESC"
    "DESCRIBE"
    "DROP"
    "EXEC"
    "EXECUTE"
    "EXPLAIN"
    "FROM"
    "GRANT"
    "IF"
    "INSERT"
    "MERGE"
    "PURGE"
    "REFRESH"
    "RENAME"
    "REPLACE"
    "RESET"
    "ROLLBACK"
    "SAVEPOINT"
    "SET"
    "SHOW"
    "SUMMARIZE"
    "TABLE"
    "TRUNCATE"
    "UPDATE"
    "UPSERT"
    "USE"
    "VALUE"
    "VALUES"
    "WITH"
    <K_SELECT>
)
********************************************************************************
class net.sf.jsqlparser.JSQLParserException
net.sf.jsqlparser.parser.ParseException: Encountered unexpected token: "Kalkung" <S_IDENTIFIER>
    at line 1, column 1.

Was expecting one of:

    "("
    "ALTER"
    "ANALYZE"
    "BEGIN"
    "CALL"
    "COMMENT"
    "COMMIT"
    "CREATE"
    "DECLARE"
    "DELETE"
    "DESC"
    "DESCRIBE"
    "DROP"
    "EXEC"
    "EXECUTE"
    "EXPLAIN"
    "FROM"
    "GRANT"
    "IF"
    "INSERT"
    "MERGE"
    "PURGE"
    "REFRESH"
    "RENAME"
    "REPLACE"
    "RESET"
    "ROLLBACK"
    "SAVEPOINT"
    "SET"
    "SHOW"
    "SUMMARIZE"
    "TABLE"
    "TRUNCATE"
    "UPDATE"
    "UPSERT"
    "USE"
    "VALUE"
    "VALUES"
    "WITH"
    <K_SELECT>

Error parsing: Kalkung erforderlich'
        WHEN
            bodeneinheit_auspraegung_t.ph_ob > 4.2
            AND
            bodeneinheit_auspraegung_t.ph_ob <= 5.0
            AND
            bodeneinheit_onlinedata_t.is_wald IS FALSE
                THEN 'sauer: Nährstoffauswaschung (net.sf.jsqlparser.parser.ParseException: Encountered unexpected token: "Kalkung" <S_IDENTIFIER>
    at line 1, column 1.

Was expecting one of:

    "("
    "ALTER"
    "ANALYZE"
    "BEGIN"
    "CALL"
    "COMMENT"
    "COMMIT"
    "CREATE"
    "DECLARE"
    "DELETE"
    "DESC"
    "DESCRIBE"
    "DROP"
    "EXEC"
    "EXECUTE"
    "EXPLAIN"
    "FROM"
    "GRANT"
    "IF"
    "INSERT"
    "MERGE"
    "PURGE"
    "REFRESH"
    "RENAME"
    "REPLACE"
    "RESET"
    "ROLLBACK"
    "SAVEPOINT"
    "SET"
    "SHOW"
    "SUMMARIZE"
    "TABLE"
    "TRUNCATE"
    "UPDATE"
    "UPSERT"
    "USE"
    "VALUE"
    "VALUES"
    "WITH"
    <K_SELECT>
)
********************************************************************************
class net.sf.jsqlparser.JSQLParserException
net.sf.jsqlparser.parser.ParseException: Encountered unexpected token: "Kalkung" <S_IDENTIFIER>
    at line 1, column 1.

Was expecting one of:

    "("
    "ALTER"
    "ANALYZE"
    "BEGIN"
    "CALL"
    "COMMENT"
    "COMMIT"
    "CREATE"
    "DECLARE"
    "DELETE"
    "DESC"
    "DESCRIBE"
    "DROP"
    "EXEC"
    "EXECUTE"
    "EXPLAIN"
    "FROM"
    "GRANT"
    "IF"
    "INSERT"
    "MERGE"
    "PURGE"
    "REFRESH"
    "RENAME"
    "REPLACE"
    "RESET"
    "ROLLBACK"
    "SAVEPOINT"
    "SET"
    "SHOW"
    "SUMMARIZE"
    "TABLE"
    "TRUNCATE"
    "UPDATE"
    "UPSERT"
    "USE"
    "VALUE"
    "VALUES"
    "WITH"
    <K_SELECT>

Error parsing: Kalkung erforderlich'
        WHEN
            bodeneinheit_auspraegung_t.ph_ob > 5.0
            AND
            bodeneinheit_auspraegung_t.ph_ob <= 6.1
            AND
            bodeneinheit_onlinedata_t.is_wald IS FALSE
                THEN 'schwach sauer: optimale Nährstoffverhältnisse (net.sf.jsqlparser.parser.ParseException: Encountered unexpected token: "Kalkung" <S_IDENTIFIER>
    at line 1, column 1.

Was expecting one of:

    "("
    "ALTER"
    "ANALYZE"
    "BEGIN"
    "CALL"
    "COMMENT"
    "COMMIT"
    "CREATE"
    "DECLARE"
    "DELETE"
    "DESC"
    "DESCRIBE"
    "DROP"
    "EXEC"
    "EXECUTE"
    "EXPLAIN"
    "FROM"
    "GRANT"
    "IF"
    "INSERT"
    "MERGE"
    "PURGE"
    "REFRESH"
    "RENAME"
    "REPLACE"
    "RESET"
    "ROLLBACK"
    "SAVEPOINT"
    "SET"
    "SHOW"
    "SUMMARIZE"
    "TABLE"
    "TRUNCATE"
    "UPDATE"
    "UPSERT"
    "USE"
    "VALUE"
    "VALUES"
    "WITH"
    <K_SELECT>
)
********************************************************************************
class net.sf.jsqlparser.JSQLParserException
net.sf.jsqlparser.parser.ParseException: Encountered unexpected token: "Erhaltungskalkung" <S_IDENTIFIER>
    at line 1, column 1.

Was expecting one of:

    "("
    "ALTER"
    "ANALYZE"
    "BEGIN"
    "CALL"
    "COMMENT"
    "COMMIT"
    "CREATE"
    "DECLARE"
    "DELETE"
    "DESC"
    "DESCRIBE"
    "DROP"
    "EXEC"
    "EXECUTE"
    "EXPLAIN"
    "FROM"
    "GRANT"
    "IF"
    "INSERT"
    "MERGE"
    "PURGE"
    "REFRESH"
    "RENAME"
    "REPLACE"
    "RESET"
    "ROLLBACK"
    "SAVEPOINT"
    "SET"
    "SHOW"
    "SUMMARIZE"
    "TABLE"
    "TRUNCATE"
    "UPDATE"
    "UPSERT"
    "USE"
    "VALUE"
    "VALUES"
    "WITH"
    <K_SELECT>

Error parsing: Erhaltungskalkung empfohlen'
        WHEN
            bodeneinheit_auspraegung_t.ph_ob > 6.1
            AND
            bodeneinheit_auspraegung_t.ph_ob <= 6.7
            AND
            bodeneinheit_onlinedata_t.is_wald IS FALSE
                THEN 'neutral: optimale Nährstoffverhältnisse (net.sf.jsqlparser.parser.ParseException: Encountered unexpected token: "Erhaltungskalkung" <S_IDENTIFIER>
    at line 1, column 1.

Was expecting one of:

    "("
    "ALTER"
    "ANALYZE"
    "BEGIN"
    "CALL"
    "COMMENT"
    "COMMIT"
    "CREATE"
    "DECLARE"
    "DELETE"
    "DESC"
    "DESCRIBE"
    "DROP"
    "EXEC"
    "EXECUTE"
    "EXPLAIN"
    "FROM"
    "GRANT"
    "IF"
    "INSERT"
    "MERGE"
    "PURGE"
    "REFRESH"
    "RENAME"
    "REPLACE"
    "RESET"
    "ROLLBACK"
    "SAVEPOINT"
    "SET"
    "SHOW"
    "SUMMARIZE"
    "TABLE"
    "TRUNCATE"
    "UPDATE"
    "UPSERT"
    "USE"
    "VALUE"
    "VALUES"
    "WITH"
    <K_SELECT>
)
********************************************************************************
class net.sf.jsqlparser.JSQLParserException
net.sf.jsqlparser.parser.ParseException: Encountered unexpected token: "Erhaltungskalkung" <S_IDENTIFIER>
    at line 1, column 1.

Was expecting one of:

    "("
    "ALTER"
    "ANALYZE"
    "BEGIN"
    "CALL"
    "COMMENT"
    "COMMIT"
    "CREATE"
    "DECLARE"
    "DELETE"
    "DESC"
    "DESCRIBE"
    "DROP"
    "EXEC"
    "EXECUTE"
    "EXPLAIN"
    "FROM"
    "GRANT"
    "IF"
    "INSERT"
    "MERGE"
    "PURGE"
    "REFRESH"
    "RENAME"
    "REPLACE"
    "RESET"
    "ROLLBACK"
    "SAVEPOINT"
    "SET"
    "SHOW"
    "SUMMARIZE"
    "TABLE"
    "TRUNCATE"
    "UPDATE"
    "UPSERT"
    "USE"
    "VALUE"
    "VALUES"
    "WITH"
    <K_SELECT>

Error parsing: Erhaltungskalkung empfohlen'
        WHEN
            bodeneinheit_auspraegung_t.ph_ob > 6.7
            AND
            bodeneinheit_onlinedata_t.is_wald IS FALSE
            THEN 'alkalisch: keine Kalkung'
        WHEN
            bodeneinheit_auspraegung_t.ph_ob > 0
            AND
            bodeneinheit_auspraegung_t.ph_ob <= 3.2
            AND
            bodeneinheit_onlinedata_t.is_wald IS TRUE
                THEN 'sehr stark sauer'
        WHEN
            bodeneinheit_auspraegung_t.ph_ob > 3.2
            AND
            bodeneinheit_auspraegung_t.ph_ob <= 4.2
            AND
            bodeneinheit_onlinedata_t.is_wald IS TRUE
                THEN 'stark sauer'
        WHEN 
            bodeneinheit_auspraegung_t.ph_ob > 4.2
            AND
            bodeneinheit_auspraegung_t.ph_ob <= 5.0
            AND
            bodeneinheit_onlinedata_t.is_wald IS TRUE
                THEN 'sauer'
        WHEN 
            bodeneinheit_auspraegung_t.ph_ob > 5.0
            AND
            bodeneinheit_auspraegung_t.ph_ob <= 6.1
            AND
            bodeneinheit_onlinedata_t.is_wald IS TRUE
                THEN 'schwach sauer'
        WHEN
            bodeneinheit_auspraegung_t.ph_ob > 6.1
            AND
            bodeneinheit_auspraegung_t.ph_ob <= 6.7
            AND
            bodeneinheit_onlinedata_t.is_wald IS TRUE
                THEN 'neutral'
        WHEN
            bodeneinheit_auspraegung_t.ph_ob > 6.7
            AND
            bodeneinheit_onlinedata_t.is_wald IS TRUE
                THEN 'alkalisch'
    END AS ph_ob_text,
    bodeneinheit_auspraegung_t.ph_ub, 
    CASE
        WHEN
            bodeneinheit_auspraegung_t.ph_ub > 0
            AND
            bodeneinheit_auspraegung_t.ph_ub < 3.3
            AND
            bodeneinheit_onlinedata_t.is_wald IS FALSE
                THEN 'sehr stark sauer'
        WHEN
            bodeneinheit_auspraegung_t.ph_ub >= 3.3
            AND
            bodeneinheit_auspraegung_t.ph_ub < 4.3
            AND
            bodeneinheit_onlinedata_t.is_wald IS FALSE
                THEN 'stark sauer'
        WHEN
            bodeneinheit_auspraegung_t.ph_ub >= 4.3
            AND
            bodeneinheit_auspraegung_t.ph_ub < 5.1
            AND
            bodeneinheit_onlinedata_t.is_wald IS FALSE
                THEN 'sauer'
        WHEN
            bodeneinheit_auspraegung_t.ph_ub >= 5.1
            AND
            bodeneinheit_auspraegung_t.ph_ub < 6.2
            AND
            bodeneinheit_onlinedata_t.is_wald IS FALSE
                THEN 'schwach sauer'
        WHEN
            bodeneinheit_auspraegung_t.ph_ub >= 6.2
            AND
            bodeneinheit_auspraegung_t.ph_ub < 6.8
            AND
            bodeneinheit_onlinedata_t.is_wald IS FALSE
                THEN 'neutral'
        WHEN
            bodeneinheit_auspraegung_t.ph_ub >= 6.8
            AND
            bodeneinheit_onlinedata_t.is_wald IS FALSE
                THEN 'alkalisch'
        WHEN
            bodeneinheit_auspraegung_t.ph_ub > 0
            AND
            bodeneinheit_auspraegung_t.ph_ub <= 3.2
            AND
            bodeneinheit_onlinedata_t.is_wald IS TRUE
                THEN 'sehr stark sauer'
        WHEN
            bodeneinheit_auspraegung_t.ph_ub > 3.2
            AND
            bodeneinheit_auspraegung_t.ph_ub <= 4.2
            AND
            bodeneinheit_onlinedata_t.is_wald IS TRUE
                THEN 'stark sauer'
        WHEN
            bodeneinheit_auspraegung_t.ph_ub > 4.2
            AND
            bodeneinheit_auspraegung_t.ph_ub <= 5.0
            AND
            bodeneinheit_onlinedata_t.is_wald IS TRUE
                THEN 'sauer'
        WHEN
            bodeneinheit_auspraegung_t.ph_ub > 5.0
            AND
            bodeneinheit_auspraegung_t.ph_ub <= 6.1
            AND
            bodeneinheit_onlinedata_t.is_wald IS TRUE
                THEN 'schwach sauer'
        WHEN
            bodeneinheit_auspraegung_t.ph_ub > 6.1
            AND
            bodeneinheit_auspraegung_t.ph_ub <= 6.7
            AND
            bodeneinheit_onlinedata_t.is_wald IS TRUE
                THEN 'neutral'
        WHEN
            bodeneinheit_auspraegung_t.ph_ub > 6.7
            AND
            bodeneinheit_onlinedata_t.is_wald IS TRUE
                THEN 'alkalisch'
    END AS ph_ub_text,
    bodeneinheit_auspraegung_t.maechtigk_ah,
    bodeneinheit_auspraegung_t.humusgeh_ah,
    CASE
        WHEN
            bodeneinheit_auspraegung_t.humusgeh_ah > 0
            AND
            bodeneinheit_auspraegung_t.humusgeh_ah < 2
                THEN '< 2.0%: humusarm'
        WHEN
            bodeneinheit_auspraegung_t.humusgeh_ah >= 2
            AND
            bodeneinheit_auspraegung_t.humusgeh_ah < 3
            AND
            bodeneinheit_onlinedata_t.is_wald IS FALSE
                THEN '2.0 - 2.9%: schwach humos'
        WHEN
            bodeneinheit_auspraegung_t.humusgeh_ah >= 3
            AND
            bodeneinheit_auspraegung_t.humusgeh_ah < 4
            AND
            bodeneinheit_onlinedata_t.is_wald IS FALSE
                THEN '3.0 - 3.9%: mässig humos'
        WHEN
            bodeneinheit_auspraegung_t.humusgeh_ah >= 4
            AND
            bodeneinheit_auspraegung_t.humusgeh_ah < 5
            AND
            bodeneinheit_onlinedata_t.is_wald IS FALSE
                THEN '4.0 - 4.9%: mittel humos'
        WHEN
            bodeneinheit_auspraegung_t.humusgeh_ah >= 5
            AND
            bodeneinheit_auspraegung_t.humusgeh_ah < 10
            AND
            bodeneinheit_onlinedata_t.is_wald IS FALSE
                THEN '5.0 - 9.9%: humos'
        WHEN
            bodeneinheit_auspraegung_t.humusgeh_ah >= 10
            AND
            bodeneinheit_onlinedata_t.is_wald IS FALSE
            THEN '>= 10.0%: humusreich bis organisch'
        WHEN
            bodeneinheit_auspraegung_t.humusgeh_ah >= 2
            AND
            bodeneinheit_auspraegung_t.humusgeh_ah < 5
            AND
            bodeneinheit_onlinedata_t.is_wald IS TRUE
                THEN '2.0 - 4.9%: schwach humos'
        WHEN 
            bodeneinheit_auspraegung_t.humusgeh_ah >= 5
            AND
            bodeneinheit_auspraegung_t.humusgeh_ah < 10
            AND
            bodeneinheit_onlinedata_t.is_wald IS TRUE
                THEN '5.0 - 9.9%: humos'
        WHEN
            bodeneinheit_auspraegung_t.humusgeh_ah >= 10
            AND
            bodeneinheit_auspraegung_t.humusgeh_ah < 20
            AND
            bodeneinheit_onlinedata_t.is_wald IS TRUE
                THEN '10.0 - 19.9%: humusreich'
        WHEN
            bodeneinheit_auspraegung_t.humusgeh_ah >= 20
            AND
            bodeneinheit_auspraegung_t.humusgeh_ah < 30
            AND
            bodeneinheit_onlinedata_t.is_wald IS TRUE
                THEN '20.0 - 29.9%: sehr humusreich'
        WHEN
            bodeneinheit_auspraegung_t.humusgeh_ah >= 30
            AND
            bodeneinheit_onlinedata_t.is_wald IS TRUE
                THEN '>= 30.0%: organisch'
    END AS humusgeh_ah_text,
    humusform_wa_t.code AS humusform_wa,
    humusform_wa_t.beschreibung AS humusform_wa_beschreibung,
    CASE
        WHEN humusform_wa_t.code IN ('M', 'Mt', 'Mf')
            THEN 'Mull: Hohe biologische Aktivität mit vollständigem Streuabbau nach 1-2 Jahren. Über 8 cm mächtiger, gut strukturierter Oberboden. Günstiger Wasser-, Luft- und Nährstoffhaushalt.'
        WHEN humusform_wa_t.code IN ('Fm', 'Fa', 'Fr', 'Fl')
            THEN 'Moder: Wegen Säuregrad reduzierte biologische Aktivität. Verlangsamter, unvollständiger Streuabbau, daher organische Auflage. 4-8 cm mächtiger Oberboden. Saure, nährstoffarme Böden in krautarmen Laub- und Nadelwäldern.'
        WHEN humusform_wa_t.code IN ('L', 'La', 'Lr')
            THEN 'Rohhumus: Geringe biologische Aktivität. Gehemmter Streuabbau mit ausgeprägten Auflagehorizonten und geringmächtigem Oberboden. Stark saure, nährstoffarme Böden mit schwer abbaubarer Streu (Nadelwälder).'
        WHEN humusform_wa_t.code IN ('MHt', 'MHf')
            THEN 'Feuchtmull: Hohe biologische Aktivität mit vollständigem Streuabbau nach 1-2 Jahren. Über 8 cm mächtiger, gut strukturierter Oberboden. Trotz schwach vernässtem Boden günstiger Wasser-, Luft- und Nährstoffhaushalt.'
        WHEN humusform_wa_t.code IN ('FHm', 'FHa', 'FHr', 'FHl')
            THEN 'Feuchtmoder: Wegen Vernässung reduzierte biologische Aktivität. Verlangsamter, unvollständiger Streuabbau, daher organische Auflage. 4-8 cm mächtiger Oberboden.Vernässte, z.T. saure, nährstoffarme Böden.'
        WHEN humusform_wa_t.code IN ('Lha', 'LHr')
            THEN 'Feuchtrohhumus: Geringe biologische Aktivität. Gehemmter Streuabbau mit ausgeprägten Auflagehorizonten und geringmächtigem Oberboden.Vernässte, stark saure, nährstoffarme Böden mit schwer abbaubarer Streu (Nadelwälder).'
        WHEN humusform_wa_t.code = 'A'
            THEN 'Anmoor: Unvollständiger Streuabbau wegen häufigem Luftmangel. Der dunkle Horizont mit hohem Anteil an organischer Substanz ist strukturarm und schwach sauer bis alkalisch.'
        WHEN humusform_wa_t.code = 'T'
            THEN 'Torf: Anreicherung von kaum zersetzten Pflanzenrückständen, v.a. Torfmoose wegen dauernder Wassersättigung und stark sauren Bedingungen. Faserig, schwammig.'
    END AS humusform_wa_text,
    bodeneinheit_auspraegung_t.maechtigk_ahh,
    gefuegeform_t_ob.code AS gefuegeform_ob,
    gefuegeform_t_ob.beschreibung AS gefuegeform_ob_beschreibung,
    CASE
        WHEN
            gefuegeform_t_ob.code IN ('Kr', 'Sp')
            AND
            gefueggr_t_ob.code = '2'
                THEN 1
        WHEN
            (
                gefuegeform_t_ob.code IN ('Sp', 'Br')
                AND
                gefueggr_t_ob.code IN ('3', '4')
            )
            OR
            (
                gefuegeform_t_ob.code = 'Po'
                AND
                gefueggr_t_ob.code = '2'
            )
                THEN 2
        WHEN
            (
                gefuegeform_t_ob.code = 'Po'
                AND
                gefueggr_t_ob.code IN ('3', '4')
            )
            OR
            (
                gefuegeform_t_ob.code = 'Fr'
                AND
                gefueggr_t_ob.code IN ('2', '3')
            )
            OR
            (
                gefuegeform_t_ob.code = 'Sp'
                AND
                gefueggr_t_ob.code = '5'
            )
            OR
            (
                gefuegeform_t_ob.code = 'Klr'
                AND
                gefueggr_t_ob.code IN ('4', '3', '5')
            )
            OR
            (
                gefuegeform_t_ob.code = 'Br'
                AND
                gefueggr_t_ob.code IN ('2', '5')
            )
                THEN 3
        WHEN
            (
                gefuegeform_t_ob.code IN ('Po', 'Pl')
                AND
                gefueggr_t_ob.code IN ('5', '6')
            )
            OR
            ( 
                gefuegeform_t_ob.code = 'Fr'
                AND
                gefueggr_t_ob.code IN ('4', '5')
            )
            OR
            (
                gefuegeform_t_ob.code = 'Pr'
                AND
                gefueggr_t_ob.code IN ('4', '5', '6')
            )
            OR
            (
                gefuegeform_t_ob.code = 'Klr'
                AND
                gefueggr_t_ob.code IN ('6', '7')
            )
            OR
            (
                gefuegeform_t_ob.code = 'Klk'
                AND
                gefueggr_t_ob.code IN ('3', '4', '5', '6')
            )
                THEN 4
        WHEN
            gefuegeform_t_ob.code = 'Ko'
            OR
            gefuegeform_t_ob.code = 'Ek'
            OR
            (
                gefuegeform_t_ob.code = 'Gr'
                AND
                gefueggr_t_ob.code = '1'
            )
            OR
            (
                gefuegeform_t_ob.code IN ('Po', 'Pr', 'Klk',  'Pl')
                AND
                gefueggr_t_ob.code = '7'
            )
                THEN 5
    END AS gefuegeform_ob_int,
    gefuegeform_t_ub.code AS gefuegeform_ub,
    gefuegeform_t_ub.beschreibung AS gefuegeform_ub_beschreibung,
    gefueggr_t_ob.code AS gefueggr_ob,
    gefueggr_t_ob.beschreibung AS gefueggr_ob_beschreibung,
    gefueggr_t_ub.code AS gefueggr_ub,
    gefueggr_t_ub.beschreibung AS gefueggr_ub_beschreibung,
    bodeneinheit_auspraegung_t.pflngr,
    CASE
        WHEN
            bodeneinheit_auspraegung_t.pflngr = 0
            OR
            bodeneinheit_auspraegung_t.pflngr IS NULL
                THEN
                    CASE
                        WHEN
                            bodeneinheit_auspraegung_t.bodpktzahl > 0
                            AND
                            bodeneinheit_auspraegung_t.bodpktzahl <= 49
                                THEN 1
                        WHEN
                            bodeneinheit_auspraegung_t.bodpktzahl >= 50
                            AND
                            bodeneinheit_auspraegung_t.bodpktzahl <= 69
                                THEN 2
                        WHEN
                            bodeneinheit_auspraegung_t.bodpktzahl >= 70
                            AND
                            bodeneinheit_auspraegung_t.bodpktzahl <= 79
                                THEN 3
                        WHEN bodeneinheit_auspraegung_t.bodpktzahl >= 80
                            THEN 4
                        ELSE NULL::integer
                    END
        WHEN bodeneinheit_auspraegung_t.pflngr > 0
            THEN
                CASE
                    WHEN
                        bodeneinheit_auspraegung_t.pflngr > 0
                        AND
                        bodeneinheit_auspraegung_t.pflngr <= 29
                            THEN 1
                    WHEN
                        bodeneinheit_auspraegung_t.pflngr >= 30
                        AND
                        bodeneinheit_auspraegung_t.pflngr <= 49
                            THEN 2
                    WHEN
                        bodeneinheit_auspraegung_t.pflngr >= 50
                        AND
                        bodeneinheit_auspraegung_t.pflngr <= 69
                            THEN 3
                    WHEN bodeneinheit_auspraegung_t.pflngr >= 70
                        THEN 4
                    ELSE NULL::integer
                END
        ELSE NULL::integer
    END AS pflngr_qgis_int,
    CASE
        WHEN
            bodeneinheit_auspraegung_t.pflngr = 0
            OR
            bodeneinheit_auspraegung_t.pflngr IS NULL
                THEN
                    CASE
                        WHEN
                            bodeneinheit_auspraegung_t.bodpktzahl > 0
                            AND
                            bodeneinheit_auspraegung_t.bodpktzahl <= 49
                                THEN 'Geringe Durchwurzelungstiefe (net.sf.jsqlparser.parser.ParseException: Encountered unexpected token: "Erhaltungskalkung" <S_IDENTIFIER>
    at line 1, column 1.

Was expecting one of:

    "("
    "ALTER"
    "ANALYZE"
    "BEGIN"
    "CALL"
    "COMMENT"
    "COMMIT"
    "CREATE"
    "DECLARE"
    "DELETE"
    "DESC"
    "DESCRIBE"
    "DROP"
    "EXEC"
    "EXECUTE"
    "EXPLAIN"
    "FROM"
    "GRANT"
    "IF"
    "INSERT"
    "MERGE"
    "PURGE"
    "REFRESH"
    "RENAME"
    "REPLACE"
    "RESET"
    "ROLLBACK"
    "SAVEPOINT"
    "SET"
    "SHOW"
    "SUMMARIZE"
    "TABLE"
    "TRUNCATE"
    "UPDATE"
    "UPSERT"
    "USE"
    "VALUE"
    "VALUES"
    "WITH"
    <K_SELECT>
)
********************************************************************************
class net.sf.jsqlparser.JSQLParserException
net.sf.jsqlparser.parser.ParseException: Encountered unexpected token: "schlechtes" <S_IDENTIFIER>
    at line 1, column 1.

Was expecting one of:

    "("
    "ALTER"
    "ANALYZE"
    "BEGIN"
    "CALL"
    "COMMENT"
    "COMMIT"
    "CREATE"
    "DECLARE"
    "DELETE"
    "DESC"
    "DESCRIBE"
    "DROP"
    "EXEC"
    "EXECUTE"
    "EXPLAIN"
    "FROM"
    "GRANT"
    "IF"
    "INSERT"
    "MERGE"
    "PURGE"
    "REFRESH"
    "RENAME"
    "REPLACE"
    "RESET"
    "ROLLBACK"
    "SAVEPOINT"
    "SET"
    "SHOW"
    "SUMMARIZE"
    "TABLE"
    "TRUNCATE"
    "UPDATE"
    "UPSERT"
    "USE"
    "VALUE"
    "VALUES"
    "WITH"
    <K_SELECT>

Error parsing: schlechtes Speichervermögen für Nährstoffe und Wasser'
                        WHEN
                            bodeneinheit_auspraegung_t.bodpktzahl >= 50
                            AND
                            bodeneinheit_auspraegung_t.bodpktzahl <= 69
                                THEN 'Mässige Durchwurzelungstiefe (net.sf.jsqlparser.parser.ParseException: Encountered unexpected token: "schlechtes" <S_IDENTIFIER>
    at line 1, column 1.

Was expecting one of:

    "("
    "ALTER"
    "ANALYZE"
    "BEGIN"
    "CALL"
    "COMMENT"
    "COMMIT"
    "CREATE"
    "DECLARE"
    "DELETE"
    "DESC"
    "DESCRIBE"
    "DROP"
    "EXEC"
    "EXECUTE"
    "EXPLAIN"
    "FROM"
    "GRANT"
    "IF"
    "INSERT"
    "MERGE"
    "PURGE"
    "REFRESH"
    "RENAME"
    "REPLACE"
    "RESET"
    "ROLLBACK"
    "SAVEPOINT"
    "SET"
    "SHOW"
    "SUMMARIZE"
    "TABLE"
    "TRUNCATE"
    "UPDATE"
    "UPSERT"
    "USE"
    "VALUE"
    "VALUES"
    "WITH"
    <K_SELECT>
)
********************************************************************************
class net.sf.jsqlparser.JSQLParserException
net.sf.jsqlparser.parser.ParseException: Encountered unexpected token: "gen\u00fcgendes" <S_IDENTIFIER>
    at line 1, column 1.

Was expecting one of:

    "("
    "ALTER"
    "ANALYZE"
    "BEGIN"
    "CALL"
    "COMMENT"
    "COMMIT"
    "CREATE"
    "DECLARE"
    "DELETE"
    "DESC"
    "DESCRIBE"
    "DROP"
    "EXEC"
    "EXECUTE"
    "EXPLAIN"
    "FROM"
    "GRANT"
    "IF"
    "INSERT"
    "MERGE"
    "PURGE"
    "REFRESH"
    "RENAME"
    "REPLACE"
    "RESET"
    "ROLLBACK"
    "SAVEPOINT"
    "SET"
    "SHOW"
    "SUMMARIZE"
    "TABLE"
    "TRUNCATE"
    "UPDATE"
    "UPSERT"
    "USE"
    "VALUE"
    "VALUES"
    "WITH"
    <K_SELECT>

Error parsing: genügendes Speichervermögen für Nährstoffe und Wasser'
                        WHEN
                            bodeneinheit_auspraegung_t.bodpktzahl >= 70
                            AND
                            bodeneinheit_auspraegung_t.bodpktzahl <= 79
                                THEN 'Grosse Durchwurzelungstiefe (net.sf.jsqlparser.parser.ParseException: Encountered unexpected token: "gen\u00fcgendes" <S_IDENTIFIER>
    at line 1, column 1.

Was expecting one of:

    "("
    "ALTER"
    "ANALYZE"
    "BEGIN"
    "CALL"
    "COMMENT"
    "COMMIT"
    "CREATE"
    "DECLARE"
    "DELETE"
    "DESC"
    "DESCRIBE"
    "DROP"
    "EXEC"
    "EXECUTE"
    "EXPLAIN"
    "FROM"
    "GRANT"
    "IF"
    "INSERT"
    "MERGE"
    "PURGE"
    "REFRESH"
    "RENAME"
    "REPLACE"
    "RESET"
    "ROLLBACK"
    "SAVEPOINT"
    "SET"
    "SHOW"
    "SUMMARIZE"
    "TABLE"
    "TRUNCATE"
    "UPDATE"
    "UPSERT"
    "USE"
    "VALUE"
    "VALUES"
    "WITH"
    <K_SELECT>
)
********************************************************************************
class net.sf.jsqlparser.JSQLParserException
net.sf.jsqlparser.parser.ParseException: Encountered unexpected token: "gutes" <S_IDENTIFIER>
    at line 1, column 1.

Was expecting one of:

    "("
    "ALTER"
    "ANALYZE"
    "BEGIN"
    "CALL"
    "COMMENT"
    "COMMIT"
    "CREATE"
    "DECLARE"
    "DELETE"
    "DESC"
    "DESCRIBE"
    "DROP"
    "EXEC"
    "EXECUTE"
    "EXPLAIN"
    "FROM"
    "GRANT"
    "IF"
    "INSERT"
    "MERGE"
    "PURGE"
    "REFRESH"
    "RENAME"
    "REPLACE"
    "RESET"
    "ROLLBACK"
    "SAVEPOINT"
    "SET"
    "SHOW"
    "SUMMARIZE"
    "TABLE"
    "TRUNCATE"
    "UPDATE"
    "UPSERT"
    "USE"
    "VALUE"
    "VALUES"
    "WITH"
    <K_SELECT>

Error parsing: gutes Speichervermögen für Nährstoffe und Wasser'
                        WHEN bodeneinheit_auspraegung_t.bodpktzahl >= 80
                            THEN 'Sehr grosse Durchwurzelungstiefe (net.sf.jsqlparser.parser.ParseException: Encountered unexpected token: "gutes" <S_IDENTIFIER>
    at line 1, column 1.

Was expecting one of:

    "("
    "ALTER"
    "ANALYZE"
    "BEGIN"
    "CALL"
    "COMMENT"
    "COMMIT"
    "CREATE"
    "DECLARE"
    "DELETE"
    "DESC"
    "DESCRIBE"
    "DROP"
    "EXEC"
    "EXECUTE"
    "EXPLAIN"
    "FROM"
    "GRANT"
    "IF"
    "INSERT"
    "MERGE"
    "PURGE"
    "REFRESH"
    "RENAME"
    "REPLACE"
    "RESET"
    "ROLLBACK"
    "SAVEPOINT"
    "SET"
    "SHOW"
    "SUMMARIZE"
    "TABLE"
    "TRUNCATE"
    "UPDATE"
    "UPSERT"
    "USE"
    "VALUE"
    "VALUES"
    "WITH"
    <K_SELECT>
)
********************************************************************************
class net.sf.jsqlparser.JSQLParserException
net.sf.jsqlparser.parser.ParseException: Encountered unexpected token: "sehr" <S_IDENTIFIER>
    at line 1, column 1.

Was expecting one of:

    "("
    "ALTER"
    "ANALYZE"
    "BEGIN"
    "CALL"
    "COMMENT"
    "COMMIT"
    "CREATE"
    "DECLARE"
    "DELETE"
    "DESC"
    "DESCRIBE"
    "DROP"
    "EXEC"
    "EXECUTE"
    "EXPLAIN"
    "FROM"
    "GRANT"
    "IF"
    "INSERT"
    "MERGE"
    "PURGE"
    "REFRESH"
    "RENAME"
    "REPLACE"
    "RESET"
    "ROLLBACK"
    "SAVEPOINT"
    "SET"
    "SHOW"
    "SUMMARIZE"
    "TABLE"
    "TRUNCATE"
    "UPDATE"
    "UPSERT"
    "USE"
    "VALUE"
    "VALUES"
    "WITH"
    <K_SELECT>

Error parsing: sehr gutes Speichervermögen für Nährstoffe und Wasser'
                    END
        WHEN bodeneinheit_auspraegung_t.pflngr > 0
            THEN
                CASE
                    WHEN
                        bodeneinheit_auspraegung_t.pflngr > 0
                        AND
                        bodeneinheit_auspraegung_t.pflngr <= 29
                            THEN 'Geringe Durchwurzelungstiefe (net.sf.jsqlparser.parser.ParseException: Encountered unexpected token: "sehr" <S_IDENTIFIER>
    at line 1, column 1.

Was expecting one of:

    "("
    "ALTER"
    "ANALYZE"
    "BEGIN"
    "CALL"
    "COMMENT"
    "COMMIT"
    "CREATE"
    "DECLARE"
    "DELETE"
    "DESC"
    "DESCRIBE"
    "DROP"
    "EXEC"
    "EXECUTE"
    "EXPLAIN"
    "FROM"
    "GRANT"
    "IF"
    "INSERT"
    "MERGE"
    "PURGE"
    "REFRESH"
    "RENAME"
    "REPLACE"
    "RESET"
    "ROLLBACK"
    "SAVEPOINT"
    "SET"
    "SHOW"
    "SUMMARIZE"
    "TABLE"
    "TRUNCATE"
    "UPDATE"
    "UPSERT"
    "USE"
    "VALUE"
    "VALUES"
    "WITH"
    <K_SELECT>
)
********************************************************************************
class net.sf.jsqlparser.JSQLParserException
net.sf.jsqlparser.parser.ParseException: Encountered unexpected token: "schlechtes" <S_IDENTIFIER>
    at line 1, column 1.

Was expecting one of:

    "("
    "ALTER"
    "ANALYZE"
    "BEGIN"
    "CALL"
    "COMMENT"
    "COMMIT"
    "CREATE"
    "DECLARE"
    "DELETE"
    "DESC"
    "DESCRIBE"
    "DROP"
    "EXEC"
    "EXECUTE"
    "EXPLAIN"
    "FROM"
    "GRANT"
    "IF"
    "INSERT"
    "MERGE"
    "PURGE"
    "REFRESH"
    "RENAME"
    "REPLACE"
    "RESET"
    "ROLLBACK"
    "SAVEPOINT"
    "SET"
    "SHOW"
    "SUMMARIZE"
    "TABLE"
    "TRUNCATE"
    "UPDATE"
    "UPSERT"
    "USE"
    "VALUE"
    "VALUES"
    "WITH"
    <K_SELECT>

Error parsing: schlechtes Speichervermögen für Nährstoffe und Wasser'
                    WHEN
                        bodeneinheit_auspraegung_t.pflngr >= 30
                        AND
                        bodeneinheit_auspraegung_t.pflngr <= 49
                            THEN 'Mässige Durchwurzelungstiefe (net.sf.jsqlparser.parser.ParseException: Encountered unexpected token: "schlechtes" <S_IDENTIFIER>
    at line 1, column 1.

Was expecting one of:

    "("
    "ALTER"
    "ANALYZE"
    "BEGIN"
    "CALL"
    "COMMENT"
    "COMMIT"
    "CREATE"
    "DECLARE"
    "DELETE"
    "DESC"
    "DESCRIBE"
    "DROP"
    "EXEC"
    "EXECUTE"
    "EXPLAIN"
    "FROM"
    "GRANT"
    "IF"
    "INSERT"
    "MERGE"
    "PURGE"
    "REFRESH"
    "RENAME"
    "REPLACE"
    "RESET"
    "ROLLBACK"
    "SAVEPOINT"
    "SET"
    "SHOW"
    "SUMMARIZE"
    "TABLE"
    "TRUNCATE"
    "UPDATE"
    "UPSERT"
    "USE"
    "VALUE"
    "VALUES"
    "WITH"
    <K_SELECT>
)
********************************************************************************
class net.sf.jsqlparser.JSQLParserException
net.sf.jsqlparser.parser.ParseException: Encountered unexpected token: "gen\u00fcgendes" <S_IDENTIFIER>
    at line 1, column 1.

Was expecting one of:

    "("
    "ALTER"
    "ANALYZE"
    "BEGIN"
    "CALL"
    "COMMENT"
    "COMMIT"
    "CREATE"
    "DECLARE"
    "DELETE"
    "DESC"
    "DESCRIBE"
    "DROP"
    "EXEC"
    "EXECUTE"
    "EXPLAIN"
    "FROM"
    "GRANT"
    "IF"
    "INSERT"
    "MERGE"
    "PURGE"
    "REFRESH"
    "RENAME"
    "REPLACE"
    "RESET"
    "ROLLBACK"
    "SAVEPOINT"
    "SET"
    "SHOW"
    "SUMMARIZE"
    "TABLE"
    "TRUNCATE"
    "UPDATE"
    "UPSERT"
    "USE"
    "VALUE"
    "VALUES"
    "WITH"
    <K_SELECT>

Error parsing: genügendes Speichervermögen für Nährstoffe und Wasser'
                    WHEN
                        bodeneinheit_auspraegung_t.pflngr >= 50
                        AND
                        bodeneinheit_auspraegung_t.pflngr <= 69
                            THEN 'Grosse Durchwurzelungstiefe (net.sf.jsqlparser.parser.ParseException: Encountered unexpected token: "gen\u00fcgendes" <S_IDENTIFIER>
    at line 1, column 1.

Was expecting one of:

    "("
    "ALTER"
    "ANALYZE"
    "BEGIN"
    "CALL"
    "COMMENT"
    "COMMIT"
    "CREATE"
    "DECLARE"
    "DELETE"
    "DESC"
    "DESCRIBE"
    "DROP"
    "EXEC"
    "EXECUTE"
    "EXPLAIN"
    "FROM"
    "GRANT"
    "IF"
    "INSERT"
    "MERGE"
    "PURGE"
    "REFRESH"
    "RENAME"
    "REPLACE"
    "RESET"
    "ROLLBACK"
    "SAVEPOINT"
    "SET"
    "SHOW"
    "SUMMARIZE"
    "TABLE"
    "TRUNCATE"
    "UPDATE"
    "UPSERT"
    "USE"
    "VALUE"
    "VALUES"
    "WITH"
    <K_SELECT>
)
********************************************************************************
class net.sf.jsqlparser.JSQLParserException
net.sf.jsqlparser.parser.ParseException: Encountered unexpected token: "gutes" <S_IDENTIFIER>
    at line 1, column 1.

Was expecting one of:

    "("
    "ALTER"
    "ANALYZE"
    "BEGIN"
    "CALL"
    "COMMENT"
    "COMMIT"
    "CREATE"
    "DECLARE"
    "DELETE"
    "DESC"
    "DESCRIBE"
    "DROP"
    "EXEC"
    "EXECUTE"
    "EXPLAIN"
    "FROM"
    "GRANT"
    "IF"
    "INSERT"
    "MERGE"
    "PURGE"
    "REFRESH"
    "RENAME"
    "REPLACE"
    "RESET"
    "ROLLBACK"
    "SAVEPOINT"
    "SET"
    "SHOW"
    "SUMMARIZE"
    "TABLE"
    "TRUNCATE"
    "UPDATE"
    "UPSERT"
    "USE"
    "VALUE"
    "VALUES"
    "WITH"
    <K_SELECT>

Error parsing: gutes Speichervermögen für Nährstoffe und Wasser'
                    WHEN bodeneinheit_auspraegung_t.pflngr >= 70
                        THEN 'Sehr grosse Durchwurzelungstiefe (net.sf.jsqlparser.parser.ParseException: Encountered unexpected token: "gutes" <S_IDENTIFIER>
    at line 1, column 1.

Was expecting one of:

    "("
    "ALTER"
    "ANALYZE"
    "BEGIN"
    "CALL"
    "COMMENT"
    "COMMIT"
    "CREATE"
    "DECLARE"
    "DELETE"
    "DESC"
    "DESCRIBE"
    "DROP"
    "EXEC"
    "EXECUTE"
    "EXPLAIN"
    "FROM"
    "GRANT"
    "IF"
    "INSERT"
    "MERGE"
    "PURGE"
    "REFRESH"
    "RENAME"
    "REPLACE"
    "RESET"
    "ROLLBACK"
    "SAVEPOINT"
    "SET"
    "SHOW"
    "SUMMARIZE"
    "TABLE"
    "TRUNCATE"
    "UPDATE"
    "UPSERT"
    "USE"
    "VALUE"
    "VALUES"
    "WITH"
    <K_SELECT>
)
********************************************************************************
class net.sf.jsqlparser.JSQLParserException
net.sf.jsqlparser.parser.ParseException: Encountered unexpected token: "sehr" <S_IDENTIFIER>
    at line 1, column 1.

Was expecting one of:

    "("
    "ALTER"
    "ANALYZE"
    "BEGIN"
    "CALL"
    "COMMENT"
    "COMMIT"
    "CREATE"
    "DECLARE"
    "DELETE"
    "DESC"
    "DESCRIBE"
    "DROP"
    "EXEC"
    "EXECUTE"
    "EXPLAIN"
    "FROM"
    "GRANT"
    "IF"
    "INSERT"
    "MERGE"
    "PURGE"
    "REFRESH"
    "RENAME"
    "REPLACE"
    "RESET"
    "ROLLBACK"
    "SAVEPOINT"
    "SET"
    "SHOW"
    "SUMMARIZE"
    "TABLE"
    "TRUNCATE"
    "UPDATE"
    "UPSERT"
    "USE"
    "VALUE"
    "VALUES"
    "WITH"
    <K_SELECT>

Error parsing: sehr gutes Speichervermögen für Nährstoffe und Wasser'
                END
    END AS pflngr_text,
    bodeneinheit_auspraegung_t.bodpktzahl,
    CASE
        WHEN bodeneinheit_auspraegung_t.bodpktzahl >= 90
            THEN 'Beste Bodeneigenschaften (net.sf.jsqlparser.parser.ParseException: Encountered unexpected token: "sehr" <S_IDENTIFIER>
    at line 1, column 1.

Was expecting one of:

    "("
    "ALTER"
    "ANALYZE"
    "BEGIN"
    "CALL"
    "COMMENT"
    "COMMIT"
    "CREATE"
    "DECLARE"
    "DELETE"
    "DESC"
    "DESCRIBE"
    "DROP"
    "EXEC"
    "EXECUTE"
    "EXPLAIN"
    "FROM"
    "GRANT"
    "IF"
    "INSERT"
    "MERGE"
    "PURGE"
    "REFRESH"
    "RENAME"
    "REPLACE"
    "RESET"
    "ROLLBACK"
    "SAVEPOINT"
    "SET"
    "SHOW"
    "SUMMARIZE"
    "TABLE"
    "TRUNCATE"
    "UPDATE"
    "UPSERT"
    "USE"
    "VALUE"
    "VALUES"
    "WITH"
    <K_SELECT>
)
********************************************************************************
class net.sf.jsqlparser.JSQLParserException
net.sf.jsqlparser.parser.ParseException: Encountered unexpected token: "Fruchtfolge" <S_IDENTIFIER>
    at line 1, column 1.

Was expecting one of:

    "("
    "ALTER"
    "ANALYZE"
    "BEGIN"
    "CALL"
    "COMMENT"
    "COMMIT"
    "CREATE"
    "DECLARE"
    "DELETE"
    "DESC"
    "DESCRIBE"
    "DROP"
    "EXEC"
    "EXECUTE"
    "EXPLAIN"
    "FROM"
    "GRANT"
    "IF"
    "INSERT"
    "MERGE"
    "PURGE"
    "REFRESH"
    "RENAME"
    "REPLACE"
    "RESET"
    "ROLLBACK"
    "SAVEPOINT"
    "SET"
    "SHOW"
    "SUMMARIZE"
    "TABLE"
    "TRUNCATE"
    "UPDATE"
    "UPSERT"
    "USE"
    "VALUE"
    "VALUES"
    "WITH"
    <K_SELECT>

Error parsing: Fruchtfolge ohne Einschränkungen'
        WHEN
            bodeneinheit_auspraegung_t.bodpktzahl >= 80
            AND
            bodeneinheit_auspraegung_t.bodpktzahl < 90
                THEN 'Sehr gute Fruchtfolgeböden (net.sf.jsqlparser.parser.ParseException: Encountered unexpected token: "Fruchtfolge" <S_IDENTIFIER>
    at line 1, column 1.

Was expecting one of:

    "("
    "ALTER"
    "ANALYZE"
    "BEGIN"
    "CALL"
    "COMMENT"
    "COMMIT"
    "CREATE"
    "DECLARE"
    "DELETE"
    "DESC"
    "DESCRIBE"
    "DROP"
    "EXEC"
    "EXECUTE"
    "EXPLAIN"
    "FROM"
    "GRANT"
    "IF"
    "INSERT"
    "MERGE"
    "PURGE"
    "REFRESH"
    "RENAME"
    "REPLACE"
    "RESET"
    "ROLLBACK"
    "SAVEPOINT"
    "SET"
    "SHOW"
    "SUMMARIZE"
    "TABLE"
    "TRUNCATE"
    "UPDATE"
    "UPSERT"
    "USE"
    "VALUE"
    "VALUES"
    "WITH"
    <K_SELECT>
)
********************************************************************************
class net.sf.jsqlparser.JSQLParserException
net.sf.jsqlparser.parser.ParseException: Encountered unexpected token: "Hackfruchtanbau" <S_IDENTIFIER>
    at line 1, column 1.

Was expecting one of:

    "("
    "ALTER"
    "ANALYZE"
    "BEGIN"
    "CALL"
    "COMMENT"
    "COMMIT"
    "CREATE"
    "DECLARE"
    "DELETE"
    "DESC"
    "DESCRIBE"
    "DROP"
    "EXEC"
    "EXECUTE"
    "EXPLAIN"
    "FROM"
    "GRANT"
    "IF"
    "INSERT"
    "MERGE"
    "PURGE"
    "REFRESH"
    "RENAME"
    "REPLACE"
    "RESET"
    "ROLLBACK"
    "SAVEPOINT"
    "SET"
    "SHOW"
    "SUMMARIZE"
    "TABLE"
    "TRUNCATE"
    "UPDATE"
    "UPSERT"
    "USE"
    "VALUE"
    "VALUES"
    "WITH"
    <K_SELECT>

Error parsing: Hackfruchtanbau eingeschränkt'
        WHEN
            bodeneinheit_auspraegung_t.bodpktzahl >= 70
            AND
            bodeneinheit_auspraegung_t.bodpktzahl < 80
                THEN 'Gute Fruchtfolgeböden für getreidebetonte Fruchtfolge'
        WHEN
            bodeneinheit_auspraegung_t.bodpktzahl >= 50
            AND
            bodeneinheit_auspraegung_t.bodpktzahl < 70
                THEN 'Gute Futterbauböden (net.sf.jsqlparser.parser.ParseException: Encountered unexpected token: "Hackfruchtanbau" <S_IDENTIFIER>
    at line 1, column 1.

Was expecting one of:

    "("
    "ALTER"
    "ANALYZE"
    "BEGIN"
    "CALL"
    "COMMENT"
    "COMMIT"
    "CREATE"
    "DECLARE"
    "DELETE"
    "DESC"
    "DESCRIBE"
    "DROP"
    "EXEC"
    "EXECUTE"
    "EXPLAIN"
    "FROM"
    "GRANT"
    "IF"
    "INSERT"
    "MERGE"
    "PURGE"
    "REFRESH"
    "RENAME"
    "REPLACE"
    "RESET"
    "ROLLBACK"
    "SAVEPOINT"
    "SET"
    "SHOW"
    "SUMMARIZE"
    "TABLE"
    "TRUNCATE"
    "UPDATE"
    "UPSERT"
    "USE"
    "VALUE"
    "VALUES"
    "WITH"
    <K_SELECT>
)
********************************************************************************
class net.sf.jsqlparser.JSQLParserException
net.sf.jsqlparser.parser.ParseException: Encountered unexpected token: "futterbaubetonte" <S_IDENTIFIER>
    at line 1, column 1.

Was expecting one of:

    "("
    "ALTER"
    "ANALYZE"
    "BEGIN"
    "CALL"
    "COMMENT"
    "COMMIT"
    "CREATE"
    "DECLARE"
    "DELETE"
    "DESC"
    "DESCRIBE"
    "DROP"
    "EXEC"
    "EXECUTE"
    "EXPLAIN"
    "FROM"
    "GRANT"
    "IF"
    "INSERT"
    "MERGE"
    "PURGE"
    "REFRESH"
    "RENAME"
    "REPLACE"
    "RESET"
    "ROLLBACK"
    "SAVEPOINT"
    "SET"
    "SHOW"
    "SUMMARIZE"
    "TABLE"
    "TRUNCATE"
    "UPDATE"
    "UPSERT"
    "USE"
    "VALUE"
    "VALUES"
    "WITH"
    <K_SELECT>

Error parsing: futterbaubetonte Fruchtfolge, Ackerbau stark eingeschränkt'
        WHEN
            bodeneinheit_auspraegung_t.bodpktzahl >= 35
            AND
            bodeneinheit_auspraegung_t.bodpktzahl < 50
                THEN 'Futterbaulich nutzbare Standorte'
        WHEN 
            bodeneinheit_auspraegung_t.bodpktzahl >= 20 
            AND 
            bodeneinheit_auspraegung_t.bodpktzahl < 35 
                THEN 'Extensive Bewirtschaftung angezeigt'
        WHEN
            bodeneinheit_auspraegung_t.bodpktzahl > 0
            AND 
            bodeneinheit_auspraegung_t.bodpktzahl < 20
                THEN 'Für die landwirtschaftliche Nutzung ungeeignet'
        WHEN
            bodeneinheit_auspraegung_t.bodpktzahl = 0
            OR
            bodeneinheit_auspraegung_t.bodpktzahl IS NULL
                THEN 'keine Information'
    END AS bodpktzahl_text,
    bodeneinheit_auspraegung_t.bemerkungen,
    bodeneinheit_onlinedata_t.los,
    bodeneinheit_onlinedata_t.kjahr AS kartierjahr,
    bodeneinheit_t.fk_kartierer AS kartierer,
    bodeneinheit_t.kartierquartal,
    bodeneinheit_onlinedata_t.is_wald,
    bodeneinheit_auspraegung_t.bindst_cd,
    bodeneinheit_auspraegung_t.bindst_zn,
    bodeneinheit_auspraegung_t.bindst_cu,
    bodeneinheit_auspraegung_t.bindst_pb,
    bodeneinheit_auspraegung_t.nfkapwe_ob,
    bodeneinheit_auspraegung_t.nfkapwe_ub,
    bodeneinheit_auspraegung_t.nfkapwe,
    CASE
        WHEN   
            bodeneinheit_auspraegung_t.nfkapwe < 50
            AND
            bodeneinheit_onlinedata_t.is_wald IS FALSE
                THEN '< 50 mm'
        WHEN
            bodeneinheit_auspraegung_t.nfkapwe >= 50
            AND
            bodeneinheit_auspraegung_t.nfkapwe < 100
            AND
            bodeneinheit_onlinedata_t.is_wald IS FALSE
                THEN '50 - 100 mm'
        WHEN
            bodeneinheit_auspraegung_t.nfkapwe >= 100
            AND
            bodeneinheit_auspraegung_t.nfkapwe < 150
            AND
            bodeneinheit_onlinedata_t.is_wald IS FALSE
                THEN '100 - 150 mm'
        WHEN 
            bodeneinheit_auspraegung_t.nfkapwe >= 150
            AND
            bodeneinheit_auspraegung_t.nfkapwe < 200
            AND
            bodeneinheit_onlinedata_t.is_wald IS FALSE
                THEN '150 - 200 mm'
        WHEN
            bodeneinheit_auspraegung_t.nfkapwe >= 200
            AND
            bodeneinheit_auspraegung_t.nfkapwe < 250
            AND
            bodeneinheit_onlinedata_t.is_wald IS FALSE
                THEN '200 - 250 mm'
        WHEN
            bodeneinheit_auspraegung_t.nfkapwe >= 250
            AND
            bodeneinheit_onlinedata_t.is_wald IS FALSE
                THEN '>= 250 mm'
        WHEN
            bodeneinheit_auspraegung_t.nfkapwe < 50
            AND
            bodeneinheit_onlinedata_t.is_wald IS TRUE
                THEN '< 50 mm (net.sf.jsqlparser.parser.ParseException: Encountered unexpected token: "futterbaubetonte" <S_IDENTIFIER>
    at line 1, column 1.

Was expecting one of:

    "("
    "ALTER"
    "ANALYZE"
    "BEGIN"
    "CALL"
    "COMMENT"
    "COMMIT"
    "CREATE"
    "DECLARE"
    "DELETE"
    "DESC"
    "DESCRIBE"
    "DROP"
    "EXEC"
    "EXECUTE"
    "EXPLAIN"
    "FROM"
    "GRANT"
    "IF"
    "INSERT"
    "MERGE"
    "PURGE"
    "REFRESH"
    "RENAME"
    "REPLACE"
    "RESET"
    "ROLLBACK"
    "SAVEPOINT"
    "SET"
    "SHOW"
    "SUMMARIZE"
    "TABLE"
    "TRUNCATE"
    "UPDATE"
    "UPSERT"
    "USE"
    "VALUE"
    "VALUES"
    "WITH"
    <K_SELECT>
)
********************************************************************************
class net.sf.jsqlparser.JSQLParserException
net.sf.jsqlparser.parser.ParseException: Encountered unexpected token: "sehr" <S_IDENTIFIER>
    at line 1, column 1.

Was expecting one of:

    "("
    "ALTER"
    "ANALYZE"
    "BEGIN"
    "CALL"
    "COMMENT"
    "COMMIT"
    "CREATE"
    "DECLARE"
    "DELETE"
    "DESC"
    "DESCRIBE"
    "DROP"
    "EXEC"
    "EXECUTE"
    "EXPLAIN"
    "FROM"
    "GRANT"
    "IF"
    "INSERT"
    "MERGE"
    "PURGE"
    "REFRESH"
    "RENAME"
    "REPLACE"
    "RESET"
    "ROLLBACK"
    "SAVEPOINT"
    "SET"
    "SHOW"
    "SUMMARIZE"
    "TABLE"
    "TRUNCATE"
    "UPDATE"
    "UPSERT"
    "USE"
    "VALUE"
    "VALUES"
    "WITH"
    <K_SELECT>

Error parsing: sehr grosses Trockenstressrisiko'
        WHEN
            bodeneinheit_auspraegung_t.nfkapwe >= 50
            AND
            bodeneinheit_auspraegung_t.nfkapwe < 100
            AND
            bodeneinheit_onlinedata_t.is_wald IS TRUE
                THEN '50 - 99 mm (net.sf.jsqlparser.parser.ParseException: Encountered unexpected token: "sehr" <S_IDENTIFIER>
    at line 1, column 1.

Was expecting one of:

    "("
    "ALTER"
    "ANALYZE"
    "BEGIN"
    "CALL"
    "COMMENT"
    "COMMIT"
    "CREATE"
    "DECLARE"
    "DELETE"
    "DESC"
    "DESCRIBE"
    "DROP"
    "EXEC"
    "EXECUTE"
    "EXPLAIN"
    "FROM"
    "GRANT"
    "IF"
    "INSERT"
    "MERGE"
    "PURGE"
    "REFRESH"
    "RENAME"
    "REPLACE"
    "RESET"
    "ROLLBACK"
    "SAVEPOINT"
    "SET"
    "SHOW"
    "SUMMARIZE"
    "TABLE"
    "TRUNCATE"
    "UPDATE"
    "UPSERT"
    "USE"
    "VALUE"
    "VALUES"
    "WITH"
    <K_SELECT>
)
********************************************************************************
class net.sf.jsqlparser.JSQLParserException
net.sf.jsqlparser.parser.ParseException: Encountered unexpected token: "sehr" <S_IDENTIFIER>
    at line 1, column 1.

Was expecting one of:

    "("
    "ALTER"
    "ANALYZE"
    "BEGIN"
    "CALL"
    "COMMENT"
    "COMMIT"
    "CREATE"
    "DECLARE"
    "DELETE"
    "DESC"
    "DESCRIBE"
    "DROP"
    "EXEC"
    "EXECUTE"
    "EXPLAIN"
    "FROM"
    "GRANT"
    "IF"
    "INSERT"
    "MERGE"
    "PURGE"
    "REFRESH"
    "RENAME"
    "REPLACE"
    "RESET"
    "ROLLBACK"
    "SAVEPOINT"
    "SET"
    "SHOW"
    "SUMMARIZE"
    "TABLE"
    "TRUNCATE"
    "UPDATE"
    "UPSERT"
    "USE"
    "VALUE"
    "VALUES"
    "WITH"
    <K_SELECT>

Error parsing: sehr grosses Trockenstressrisiko'
        WHEN
            bodeneinheit_auspraegung_t.nfkapwe >= 100
            AND
            bodeneinheit_auspraegung_t.nfkapwe < 150
            AND
            bodeneinheit_onlinedata_t.is_wald IS TRUE
                THEN '100 - 149 mm (net.sf.jsqlparser.parser.ParseException: Encountered unexpected token: "sehr" <S_IDENTIFIER>
    at line 1, column 1.

Was expecting one of:

    "("
    "ALTER"
    "ANALYZE"
    "BEGIN"
    "CALL"
    "COMMENT"
    "COMMIT"
    "CREATE"
    "DECLARE"
    "DELETE"
    "DESC"
    "DESCRIBE"
    "DROP"
    "EXEC"
    "EXECUTE"
    "EXPLAIN"
    "FROM"
    "GRANT"
    "IF"
    "INSERT"
    "MERGE"
    "PURGE"
    "REFRESH"
    "RENAME"
    "REPLACE"
    "RESET"
    "ROLLBACK"
    "SAVEPOINT"
    "SET"
    "SHOW"
    "SUMMARIZE"
    "TABLE"
    "TRUNCATE"
    "UPDATE"
    "UPSERT"
    "USE"
    "VALUE"
    "VALUES"
    "WITH"
    <K_SELECT>
)
********************************************************************************
class net.sf.jsqlparser.JSQLParserException
net.sf.jsqlparser.parser.ParseException: Encountered unexpected token: "grosses" <S_IDENTIFIER>
    at line 1, column 1.

Was expecting one of:

    "("
    "ALTER"
    "ANALYZE"
    "BEGIN"
    "CALL"
    "COMMENT"
    "COMMIT"
    "CREATE"
    "DECLARE"
    "DELETE"
    "DESC"
    "DESCRIBE"
    "DROP"
    "EXEC"
    "EXECUTE"
    "EXPLAIN"
    "FROM"
    "GRANT"
    "IF"
    "INSERT"
    "MERGE"
    "PURGE"
    "REFRESH"
    "RENAME"
    "REPLACE"
    "RESET"
    "ROLLBACK"
    "SAVEPOINT"
    "SET"
    "SHOW"
    "SUMMARIZE"
    "TABLE"
    "TRUNCATE"
    "UPDATE"
    "UPSERT"
    "USE"
    "VALUE"
    "VALUES"
    "WITH"
    <K_SELECT>

Error parsing: grosses Trockenstressrisiko'
        WHEN
            bodeneinheit_auspraegung_t.nfkapwe >= 150
            AND
            bodeneinheit_auspraegung_t.nfkapwe < 200
            AND
            bodeneinheit_onlinedata_t.is_wald IS TRUE
                THEN '150 - 199 mm (net.sf.jsqlparser.parser.ParseException: Encountered unexpected token: "grosses" <S_IDENTIFIER>
    at line 1, column 1.

Was expecting one of:

    "("
    "ALTER"
    "ANALYZE"
    "BEGIN"
    "CALL"
    "COMMENT"
    "COMMIT"
    "CREATE"
    "DECLARE"
    "DELETE"
    "DESC"
    "DESCRIBE"
    "DROP"
    "EXEC"
    "EXECUTE"
    "EXPLAIN"
    "FROM"
    "GRANT"
    "IF"
    "INSERT"
    "MERGE"
    "PURGE"
    "REFRESH"
    "RENAME"
    "REPLACE"
    "RESET"
    "ROLLBACK"
    "SAVEPOINT"
    "SET"
    "SHOW"
    "SUMMARIZE"
    "TABLE"
    "TRUNCATE"
    "UPDATE"
    "UPSERT"
    "USE"
    "VALUE"
    "VALUES"
    "WITH"
    <K_SELECT>
)
********************************************************************************
class net.sf.jsqlparser.JSQLParserException
net.sf.jsqlparser.parser.ParseException: Encountered unexpected token: "m\u00e4ssiges" <S_IDENTIFIER>
    at line 1, column 1.

Was expecting one of:

    "("
    "ALTER"
    "ANALYZE"
    "BEGIN"
    "CALL"
    "COMMENT"
    "COMMIT"
    "CREATE"
    "DECLARE"
    "DELETE"
    "DESC"
    "DESCRIBE"
    "DROP"
    "EXEC"
    "EXECUTE"
    "EXPLAIN"
    "FROM"
    "GRANT"
    "IF"
    "INSERT"
    "MERGE"
    "PURGE"
    "REFRESH"
    "RENAME"
    "REPLACE"
    "RESET"
    "ROLLBACK"
    "SAVEPOINT"
    "SET"
    "SHOW"
    "SUMMARIZE"
    "TABLE"
    "TRUNCATE"
    "UPDATE"
    "UPSERT"
    "USE"
    "VALUE"
    "VALUES"
    "WITH"
    <K_SELECT>

Error parsing: mässiges Trockenstressrisiko'
        WHEN
            bodeneinheit_auspraegung_t.nfkapwe >= 200
            AND
            bodeneinheit_auspraegung_t.nfkapwe < 250
            AND
            bodeneinheit_onlinedata_t.is_wald IS TRUE
                THEN '200 - 249 mm (net.sf.jsqlparser.parser.ParseException: Encountered unexpected token: "m\u00e4ssiges" <S_IDENTIFIER>
    at line 1, column 1.

Was expecting one of:

    "("
    "ALTER"
    "ANALYZE"
    "BEGIN"
    "CALL"
    "COMMENT"
    "COMMIT"
    "CREATE"
    "DECLARE"
    "DELETE"
    "DESC"
    "DESCRIBE"
    "DROP"
    "EXEC"
    "EXECUTE"
    "EXPLAIN"
    "FROM"
    "GRANT"
    "IF"
    "INSERT"
    "MERGE"
    "PURGE"
    "REFRESH"
    "RENAME"
    "REPLACE"
    "RESET"
    "ROLLBACK"
    "SAVEPOINT"
    "SET"
    "SHOW"
    "SUMMARIZE"
    "TABLE"
    "TRUNCATE"
    "UPDATE"
    "UPSERT"
    "USE"
    "VALUE"
    "VALUES"
    "WITH"
    <K_SELECT>
)
********************************************************************************
class net.sf.jsqlparser.JSQLParserException
net.sf.jsqlparser.parser.ParseException: Encountered unexpected token: "kleines" <S_IDENTIFIER>
    at line 1, column 1.

Was expecting one of:

    "("
    "ALTER"
    "ANALYZE"
    "BEGIN"
    "CALL"
    "COMMENT"
    "COMMIT"
    "CREATE"
    "DECLARE"
    "DELETE"
    "DESC"
    "DESCRIBE"
    "DROP"
    "EXEC"
    "EXECUTE"
    "EXPLAIN"
    "FROM"
    "GRANT"
    "IF"
    "INSERT"
    "MERGE"
    "PURGE"
    "REFRESH"
    "RENAME"
    "REPLACE"
    "RESET"
    "ROLLBACK"
    "SAVEPOINT"
    "SET"
    "SHOW"
    "SUMMARIZE"
    "TABLE"
    "TRUNCATE"
    "UPDATE"
    "UPSERT"
    "USE"
    "VALUE"
    "VALUES"
    "WITH"
    <K_SELECT>

Error parsing: kleines Trockenstressrisiko'
        WHEN
            bodeneinheit_auspraegung_t.nfkapwe >= 250
            AND
            bodeneinheit_onlinedata_t.is_wald IS TRUE
                THEN '>= 250 mm (net.sf.jsqlparser.parser.ParseException: Encountered unexpected token: "kleines" <S_IDENTIFIER>
    at line 1, column 1.

Was expecting one of:

    "("
    "ALTER"
    "ANALYZE"
    "BEGIN"
    "CALL"
    "COMMENT"
    "COMMIT"
    "CREATE"
    "DECLARE"
    "DELETE"
    "DESC"
    "DESCRIBE"
    "DROP"
    "EXEC"
    "EXECUTE"
    "EXPLAIN"
    "FROM"
    "GRANT"
    "IF"
    "INSERT"
    "MERGE"
    "PURGE"
    "REFRESH"
    "RENAME"
    "REPLACE"
    "RESET"
    "ROLLBACK"
    "SAVEPOINT"
    "SET"
    "SHOW"
    "SUMMARIZE"
    "TABLE"
    "TRUNCATE"
    "UPDATE"
    "UPSERT"
    "USE"
    "VALUE"
    "VALUES"
    "WITH"
    <K_SELECT>
)
********************************************************************************
class net.sf.jsqlparser.JSQLParserException
net.sf.jsqlparser.parser.ParseException: Encountered unexpected token: "kein" <S_IDENTIFIER>
    at line 1, column 1.

Was expecting one of:

    "("
    "ALTER"
    "ANALYZE"
    "BEGIN"
    "CALL"
    "COMMENT"
    "COMMIT"
    "CREATE"
    "DECLARE"
    "DELETE"
    "DESC"
    "DESCRIBE"
    "DROP"
    "EXEC"
    "EXECUTE"
    "EXPLAIN"
    "FROM"
    "GRANT"
    "IF"
    "INSERT"
    "MERGE"
    "PURGE"
    "REFRESH"
    "RENAME"
    "REPLACE"
    "RESET"
    "ROLLBACK"
    "SAVEPOINT"
    "SET"
    "SHOW"
    "SUMMARIZE"
    "TABLE"
    "TRUNCATE"
    "UPDATE"
    "UPSERT"
    "USE"
    "VALUE"
    "VALUES"
    "WITH"
    <K_SELECT>

Error parsing: kein Trockenstressrisiko'
    END AS nfkapwe_text,
    bodeneinheit_auspraegung_t.verdempf,
    CASE
        WHEN
            bodeneinheit_auspraegung_t.verdempf = 1
            AND
            bodeneinheit_onlinedata_t.is_wald IS TRUE 
                THEN 'wenig empfindlicher Unterboden: befahren mit üblicher Sorgfalt.'
        WHEN
            bodeneinheit_auspraegung_t.verdempf = 2
            AND
            bodeneinheit_onlinedata_t.is_wald IS TRUE
                THEN 'mässig empfindlicher Unterboden: nach Abtrocknungsphase gut mechanisch belastbar, weiter Rückegassenabstand empfohlen'
        WHEN
            bodeneinheit_auspraegung_t.verdempf = 3
            AND
            bodeneinheit_onlinedata_t.is_wald IS TRUE
                THEN 'empfindlicher Unterboden: erhöhte Sorgfalt beim Befahren notwendig, Trockenperioden optimal nutzen, sehr weiter Rückegassenabstand empfohlen'
        WHEN
            bodeneinheit_auspraegung_t.verdempf = 4
            AND
            bodeneinheit_onlinedata_t.is_wald IS TRUE
                THEN 'stark empfindlicher Unterboden: nur eingeschränkt mechanisch belastbar, längere Trockenperioden abwarten, ergänzende lastverteilende Massnahmen ergreifen, sehr weiter Rückegassenabstand empfohlen'
        WHEN
            bodeneinheit_auspraegung_t.verdempf = 5
            AND
            bodeneinheit_onlinedata_t.is_wald IS TRUE
                THEN 'extrem empfindlicher Unterboden: bereits geringe Auflasten können irreversible Schäden verursachen, befahren vermeiden, falls dennoch nötig: nur mit lastverteilenden und lastreduzierenden Massnahmen und erst nach längeren Trockenperioden.'
        WHEN
            bodeneinheit_auspraegung_t.verdempf = 1
            AND
            bodeneinheit_onlinedata_t.is_wald IS FALSE
                THEN 'wenig empfindlicher Unterboden: Bearbeitung mit üblicher Sorgfalt.'
        WHEN
            bodeneinheit_auspraegung_t.verdempf = 2
            AND
            bodeneinheit_onlinedata_t.is_wald IS FALSE
                THEN 'mässig empfindlicher Unterboden: nach Abtrocknungsphase gut mechanisch belastbar.'
        WHEN
            bodeneinheit_auspraegung_t.verdempf = 3
            AND
            bodeneinheit_onlinedata_t.is_wald IS FALSE
                THEN 'empfindlicher Unterboden: erhöhte Sorgfalt beim Befahren und Feldarbeiten notwendig, Trockenperioden sind optimal zu nutzen.'
        WHEN
            bodeneinheit_auspraegung_t.verdempf = 4
            AND
            bodeneinheit_onlinedata_t.is_wald IS FALSE
                THEN 'stark empfindlicher Unterboden: nur eingeschränkt mechanisch belastbar, längere Trockenperioden abwarten, ergänzende lastreduzierende und lastverteilende Massnahmen ergreifen.'
        WHEN
            bodeneinheit_auspraegung_t.verdempf = 5
            AND
            bodeneinheit_onlinedata_t.is_wald IS FALSE
                THEN 'extrem empfindlicher Unterboden: möglichst Verzicht auf ackerbauliche Nutzung, bereits geringe Auflasten können irreversible Schäden verursachen.'
    END AS verdempf_text,
    bodeneinheit_auspraegung_t.drain_wel,
    bodeneinheit_auspraegung_t.wassastoss,
    bodeneinheit_auspraegung_t.is_hauptauspraegung,
    bodeneinheit_auspraegung_t.gewichtung_auspraegung,
    bodeneinheit_onlinedata_t.geom AS geometrie, 
    bodeneinheit_t.gemnr_aktuell
FROM
    afu_isboden.bodeneinheit_onlinedata_t
    LEFT JOIN afu_isboden.bodeneinheit_t
        ON bodeneinheit_onlinedata_t.objnr = bodeneinheit_t.objnr
    LEFT JOIN charakter_wasserhaushalt
        ON charakter_wasserhaushalt.t_id = bodeneinheit_onlinedata_t.pk_isboden
    LEFT JOIN afu_isboden.bodeneinheit_auspraegung_t
        ON 
            bodeneinheit_auspraegung_t.fk_bodeneinheit = bodeneinheit_t.pk_ogc_fid
            AND
            bodeneinheit_auspraegung_t.is_hauptauspraegung
    LEFT JOIN afu_isboden.wasserhhgr_t
        ON wasserhhgr_t.pk_wasserhhgr = bodeneinheit_auspraegung_t.fk_wasserhhgr
    LEFT JOIN afu_isboden.bodentyp_t
        ON bodentyp_t.pk_bodentyp = bodeneinheit_auspraegung_t.fk_bodentyp
    LEFT JOIN afu_isboden.begelfor_t
        ON begelfor_t.pk_begelfor = bodeneinheit_auspraegung_t.fk_begelfor
    LEFT JOIN afu_isboden.skelett_t AS skelett_t_ob
        ON skelett_t_ob.pk_skelett = bodeneinheit_auspraegung_t.fk_skelett_ob
    LEFT JOIN afu_isboden.skelett_t AS skelett_t_ub
        ON skelett_t_ub.pk_skelett = bodeneinheit_auspraegung_t.fk_skelett_ub
    LEFT JOIN afu_isboden.koernkl_t AS koernkl_t_ob
        ON koernkl_t_ob.pk_koernkl = bodeneinheit_auspraegung_t.fk_koernkl_ob
    LEFT JOIN afu_isboden.koernkl_t AS koernkl_t_ub
        ON koernkl_t_ub.pk_koernkl = bodeneinheit_auspraegung_t.fk_koernkl_ub
    LEFT JOIN afu_isboden.kalkgehalt_t AS kalkgehalt_t_ob
        ON kalkgehalt_t_ob.pk_kalkgehalt = bodeneinheit_auspraegung_t.fk_kalkgehalt_ob
    LEFT JOIN afu_isboden.kalkgehalt_t AS kalkgehalt_t_ub
        ON kalkgehalt_t_ub.pk_kalkgehalt = bodeneinheit_auspraegung_t.fk_kalkgehalt_ub
    LEFT JOIN afu_isboden.humusform_wa_t
        ON humusform_wa_t.pk_humusform_wa = bodeneinheit_auspraegung_t.fk_humusform_wa
    LEFT JOIN afu_isboden.gefuegeform_t AS gefuegeform_t_ob
        ON gefuegeform_t_ob.pk_gefuegeform = bodeneinheit_auspraegung_t.fk_gefuegeform_ob
    LEFT JOIN afu_isboden.gefuegeform_t AS gefuegeform_t_ub
        ON gefuegeform_t_ub.pk_gefuegeform = bodeneinheit_auspraegung_t.fk_gefuegeform_ub
    LEFT JOIN afu_isboden.gefueggr_t AS gefueggr_t_ob
        ON gefueggr_t_ob.pk_gefueggr = bodeneinheit_auspraegung_t.fk_gefueggr_ob
    LEFT JOIN afu_isboden.gefueggr_t AS gefueggr_t_ub
        ON gefueggr_t_ub.pk_gefueggr = bodeneinheit_auspraegung_t.fk_gefueggr_ub
    LEFT JOIN
        (
            SELECT
                zw_bodeneinheit_untertyp_t.fk_bodeneinheit,
                (
                    SELECT
                        REPLACE(afu_isboden.filter_array(array_agg(untertyp_t.code)::text[], 'E'),',',', ') AS filter_array
                ) AS untertyp_e,
                (
                    SELECT
                        REPLACE(afu_isboden.filter_array(array_agg(untertyp_t.code)::text[], 'K'),',',', ') AS filter_array
                ) AS untertyp_k,
                (
                    SELECT
                        REPLACE(afu_isboden.filter_array(array_agg(untertyp_t.code)::text[], 'I'),',',', ') AS filter_array
                ) AS untertyp_i,
                (
                    SELECT
                        REPLACE(afu_isboden.filter_array(array_agg(untertyp_t.code)::text[], 'G'),',',', ') AS filter_array
                ) AS untertyp_g,
                (
                    SELECT
                        REPLACE(afu_isboden.filter_array(array_agg(untertyp_t.code)::text[], 'R'),',',', ') AS filter_array
                ) AS untertyp_r,
                (
                    SELECT
                        REPLACE(afu_isboden.filter_array(array_agg(untertyp_t.code)::text[], 'P'),',',', ') AS filter_array
                ) AS untertyp_p,
                CASE
                    WHEN REPLACE(regexp_replace(regexp_replace(regexp_replace(regexp_replace(array_agg(untertyp_t.code)::text, '(E|K|I|G|R|P).(,|})'::text, ''::text, 'g'::text), '({|})'::text, ''::text, 'g'::text), '( ,|^,)'::text, ''::text, 'g'::text), '( |,$)'::text, ''::text, 'g'::text),',',', ') = ''::text 
                        THEN NULL::text
                    ELSE REPLACE(regexp_replace(regexp_replace(regexp_replace(regexp_replace(array_agg(untertyp_t.code)::text, '(E|K|I|G|R|P).(,|})'::text, ''::text, 'g'::text), '({|})'::text, ''::text, 'g'::text), '( ,|^,)'::text, ''::text, 'g'::text), '( |,$)'::text, ''::text, 'g'::text),',',', ')
                END AS untertyp_div
            FROM
                afu_isboden.zw_bodeneinheit_untertyp AS zw_bodeneinheit_untertyp_t
                LEFT JOIN afu_isboden.untertyp_t
                    ON untertyp_t.pk_untertyp = zw_bodeneinheit_untertyp_t.fk_untertyp
            GROUP BY
                zw_bodeneinheit_untertyp_t.fk_bodeneinheit
        ) AS untertyp
        ON untertyp.fk_bodeneinheit = bodeneinheit_auspraegung_t.pk_bodeneinheit
WHERE
    bodeneinheit_onlinedata_t.archive = 0
    AND
    bodeneinheit_onlinedata_t.is_haupt
    AND
    bodeneinheit_auspraegung_t.is_hauptauspraegung
    AND
    bodeneinheit_onlinedata_t.gemnr = bodeneinheit_t.gemnr
    AND
    bodeneinheit_t.archive = 0
    AND
    bodeneinheit_t.los = bodeneinheit_onlinedata_t.los (net.sf.jsqlparser.parser.ParseException: Encountered unexpected token: "kein" <S_IDENTIFIER>
    at line 1, column 1.

Was expecting one of:

    "("
    "ALTER"
    "ANALYZE"
    "BEGIN"
    "CALL"
    "COMMENT"
    "COMMIT"
    "CREATE"
    "DECLARE"
    "DELETE"
    "DESC"
    "DESCRIBE"
    "DROP"
    "EXEC"
    "EXECUTE"
    "EXPLAIN"
    "FROM"
    "GRANT"
    "IF"
    "INSERT"
    "MERGE"
    "PURGE"
    "REFRESH"
    "RENAME"
    "REPLACE"
    "RESET"
    "ROLLBACK"
    "SAVEPOINT"
    "SET"
    "SHOW"
    "SUMMARIZE"
    "TABLE"
    "TRUNCATE"
    "UPDATE"
    "UPSERT"
    "USE"
    "VALUE"
    "VALUES"
    "WITH"
    <K_SELECT>
)
********************************************************************************
--------------------------------------------------------------------------------
afu_isboden_pub/afu_isboden_bodeneinheiten_to_onlinedata_t.sql
--------------------------------------------------------------------------------
awjf_wald_pub/awjf_waldstandorte_pub.sql
--------------------------------------------------------------------------------
awjf_wald_pub/awjf_wald_oberhoehenbonitaet_pub.sql
--------------------------------------------------------------------------------
arp_mjpnl_migration/mjpnl_postprocessing_vereinbarungen_gelan_bewirtschaftungseinheiten.sql
--------------------------------------------------------------------------------
arp_mjpnl_migration/mjpnl_postprocessing_vereinbarungen_flurnamen_zuweisen.sql
--------------------------------------------------------------------------------
arp_mjpnl_migration/mjpnl_postprocessing_abrechnung_per_bewirtschafter.sql
--------------------------------------------------------------------------------
arp_mjpnl_migration/mjpnl_postprocessing_vereinbarung_uzl-region.sql
--------------------------------------------------------------------------------
arp_mjpnl_migration/mjpnl_postprocessing_abrechnung_per_vereinbarung.sql
--------------------------------------------------------------------------------
arp_mjpnl_migration/mjpnl_postprocessing_beurteilungen_hecke.sql
--------------------------------------------------------------------------------
arp_mjpnl_migration/mjpnl_postprocessing_beurteilungen_obl.sql
--------------------------------------------------------------------------------
arp_mjpnl_migration/mjpnl_leistung.sql
--------------------------------------------------------------------------------
arp_mjpnl_migration/mjpnl_postprocessing_beurteilungen_hostet.sql
--------------------------------------------------------------------------------
arp_mjpnl_migration/mjpnl_postprocessing_vereinbarungsnummern.sql
--------------------------------------------------------------------------------
arp_mjpnl_migration/mjpnl_postprocessing_vereinbarung_soemmerungsgebiet.sql
--------------------------------------------------------------------------------
arp_mjpnl_migration/mjpnl_postprocessing_beurteilungen_weide_soeg.sql
--------------------------------------------------------------------------------
arp_mjpnl_migration/mjpnl_postprocessing_beurteilungen_wiese.sql
--------------------------------------------------------------------------------
arp_mjpnl_migration/mjpnl_postprocessing_leistungen_fkey_vereinbarungen.sql
--------------------------------------------------------------------------------
arp_mjpnl_migration/delete_mjpnl_before_import.sql
--------------------------------------------------------------------------------
arp_mjpnl_migration/mjpnl_postprocessing_fill_t_basket.sql
--------------------------------------------------------------------------------
arp_mjpnl_migration/mjpnl_vereinbarung.sql
--------------------------------------------------------------------------------
arp_mjpnl_migration/mjpnl_postprocessing_remove_duplicate_coords.sql
--------------------------------------------------------------------------------
arp_mjpnl_migration/mjpnl_dummy_entries.sql
--------------------------------------------------------------------------------
arp_mjpnl_migration/mjpnl_postprocessing_vereinbarungen_gelan_bewirtschafter.sql
--------------------------------------------------------------------------------
arp_mjpnl_migration/mjpnl_postprocessing_vereinbarungen_gelan_kulturflaechen.sql
--------------------------------------------------------------------------------
arp_mjpnl_migration/mjpnl_remove_dummy_entries.sql
--------------------------------------------------------------------------------
arp_mjpnl_migration/mjpnl_postprocessing_vereinbarungen_liegenschaften_zuweisen.sql
--------------------------------------------------------------------------------
arp_mjpnl_migration/mjpnl_postprocessing_vereinbarungen_gemeinden_zuweisen.sql
--------------------------------------------------------------------------------
arp_mjpnl_migration/mjpnl_postprocessing_beurteilungen_weide_ln.sql
--------------------------------------------------------------------------------
agi_ch_gemeinden/agi_swissboundaries3d_pub_pub_swissboundaries3d_bezirk.sql
--------------------------------------------------------------------------------
agi_ch_gemeinden/agi_swissboundaries3d_pub_pub_swissboundaries3d_land.sql
--------------------------------------------------------------------------------
agi_ch_gemeinden/agi_swissboundaries3d_pub_edit_swissboundaries3d_hoheitsgebiet.sql
--------------------------------------------------------------------------------
agi_ch_gemeinden/agi_swissboundaries3d_pub_sogis_swissboundaries3d_bezirk.sql
--------------------------------------------------------------------------------
agi_ch_gemeinden/agi_swissboundaries3d_pub_sogis_swissboundaries3d_hoheitsgebiet.sql
--------------------------------------------------------------------------------
agi_ch_gemeinden/agi_swissboundaries3d_pub_edit_swissboundaries3d_bezirk.sql
--------------------------------------------------------------------------------
agi_ch_gemeinden/agi_swissboundaries3d_pub_sogis_swissboundaries3d_land.sql
--------------------------------------------------------------------------------
agi_ch_gemeinden/agi_swissboundaries3d_pub_sogis_swissboundaries3d_kanton.sql
--------------------------------------------------------------------------------
agi_ch_gemeinden/agi_swissboundaries3d_pub_edit_swissboundaries3d_kanton.sql
--------------------------------------------------------------------------------
agi_ch_gemeinden/agi_swissboundaries3d_pub_pub_swissboundaries3d_hoheitsgebiet.sql
--------------------------------------------------------------------------------
agi_ch_gemeinden/agi_swissboundaries3d_pub_pub_swissboundaries3d_kanton.sql
--------------------------------------------------------------------------------
agi_ch_gemeinden/agi_swissboundaries3d_pub_edit_swissboundaries3d_land.sql
--------------------------------------------------------------------------------
arp_arbeitszonenbewirtschaftung_inventar_pub/select_inventar_flaeche.sql
--------------------------------------------------------------------------------
arp_arbeitszonenbewirtschaftung_inventar_pub/update_staging.sql
--------------------------------------------------------------------------------
arp_arbeitszonenbewirtschaftung_inventar_pub/select_staging.sql
--------------------------------------------------------------------------------
arp_arbeitszonenbewirtschaftung_inventar_pub/select_region.sql
--------------------------------------------------------------------------------
awjf_gewaesser_fischerei_pub/fischerei.sql
--------------------------------------------------------------------------------
awjf_schutzwald_pub/awjf_schutzwald_pub_dokument.sql
--------------------------------------------------------------------------------
awjf_schutzwald_pub/updateTxtColsSchutzwald.sql
--------------------------------------------------------------------------------
awjf_schutzwald_pub/awjf_schutzwald_pub_info.sql
--------------------------------------------------------------------------------
awjf_schutzwald_pub/awjf_schutzwald_pub_schutzwald.sql
--------------------------------------------------------------------------------
awjf_schutzwald_pub/awjf_schutzwald_pub_beh_flaeche.sql
--------------------------------------------------------------------------------
awjf_rodung_rodungsersatz_pub/awjf_rodung_rodungsersatz_flaeche.sql
--------------------------------------------------------------------------------
awjf_rodung_rodungsersatz_pub/awjf_rodung_rodungsersatz_punkt.sql
--------------------------------------------------------------------------------
afu_igel/standort.sql
class net.sf.jsqlparser.JSQLParserException
net.sf.jsqlparser.parser.ParseException: Encountered unexpected token: "\n\n\n" <ST_SEMICOLON>
    at line 60, column 3.

Was expecting one of:

    "ACTION"
    "ACTIVE"
    "ADD"
    "ADVANCE"
    "ADVISE"
    "AGAINST"
    "AGGREGATE"
    "ALGORITHM"
    "ALTER"
    "ANALYZE"
    "APPLY"
    "APPROXIMATE"
    "ARCHIVE"
    "ARRAY"
    "ASC"
    "AT"
    "AUTHORIZATION"
    "AUTO"
    "AUTO_INCREMENT"
    "BASE64"
    "BEGIN"
    "BERNOULLI"
    "BINARY"
    "BIT"
    "BLOCK"
    "BROWSE"
    "BUFFERS"
    "BY"
    "BYTE"
    "BYTES"
    "CACHE"
    "CALL"
    "CASCADE"
    "CASE"
    "CAST"
    "CHANGE"
    "CHANGES"
    "CHAR"
    "CHARACTER"
    "CHECKPOINT"
    "CLOSE"
    "COALESCE"
    "COLLATE"
    "COLUMN"
    "COLUMNS"
    "COMMENT"
    "COMMIT"
    "CONCURRENTLY"
    "CONFLICT"
    "CONNECT"
    "CONSTRAINTS"
    "CONVERT"
    "CORRESPONDING"
    "COSTS"
    "COUNT"
    "CREATE"
    "CS"
    "CYCLE"
    "DATA"
    "DATABASE"
    "DATETIME"
    "DBA_RECYCLEBIN"
    "DDL"
    "DECLARE"
    "DEFAULT"
    "DEFERRABLE"
    "DELAYED"
    "DELETE"
    "DESC"
    "DESCRIBE"
    "DISABLE"
    "DISCARD"
    "DISCONNECT"
    "DIV"
    "DML"
    "DO"
    "DOMAIN"
    "DROP"
    "DUMP"
    "DUPLICATE"
    "ELEMENTS"
    "EMIT"
    "ENABLE"
    "ENCRYPTION"
    "END"
    "ENFORCED"
    "ENGINE"
    "ERROR"
    "ESCAPE"
    "EXCHANGE"
    "EXCLUDE"
    "EXEC"
    "EXECUTE"
    "EXPLAIN"
    "EXPLICIT"
    "EXTENDED"
    "EXTRACT"
    "FILTER"
    "FIRST"
    "FLUSH"
    "FN"
    "FOLLOWING"
    "FORMAT"
    "FULLTEXT"
    "FUNCTION"
    "GRANT"
    "GROUP"
    "GROUP_CONCAT"
    "GUARD"
    "HASH"
    "HIGH"
    "HIGH_PRIORITY"
    "HISTORY"
    "HOPPING"
    "IGNORE"
    "IMPORT"
    "INCLUDE"
    "INCLUDE_NULL_VALUES"
    "INCREMENT"
    "INDEX"
    "INSERT"
    "INTERLEAVE"
    "INTERPRET"
    "INTERVAL"
    "INVALIDATE"
    "INVERSE"
    "INVISIBLE"
    "ISNULL"
    "JSON"
    "JSON_ARRAY"
    "JSON_ARRAYAGG"
    "JSON_OBJECT"
    "JSON_OBJECTAGG"
    "KEEP"
    "KEY"
    "KEYS"
    "KEY_BLOCK_SIZE"
    "LAST"
    "LEADING"
    "LESS"
    "LINK"
    "LOCAL"
    "LOCK"
    "LOCKED"
    "LOG"
    "LONGTEXT"
    "LOOP"
    "LOW"
    "LOW_PRIORITY"
    "MATCH"
    "MATCHED"
    "MATCH_ALL"
    "MATCH_ANY"
    "MATCH_PHRASE"
    "MATCH_PHRASE_PREFIX"
    "MATCH_REGEXP"
    "MATERIALIZED"
    "MAX"
    "MAXVALUE"
    "MEDIUMTEXT"
    "MEMBER"
    "MERGE"
    "MIN"
    "MINVALUE"
    "MODIFY"
    "MOVEMENT"
    "NAME"
    "NEXT"
    "NO"
    "NOCACHE"
    "NOKEEP"
    "NOLOCK"
    "NOMAXVALUE"
    "NOMINVALUE"
    "NOORDER"
    "NOTHING"
    "NOTNULL"
    "NOVALIDATE"
    "NOWAIT"
    "NULLS"
    "OF"
    "OFF"
    "ON"
    "OPEN"
    "ORDINALITY"
    "OVER"
    "OVERFLOW"
    "OVERLAPS"
    "OVERRIDING"
    "OVERWRITE"
    "PARALLEL"
    "PARENT"
    "PARSER"
    "PARTITION"
    "PARTITIONING"
    "PATH"
    "PERCENT"
    "PLACING"
    "PLAN"
    "PLUS"
    "PRECEDING"
    "PRIMARY"
    "PURGE"
    "QUALIFY"
    "QUERY"
    "QUICK"
    "QUIESCE"
    "RANGE"
    "RAW"
    "READ"
    "REBUILD"
    "RECURSIVE"
    "RECYCLEBIN"
    "REFERENCES"
    "REFRESH"
    "REGEXP"
    "REGEXP_LIKE"
    "REGISTER"
    "REMOTE"
    "REMOVE"
    "RENAME"
    "REORGANIZE"
    "REPAIR"
    "REPEATABLE"
    "REPLACE"
    "RESET"
    "RESPECT"
    "RESTART"
    "RESTRICT"
    "RESTRICTED"
    "RESUMABLE"
    "RESUME"
    "RETURN"
    "RLIKE"
    "ROLLBACK"
    "ROLLUP"
    "ROOT"
    "ROW"
    "ROWS"
    "RR"
    "RS"
    "SAFE_CAST"
    "SAVEPOINT"
    "SCHEMA"
    "SECURE"
    "SEED"
    "SEPARATOR"
    "SEQUENCE"
    "SESSION"
    "SETS"
    "SHARE"
    "SHOW"
    "SHUTDOWN"
    "SIBLINGS"
    "SIGNED"
    "SIMILAR"
    "SIZE"
    "SKIP"
    "SPATIAL"
    "START"
    "STORED"
    "STRICT"
    "STRING"
    "STRUCT"
    "SUMMARIZE"
    "SUSPEND"
    "SWITCH"
    "SYNONYM"
    "SYSTEM"
    "TABLE"
    "TABLES"
    "TABLESPACE"
    "TEMP"
    "TEMPORARY"
    "TEXT"
    "THAN"
    "THEN"
    "TIMEOUT"
    "TIMESTAMPTZ"
    "TIMEZONE"
    "TINYTEXT"
    "TO"
    "TOP"
    "TRIGGER"
    "TRUNCATE"
    "TRY_CAST"
    "TUMBLING"
    "TYPE"
    "UNLOGGED"
    "UNQIESCE"
    "UNSIGNED"
    "UPDATE"
    "UPSERT"
    "UR"
    "USER"
    "VALIDATE"
    "VALIDATION"
    "VALUE"
    "VALUES"
    "VERBOSE"
    "VIEW"
    "VISIBLE"
    "VOLATILE"
    "WAIT"
    "WITHIN"
    "WITHOUT"
    "WITHOUT_ARRAY_WRAPPER"
    "WORK"
    "XML"
    "XMLAGG"
    "XMLDATA"
    "XMLSCHEMA"
    "XMLTEXT"
    "XSINIL"
    "YAML"
    "YES"
    "ZONE"
    <DATA_TYPE>
    <K_DATETIMELITERAL>
    <K_DATE_LITERAL>
    <K_ISOLATION>
    <K_STRING_FUNCTION_NAME>
    <K_TEXT_LITERAL>
    <K_TIME_KEY_EXPR>
    <S_IDENTIFIER>
    <S_QUOTED_IDENTIFIER>

Error parsing: WITH 

raw_columns AS (
	SELECT
		rowdef.*
	FROM 
		afu_igel.igel_standort s
	CROSS JOIN LATERAL
		jsonb_to_record(s.content::jsonb) AS rowdef(
			"IdStao" int,
			"IsAktiv" boolean, 
			"IgelPid" int,
			"GelanPid" int,
			"HdaNr" int,
			"Typ" text, 
			"Name" text,
			"Adresse" text,
			"Gemeinde" text, 
			"GveTotal" numeric(9,3),
			"MistIst" numeric(9,3),
			"MistSoll" numeric(9,3),		
			"GuelleIst" numeric(9,3), 
			"GuelleSoll" numeric(9,3), 
			"TypBetrieb" int,
			"BewirtschafterName" text, 
			"HaushaltAbwasserTotal" numeric(9,3), 
			"DatumAktuellsteErhebung" text, 
			"HaushaltAbwasserAbleitungen" jsonb,
			"KoordinateE" int,
			"KoordinateN" int
		)
),

mapped_columns AS (
	SELECT
		"IdStao" AS id,
		"Name" AS aname,
		"IsAktiv" AS aktiv,
		"Typ" AS typ_standort_code,
		"TypBetrieb" AS typ_betrieb_code,
		"Adresse" AS strasse_hausnr,
		"Gemeinde" AS plz_ort,
		"HdaNr" AS hda_nr,
		"GelanPid" AS gelan_pid,
		"IgelPid" AS igel_pid,
		"BewirtschafterName" AS name_bewirtschafter,
		to_date("DatumAktuellsteErhebung", 'DD.MM.YYYY') AS aktuellsteerhebung,
		"HaushaltAbwasserAbleitungen" AS  abwasserableitungen_codes, 
		"HaushaltAbwasserTotal" AS abwasser_total,
		"GuelleIst" AS guelle_ist,
		"GuelleSoll" AS guelle_soll,
		"MistIst" AS mist_ist,
		"MistSoll" AS mist_soll,
		"GveTotal" AS gve_total,
		st_setsrid(st_makepoint("KoordinateE", "KoordinateN"), 2056) AS geometrie
	FROM 
		raw_columns
	WHERE
		"KoordinateE" IS NOT NULL AND "KoordinateN" IS NOT NULL
),


abwasser_code AS ( -- Erstellt für jeden Abwasserableitungs-Code eines Standortes eine Zeile mit Spalten [id, abwasser_code]
	SELECT 
		id,
		jsonb_array_elements(abwasserableitungen_codes)::int AS abwasser_code
	FROM 
		mapped_columns
),

abwasser_lookup AS ( -- Codetabelle gemäss softec.ch
	SELECT 
		* 
	FROM (
		VALUES 
			(0, 'Güllegrube'), 
			(1, 'Ara'), 
			(2, 'Klara'), 
			(3, 'Abflusslose Hausgrube'),
			(4, 'Andere'),
			(5, 'Klärgrube')
	) 
	AS t (code, val)
),

abwasser_code_value AS (
	SELECT
		id,
		abwasser_code,
		val as abwasser_value
	FROM 
		abwasser_code
	LEFT JOIN
		abwasser_lookup
			ON abwasser_code.abwasser_code = abwasser_lookup.code
),

abwasser_values AS (
	SELECT 
		id,
		array_to_json(
			array_agg(abwasser_value)
		) as abwasser_values
	FROM
		abwasser_code_value
	GROUP BY
		id
),

betrieb_lookup AS ( -- Codetabelle gemäss softec.ch
	SELECT 
		* 
	FROM (
		VALUES 
			('LbvNachDz',  1),
			('Betriebsgemeinschaft', 2),
			('Gemeinschaftsweidebetriebe', 3),
			('LbvOhneDz', 4),
			('NichtKommerzielleTierhaltung', 5),
			('NichtLbvUebrige', 6),
			('GsBetrieb', 7),
			('Schlachthof', 8),
			('Betriebszweiggemeinschaft', 9),
			('ÖlnGemeinschaft', 10),
			('Viehhandelsunternehmen', 11),
			('Kompostieranlage', 12),
			('Biogasanlage', 13),
			('Soemmerungsbetrieb', 14),
			('KeinLandwirtschaftsbetrieb', 99)
	) 
	AS t (val, code)
),

stall_ids_raw AS (
	SELECT
		rowdef.*
	FROM 
		afu_igel.igel_stall s
	CROSS JOIN LATERAL
		jsonb_to_record(s.content::jsonb) as rowdef(
			"idStall"int,
			"idStao" int,
			"koordinateE" int,
			"koordinateN" int
		)
),

stall_ids AS (
	SELECT
		"idStao" AS id,
		to_json(array_agg("idStall")) AS stall_ids
	FROM
		stall_ids_raw
	WHERE
		"koordinateE" IS NOT NULL 
		AND 
		"koordinateN" IS NOT NULL 
	GROUP BY 
		"idStao"
),

pid_stao_count AS (
	SELECT
		gelan_pid,
		count(*) AS gelan_pid_standort_count
	FROM 
		mapped_columns
	GROUP BY
		gelan_pid
)

SELECT 
	mapped_columns.id,
	aname,
	aktiv,
	typ_standort_code,
	strasse_hausnr,
	plz_ort,
	hda_nr,
	mapped_columns.gelan_pid,
	igel_pid,
	name_bewirtschafter,
	aktuellsteerhebung,
	abwasser_total,
	guelle_ist,
	guelle_soll,
	mist_ist,
	mist_soll,
	gve_total,
	geometrie,
	abwasserableitungen_codes,
	abwasser_values AS abwasserableitungen_texte,
	typ_betrieb_code,
	val AS typ_betrieb_text,
	stall_ids,
	gelan_pid_standort_count
FROM 
	mapped_columns
LEFT JOIN
	abwasser_values
		ON mapped_columns.id = abwasser_values.id
LEFT JOIN
	betrieb_lookup
		ON mapped_columns.typ_betrieb_code = betrieb_lookup.code
LEFT JOIN 
	stall_ids
		ON mapped_columns.id = stall_ids.id
LEFT JOIN
	pid_stao_count pid 
	    ON mapped_columns.gelan_pid = pid.gelan_pid (net.sf.jsqlparser.parser.ParseException: Encountered unexpected token: "\n\n\n" <ST_SEMICOLON>
    at line 60, column 3.

Was expecting one of:

    "ACTION"
    "ACTIVE"
    "ADD"
    "ADVANCE"
    "ADVISE"
    "AGAINST"
    "AGGREGATE"
    "ALGORITHM"
    "ALTER"
    "ANALYZE"
    "APPLY"
    "APPROXIMATE"
    "ARCHIVE"
    "ARRAY"
    "ASC"
    "AT"
    "AUTHORIZATION"
    "AUTO"
    "AUTO_INCREMENT"
    "BASE64"
    "BEGIN"
    "BERNOULLI"
    "BINARY"
    "BIT"
    "BLOCK"
    "BROWSE"
    "BUFFERS"
    "BY"
    "BYTE"
    "BYTES"
    "CACHE"
    "CALL"
    "CASCADE"
    "CASE"
    "CAST"
    "CHANGE"
    "CHANGES"
    "CHAR"
    "CHARACTER"
    "CHECKPOINT"
    "CLOSE"
    "COALESCE"
    "COLLATE"
    "COLUMN"
    "COLUMNS"
    "COMMENT"
    "COMMIT"
    "CONCURRENTLY"
    "CONFLICT"
    "CONNECT"
    "CONSTRAINTS"
    "CONVERT"
    "CORRESPONDING"
    "COSTS"
    "COUNT"
    "CREATE"
    "CS"
    "CYCLE"
    "DATA"
    "DATABASE"
    "DATETIME"
    "DBA_RECYCLEBIN"
    "DDL"
    "DECLARE"
    "DEFAULT"
    "DEFERRABLE"
    "DELAYED"
    "DELETE"
    "DESC"
    "DESCRIBE"
    "DISABLE"
    "DISCARD"
    "DISCONNECT"
    "DIV"
    "DML"
    "DO"
    "DOMAIN"
    "DROP"
    "DUMP"
    "DUPLICATE"
    "ELEMENTS"
    "EMIT"
    "ENABLE"
    "ENCRYPTION"
    "END"
    "ENFORCED"
    "ENGINE"
    "ERROR"
    "ESCAPE"
    "EXCHANGE"
    "EXCLUDE"
    "EXEC"
    "EXECUTE"
    "EXPLAIN"
    "EXPLICIT"
    "EXTENDED"
    "EXTRACT"
    "FILTER"
    "FIRST"
    "FLUSH"
    "FN"
    "FOLLOWING"
    "FORMAT"
    "FULLTEXT"
    "FUNCTION"
    "GRANT"
    "GROUP"
    "GROUP_CONCAT"
    "GUARD"
    "HASH"
    "HIGH"
    "HIGH_PRIORITY"
    "HISTORY"
    "HOPPING"
    "IGNORE"
    "IMPORT"
    "INCLUDE"
    "INCLUDE_NULL_VALUES"
    "INCREMENT"
    "INDEX"
    "INSERT"
    "INTERLEAVE"
    "INTERPRET"
    "INTERVAL"
    "INVALIDATE"
    "INVERSE"
    "INVISIBLE"
    "ISNULL"
    "JSON"
    "JSON_ARRAY"
    "JSON_ARRAYAGG"
    "JSON_OBJECT"
    "JSON_OBJECTAGG"
    "KEEP"
    "KEY"
    "KEYS"
    "KEY_BLOCK_SIZE"
    "LAST"
    "LEADING"
    "LESS"
    "LINK"
    "LOCAL"
    "LOCK"
    "LOCKED"
    "LOG"
    "LONGTEXT"
    "LOOP"
    "LOW"
    "LOW_PRIORITY"
    "MATCH"
    "MATCHED"
    "MATCH_ALL"
    "MATCH_ANY"
    "MATCH_PHRASE"
    "MATCH_PHRASE_PREFIX"
    "MATCH_REGEXP"
    "MATERIALIZED"
    "MAX"
    "MAXVALUE"
    "MEDIUMTEXT"
    "MEMBER"
    "MERGE"
    "MIN"
    "MINVALUE"
    "MODIFY"
    "MOVEMENT"
    "NAME"
    "NEXT"
    "NO"
    "NOCACHE"
    "NOKEEP"
    "NOLOCK"
    "NOMAXVALUE"
    "NOMINVALUE"
    "NOORDER"
    "NOTHING"
    "NOTNULL"
    "NOVALIDATE"
    "NOWAIT"
    "NULLS"
    "OF"
    "OFF"
    "ON"
    "OPEN"
    "ORDINALITY"
    "OVER"
    "OVERFLOW"
    "OVERLAPS"
    "OVERRIDING"
    "OVERWRITE"
    "PARALLEL"
    "PARENT"
    "PARSER"
    "PARTITION"
    "PARTITIONING"
    "PATH"
    "PERCENT"
    "PLACING"
    "PLAN"
    "PLUS"
    "PRECEDING"
    "PRIMARY"
    "PURGE"
    "QUALIFY"
    "QUERY"
    "QUICK"
    "QUIESCE"
    "RANGE"
    "RAW"
    "READ"
    "REBUILD"
    "RECURSIVE"
    "RECYCLEBIN"
    "REFERENCES"
    "REFRESH"
    "REGEXP"
    "REGEXP_LIKE"
    "REGISTER"
    "REMOTE"
    "REMOVE"
    "RENAME"
    "REORGANIZE"
    "REPAIR"
    "REPEATABLE"
    "REPLACE"
    "RESET"
    "RESPECT"
    "RESTART"
    "RESTRICT"
    "RESTRICTED"
    "RESUMABLE"
    "RESUME"
    "RETURN"
    "RLIKE"
    "ROLLBACK"
    "ROLLUP"
    "ROOT"
    "ROW"
    "ROWS"
    "RR"
    "RS"
    "SAFE_CAST"
    "SAVEPOINT"
    "SCHEMA"
    "SECURE"
    "SEED"
    "SEPARATOR"
    "SEQUENCE"
    "SESSION"
    "SETS"
    "SHARE"
    "SHOW"
    "SHUTDOWN"
    "SIBLINGS"
    "SIGNED"
    "SIMILAR"
    "SIZE"
    "SKIP"
    "SPATIAL"
    "START"
    "STORED"
    "STRICT"
    "STRING"
    "STRUCT"
    "SUMMARIZE"
    "SUSPEND"
    "SWITCH"
    "SYNONYM"
    "SYSTEM"
    "TABLE"
    "TABLES"
    "TABLESPACE"
    "TEMP"
    "TEMPORARY"
    "TEXT"
    "THAN"
    "THEN"
    "TIMEOUT"
    "TIMESTAMPTZ"
    "TIMEZONE"
    "TINYTEXT"
    "TO"
    "TOP"
    "TRIGGER"
    "TRUNCATE"
    "TRY_CAST"
    "TUMBLING"
    "TYPE"
    "UNLOGGED"
    "UNQIESCE"
    "UNSIGNED"
    "UPDATE"
    "UPSERT"
    "UR"
    "USER"
    "VALIDATE"
    "VALIDATION"
    "VALUE"
    "VALUES"
    "VERBOSE"
    "VIEW"
    "VISIBLE"
    "VOLATILE"
    "WAIT"
    "WITHIN"
    "WITHOUT"
    "WITHOUT_ARRAY_WRAPPER"
    "WORK"
    "XML"
    "XMLAGG"
    "XMLDATA"
    "XMLSCHEMA"
    "XMLTEXT"
    "XSINIL"
    "YAML"
    "YES"
    "ZONE"
    <DATA_TYPE>
    <K_DATETIMELITERAL>
    <K_DATE_LITERAL>
    <K_ISOLATION>
    <K_STRING_FUNCTION_NAME>
    <K_TEXT_LITERAL>
    <K_TIME_KEY_EXPR>
    <S_IDENTIFIER>
    <S_QUOTED_IDENTIFIER>
)
********************************************************************************
--------------------------------------------------------------------------------
afu_igel/stall.sql
class net.sf.jsqlparser.JSQLParserException
net.sf.jsqlparser.parser.ParseException: Encountered unexpected token: "\n\n\n" <ST_SEMICOLON>
    at line 60, column 2.

Was expecting one of:

    "("
    ","
    "DELETE"
    "FROM"
    "INSERT"
    "MERGE"
    "UPDATE"
    "VALUE"
    "VALUES"
    "WITH"
    <K_SELECT>

Error parsing: WITH 

raw_columns AS (
	select
		rowdef.*
	from 
		afu_igel.igel_stall s
	CROSS JOIN LATERAL
		jsonb_to_record(s.content::jsonb) as rowdef(
			"idStall" int,
			"idStao" int,
			"name" text,
			"tierart" text,
			"anzahl" int,
			"aufstallung" text, 
			"aufenthaltWochen" int,
			"winterfuetterungWochen" int,			
			"guellevolumen" NUMERIC(9,3), 
			"mistplatzflaeche" NUMERIC(9,3), 						
			"bemerkungen" TEXT,			
			"koordinateE" int,
			"koordinateN" int
		)
),

stao_bewirtschafter AS (
	SELECT
		rowdef.*
	FROM 
		afu_igel.igel_standort s
	CROSS JOIN LATERAL
		jsonb_to_record(s.content::jsonb) AS rowdef(
			"IdStao" int,
			"BewirtschafterName" TEXT
		)
),

mapped_records AS (
	SELECT
		"idStall" AS id,
		"idStao" AS standort_id,
		"name" AS aname,
		"BewirtschafterName" AS stao_name_bewirtschafter,
		"tierart" AS tierart,
		"anzahl" AS anzahl_tiere,
		"aufstallung" AS aufstallung_code,
		"aufenthaltWochen" AS aufenthalt_wochen, 
		"winterfuetterungWochen" AS winterfuetterung_wochen,
		"mistplatzflaeche" AS mistplatzflaeche,
		"guellevolumen" AS guelle_volumen,
		"bemerkungen" AS bemerkungen,
		st_setsrid(st_makepoint("koordinateE", "koordinateN"), 2056) AS geometrie
	FROM 
		raw_columns
	LEFT JOIN 
		stao_bewirtschafter
			ON raw_columns."idStao" = stao_bewirtschafter."IdStao"
	WHERE
		"koordinateE" IS NOT NULL AND "koordinateN" IS NOT NULL
)


SELECT * FROM mapped_records (net.sf.jsqlparser.parser.ParseException: Encountered unexpected token: "\n\n\n" <ST_SEMICOLON>
    at line 60, column 2.

Was expecting one of:

    "("
    ","
    "DELETE"
    "FROM"
    "INSERT"
    "MERGE"
    "UPDATE"
    "VALUE"
    "VALUES"
    "WITH"
    <K_SELECT>
)
********************************************************************************
--------------------------------------------------------------------------------
awjf_waldpflege_kontrolle/delete_from_awjf_waldpflege_erfassung.sql
--------------------------------------------------------------------------------
awjf_waldpflege_kontrolle/awjf_waldpflege_kontrolle.sql
--------------------------------------------------------------------------------
dsbjd_ebauso_rahmenmodell_pub/lokalisation_gebaeudeeingang.sql
--------------------------------------------------------------------------------
dsbjd_ebauso_rahmenmodell_pub/fruchtfolgeflaechen.sql
--------------------------------------------------------------------------------
dsbjd_ebauso_rahmenmodell_pub/nutzungsplanung.sql
--------------------------------------------------------------------------------
dsbjd_ebauso_rahmenmodell_pub/transfer_stage_to_prod.sql
--------------------------------------------------------------------------------
dsbjd_ebauso_rahmenmodell_pub/denkmalschutz.sql
--------------------------------------------------------------------------------
dsbjd_ebauso_rahmenmodell_pub/delete_stage_fachthemen.sql
--------------------------------------------------------------------------------
dsbjd_ebauso_rahmenmodell_pub/lokalisation_grundstueck.sql
--------------------------------------------------------------------------------
dsbjd_ebauso_rahmenmodell_pub/naturgefahren.sql
--------------------------------------------------------------------------------
dsbjd_ebauso_rahmenmodell_pub/archaeologie.sql
--------------------------------------------------------------------------------
dsbjd_ebauso_rahmenmodell_pub/oereb_to_stage_polygon.sql
--------------------------------------------------------------------------------
dsbjd_ebauso_rahmenmodell_pub/bodenbedeckung.sql
--------------------------------------------------------------------------------
avt_mehrjahresplanung_pub/select_projekte_und_geometrie.sql
class net.sf.jsqlparser.JSQLParserException
net.sf.jsqlparser.parser.ParseException: Encountered unexpected token: "\n\n\n" <ST_SEMICOLON>
    at line 68, column 3.

Was expecting one of:

    "ACTION"
    "ACTIVE"
    "ADD"
    "ADVANCE"
    "ADVISE"
    "AGAINST"
    "AGGREGATE"
    "ALGORITHM"
    "ALTER"
    "ANALYZE"
    "APPLY"
    "APPROXIMATE"
    "ARCHIVE"
    "ARRAY"
    "ASC"
    "AT"
    "AUTHORIZATION"
    "AUTO"
    "AUTO_INCREMENT"
    "BASE64"
    "BEGIN"
    "BERNOULLI"
    "BINARY"
    "BIT"
    "BLOCK"
    "BROWSE"
    "BUFFERS"
    "BY"
    "BYTE"
    "BYTES"
    "CACHE"
    "CALL"
    "CASCADE"
    "CASE"
    "CAST"
    "CHANGE"
    "CHANGES"
    "CHAR"
    "CHARACTER"
    "CHECKPOINT"
    "CLOSE"
    "COALESCE"
    "COLLATE"
    "COLUMN"
    "COLUMNS"
    "COMMENT"
    "COMMIT"
    "CONCURRENTLY"
    "CONFLICT"
    "CONNECT"
    "CONSTRAINTS"
    "CONVERT"
    "CORRESPONDING"
    "COSTS"
    "COUNT"
    "CREATE"
    "CS"
    "CYCLE"
    "DATA"
    "DATABASE"
    "DATETIME"
    "DBA_RECYCLEBIN"
    "DDL"
    "DECLARE"
    "DEFAULT"
    "DEFERRABLE"
    "DELAYED"
    "DELETE"
    "DESC"
    "DESCRIBE"
    "DISABLE"
    "DISCARD"
    "DISCONNECT"
    "DIV"
    "DML"
    "DO"
    "DOMAIN"
    "DROP"
    "DUMP"
    "DUPLICATE"
    "ELEMENTS"
    "EMIT"
    "ENABLE"
    "ENCRYPTION"
    "END"
    "ENFORCED"
    "ENGINE"
    "ERROR"
    "ESCAPE"
    "EXCHANGE"
    "EXCLUDE"
    "EXEC"
    "EXECUTE"
    "EXPLAIN"
    "EXPLICIT"
    "EXTENDED"
    "EXTRACT"
    "FILTER"
    "FIRST"
    "FLUSH"
    "FN"
    "FOLLOWING"
    "FORMAT"
    "FULLTEXT"
    "FUNCTION"
    "GRANT"
    "GROUP"
    "GROUP_CONCAT"
    "GUARD"
    "HASH"
    "HIGH"
    "HIGH_PRIORITY"
    "HISTORY"
    "HOPPING"
    "IGNORE"
    "IMPORT"
    "INCLUDE"
    "INCLUDE_NULL_VALUES"
    "INCREMENT"
    "INDEX"
    "INSERT"
    "INTERLEAVE"
    "INTERPRET"
    "INTERVAL"
    "INVALIDATE"
    "INVERSE"
    "INVISIBLE"
    "ISNULL"
    "JSON"
    "JSON_ARRAY"
    "JSON_ARRAYAGG"
    "JSON_OBJECT"
    "JSON_OBJECTAGG"
    "KEEP"
    "KEY"
    "KEYS"
    "KEY_BLOCK_SIZE"
    "LAST"
    "LEADING"
    "LESS"
    "LINK"
    "LOCAL"
    "LOCK"
    "LOCKED"
    "LOG"
    "LONGTEXT"
    "LOOP"
    "LOW"
    "LOW_PRIORITY"
    "MATCH"
    "MATCHED"
    "MATCH_ALL"
    "MATCH_ANY"
    "MATCH_PHRASE"
    "MATCH_PHRASE_PREFIX"
    "MATCH_REGEXP"
    "MATERIALIZED"
    "MAX"
    "MAXVALUE"
    "MEDIUMTEXT"
    "MEMBER"
    "MERGE"
    "MIN"
    "MINVALUE"
    "MODIFY"
    "MOVEMENT"
    "NAME"
    "NEXT"
    "NO"
    "NOCACHE"
    "NOKEEP"
    "NOLOCK"
    "NOMAXVALUE"
    "NOMINVALUE"
    "NOORDER"
    "NOTHING"
    "NOTNULL"
    "NOVALIDATE"
    "NOWAIT"
    "NULLS"
    "OF"
    "OFF"
    "ON"
    "OPEN"
    "ORDINALITY"
    "OVER"
    "OVERFLOW"
    "OVERLAPS"
    "OVERRIDING"
    "OVERWRITE"
    "PARALLEL"
    "PARENT"
    "PARSER"
    "PARTITION"
    "PARTITIONING"
    "PATH"
    "PERCENT"
    "PLACING"
    "PLAN"
    "PLUS"
    "PRECEDING"
    "PRIMARY"
    "PURGE"
    "QUALIFY"
    "QUERY"
    "QUICK"
    "QUIESCE"
    "RANGE"
    "RAW"
    "READ"
    "REBUILD"
    "RECURSIVE"
    "RECYCLEBIN"
    "REFERENCES"
    "REFRESH"
    "REGEXP"
    "REGEXP_LIKE"
    "REGISTER"
    "REMOTE"
    "REMOVE"
    "RENAME"
    "REORGANIZE"
    "REPAIR"
    "REPEATABLE"
    "REPLACE"
    "RESET"
    "RESPECT"
    "RESTART"
    "RESTRICT"
    "RESTRICTED"
    "RESUMABLE"
    "RESUME"
    "RETURN"
    "RLIKE"
    "ROLLBACK"
    "ROLLUP"
    "ROOT"
    "ROW"
    "ROWS"
    "RR"
    "RS"
    "SAFE_CAST"
    "SAVEPOINT"
    "SCHEMA"
    "SECURE"
    "SEED"
    "SEPARATOR"
    "SEQUENCE"
    "SESSION"
    "SETS"
    "SHARE"
    "SHOW"
    "SHUTDOWN"
    "SIBLINGS"
    "SIGNED"
    "SIMILAR"
    "SIZE"
    "SKIP"
    "SPATIAL"
    "START"
    "STORED"
    "STRICT"
    "STRING"
    "STRUCT"
    "SUMMARIZE"
    "SUSPEND"
    "SWITCH"
    "SYNONYM"
    "SYSTEM"
    "TABLE"
    "TABLES"
    "TABLESPACE"
    "TEMP"
    "TEMPORARY"
    "TEXT"
    "THAN"
    "THEN"
    "TIMEOUT"
    "TIMESTAMPTZ"
    "TIMEZONE"
    "TINYTEXT"
    "TO"
    "TOP"
    "TRIGGER"
    "TRUNCATE"
    "TRY_CAST"
    "TUMBLING"
    "TYPE"
    "UNLOGGED"
    "UNQIESCE"
    "UNSIGNED"
    "UPDATE"
    "UPSERT"
    "UR"
    "USER"
    "VALIDATE"
    "VALIDATION"
    "VALUE"
    "VALUES"
    "VERBOSE"
    "VIEW"
    "VISIBLE"
    "VOLATILE"
    "WAIT"
    "WITHIN"
    "WITHOUT"
    "WITHOUT_ARRAY_WRAPPER"
    "WORK"
    "XML"
    "XMLAGG"
    "XMLDATA"
    "XMLSCHEMA"
    "XMLTEXT"
    "XSINIL"
    "YAML"
    "YES"
    "ZONE"
    <DATA_TYPE>
    <K_DATETIMELITERAL>
    <K_DATE_LITERAL>
    <K_ISOLATION>
    <K_STRING_FUNCTION_NAME>
    <K_TEXT_LITERAL>
    <K_TIME_KEY_EXPR>
    <S_IDENTIFIER>
    <S_QUOTED_IDENTIFIER>

Error parsing: -- Erstelle zuerst eine Zwischentabelle wo gewisse Felder aufgetrennt worden
-- sind
WITH tabelle_projekte_projektnr_aufgetrennt AS (
    SELECT
        t_id,
        abteilung,
        kreis,
        projektleiter,
        gemeinde,
        strasse,
        projekt,
        -- Trenne mehrzeilige Projektnummer in einzelne Einträge auf, damit diese
        -- mit manuell erfassten Geometrien verknüpft werden können.
        regexp_split_to_table ( projektnr, '\n') AS projektnr,
        kreditjahr_p,
        kreditjahr_a,
        astart,
        ende,
        klasse,
        aphase,
        achsnr,
        bpanfang,
        bpende,
        bemerkungen,
        projektsuffix,
        ranfangsbezugspunkt,
        rendbezugspunkt
    FROM
        avt_mehrjahresplanung_v1.projekte_projekt
),
tabelle_projekte AS (
    SELECT
        t_id,
        abteilung,
        kreis,
        projektleiter,
        gemeinde,
        strasse,
        projekt,
        projektnr,
        kreditjahr_p,
        kreditjahr_a,
        astart,
        ende,
        klasse,
        aphase,
        achsnr,
        bpanfang,
        split_part(bpanfang, '+', 1) AS bpanfang_bezeichnung,
        CASE WHEN split_part(bpanfang, '+', 2) ILIKE '' THEN NULL
        ELSE split_part(bpanfang, '+', 2)
        END AS bpanfang_km,
        bpende,
        split_part(bpende, '+', 1) AS bpende_bezeichnung,
        CASE WHEN split_part(bpende, '+', 2) ILIKE '' THEN NULL
        ELSE split_part(bpende, '+', 2)
        END AS bpende_km,
        bemerkungen,
        projektsuffix,
        CASE
            WHEN projektsuffix IS NULL THEN projektnr
            ELSE projektnr || '.' || projektsuffix
        END AS projektidentifikation,
        ranfangsbezugspunkt,
        rendbezugspunkt
    FROM
        tabelle_projekte_projektnr_aufgetrennt
),


-- Wähle in höchster Priorität Projekte mit manueller erfasster Geometrie
projekte_mit_manuell_erfasster_geometrie AS (
    SELECT 
        pp.t_id,
        pp.abteilung,
        pp.kreis,
        pp.projektleiter,
        pp.gemeinde,
        pp.strasse,
        pp.projekt,
        pp.projektnr,
        pp.kreditjahr_p,
        pp.kreditjahr_a,
        pp.astart,
        pp.ende,
        pp.klasse,
        pp.aphase,
        pp.achsnr,
        pp.bpanfang,
        pp.bpende,
        pp.bemerkungen,
        pp.projektsuffix,
        pp.projektidentifikation,
        pp.ranfangsbezugspunkt,
        pp.rendbezugspunkt,
        pp2.geometrie,
        'manuell_erfasst' AS fall
    FROM
        tabelle_projekte pp 
    JOIN
        avt_mehrjahresplanung_v1.projekte_projektgeometrie pp2 
    ON
        pp.projektidentifikation = pp2.projektidentifikation
),



-- Wähle in zweiter Priorität Projekte welche an einer Achse (=Linestring) liegen
bppunkte_achsen AS (
    SELECT
        kb.t_id,
        kb.bezeichnung,
        kb.achsenummer,
        kb.geometrie,
        ka.geometrie AS linegeometrie,
        ka.t_id AS achsen_tid
    FROM
      avt_mehrjahresplanung_v1.kantonsstrassen_bezugspunkt kb 
    LEFT JOIN
       avt_mehrjahresplanung_v1.kantonsstrassen_achse ka 
    ON
        st_intersects(st_buffer(kb.geometrie,0.1), ka.geometrie) and kb.achsenummer like ka.achsenummer 
),
projekte_mit_achsen AS (
    select
        pp.t_id,
        pp.abteilung,
        pp.kreis,
        pp.projektleiter,
        pp.gemeinde,
        pp.strasse,
        pp.projekt,
        pp.projektnr,
        pp.kreditjahr_p,
        pp.kreditjahr_a,
        pp.astart,
        pp.ende,
        pp.klasse,
        pp.aphase,
        pp.achsnr,
        pp.bpanfang,
        pp.bpanfang_bezeichnung,
        pp.bpanfang_km,
        bpende,
        pp.bpende_bezeichnung,
        pp.bpende_km,
        pp.bemerkungen,
        pp.projektsuffix,
        pp.projektidentifikation,
        pp.ranfangsbezugspunkt,
        pp.rendbezugspunkt,
        bpa.geometrie AS bpanfang_geometrie,
        bpe.geometrie AS bpende_geometrie,
        bpa.linegeometrie AS achsengeometrie
    from 
        tabelle_projekte pp
    join
        bppunkte_achsen bpa
    on
        pp.ranfangsbezugspunkt = bpa.t_id
    join
        bppunkte_achsen bpe
    on
        pp.rendbezugspunkt = bpe.t_id
    where
        bpa.achsen_tid = bpe.achsen_tid
),
projekte_an_einer_achse AS (
    SELECT
        pma.t_id,
        pma.abteilung,
        pma.kreis,
        pma.projektleiter,
        pma.gemeinde,
        pma.strasse,
        pma.projekt,
        pma.projektnr,
        pma.kreditjahr_p,
        pma.kreditjahr_a,
        pma.astart,
        pma.ende,
        pma.klasse,
        pma.aphase,
        pma.achsnr,
        pma.bpanfang,
        pma.bpende,
        pma.bemerkungen,
        pma.projektsuffix,
        pma.projektidentifikation,
        pma.ranfangsbezugspunkt,
        pma.rendbezugspunkt,
        ST_Multi(ST_LineSubstring(
            pma.achsengeometrie,
            CASE WHEN pma.bpanfang_km IS NOT NULL THEN
                CASE WHEN (ST_LineLocatePoint(pma.achsengeometrie, bpanfang_geometrie) + (pma.bpanfang_km::INTEGER / ST_Length(pma.achsengeometrie))) <= 1.0 THEN
                    (ST_LineLocatePoint(pma.achsengeometrie, bpanfang_geometrie) + (pma.bpanfang_km::INTEGER / ST_Length(pma.achsengeometrie)))
                ELSE
                    1.0
                END
            ELSE
                ST_LineLocatePoint(pma.achsengeometrie, bpanfang_geometrie)
            END,
            CASE WHEN pma.bpende_km IS NOT NULL THEN
                CASE WHEN (ST_LineLocatePoint(pma.achsengeometrie, bpende_geometrie) + (pma.bpende_km::INTEGER / ST_Length(pma.achsengeometrie))) <= 1.0 THEN
                    (ST_LineLocatePoint(pma.achsengeometrie, bpende_geometrie) + (pma.bpende_km::INTEGER / ST_Length(pma.achsengeometrie)))
                ELSE
                    1.0
                END
            ELSE
                ST_LineLocatePoint(pma.achsengeometrie, bpende_geometrie)
            END
        )) AS geometrie,
        'an_einer_achse' AS fall
    FROM 
        projekte_mit_achsen pma
    WHERE
        pma.projektidentifikation NOT IN (SELECT projektidentifikation FROM projekte_mit_manuell_erfasster_geometrie)
),



-- Wähle in dritter Priorität Projekte welcher an mehreren Achsen liegen, welche
-- aber gemergt werden können
merged_ktstrassen AS (
    SELECT
        achsenummer,
        geometrie
    FROM (
        SELECT
            achsenummer::INTEGER,
            ST_LineMerge(ST_Union(geometrie)) AS geometrie
        FROM
            avt_mehrjahresplanung_v1.kantonsstrASsen_achse ka 
        GROUP BY
            achsenummer
    ) AS t
    WHERE GeometryType(t.geometrie) like 'LINESTRING'
),
projekte_an_mehreren_achsen AS (
    SELECT 
        pp.t_id,
        pp.abteilung,
        pp.kreis,
        pp.projektleiter,
        pp.gemeinde,
        pp.strasse,
        pp.projekt,
        pp.projektnr,
        pp.kreditjahr_p,
        pp.kreditjahr_a,
        pp.astart,
        pp.ende,
        pp.klasse,
        pp.aphase,
        pp.achsnr,
        pp.bpanfang,
        pp.bpende,
        pp.bemerkungen,
        pp.projektsuffix,
        pp.projektidentifikation,
        pp.ranfangsbezugspunkt,
        pp.rendbezugspunkt,
        ST_Multi(ST_LineSubstring(
            ka.geometrie,
            CASE WHEN pp.bpanfang_km IS NOT NULL THEN
                CASE WHEN (ST_LineLocatePoint(ka.geometrie, kb.geometrie) + (pp.bpanfang_km::INTEGER / ST_Length(ka.geometrie))) <= 1.0 THEN
                    (ST_LineLocatePoint(ka.geometrie, kb.geometrie) + (pp.bpanfang_km::INTEGER / ST_Length(ka.geometrie)))
                ELSE
                    1.0
                END
            ELSE
                ST_LineLocatePoint(ka.geometrie, kb.geometrie)
            END,
            CASE WHEN pp.bpende_km IS NOT NULL THEN
                CASE WHEN (ST_LineLocatePoint(ka.geometrie, kc.geometrie) + (pp.bpende_km::INTEGER / ST_Length(ka.geometrie))) <= 1.0 THEN
                    (ST_LineLocatePoint(ka.geometrie, kc.geometrie) + (pp.bpende_km::INTEGER / ST_Length(ka.geometrie)))
                ELSE
                    1.0
                END
            ELSE
                ST_LineLocatePoint(ka.geometrie, kc.geometrie)
            END
        )) AS geometrie,
        'an_mehreren_achsen' AS fall
    FROM
        tabelle_projekte pp 
    JOIN
        merged_ktstrassen ka
    ON
        pp.achsnr = ka.achsenummer
    JOIN 
        avt_mehrjahresplanung_v1.kantonsstrassen_bezugspunkt kb 
    ON
        pp.ranfangsbezugspunkt = kb.t_id
    JOIN 
        avt_mehrjahresplanung_v1.kantonsstrassen_bezugspunkt kc 
    ON
        pp.rendbezugspunkt = kc.t_id
    WHERE
        pp.projektidentifikation NOT IN (SELECT projektidentifikation FROM projekte_mit_manuell_erfasster_geometrie)
    AND
        pp.projektidentifikation NOT IN (SELECT projektidentifikation FROM projekte_an_einer_achse)
),


-- Für die restlichen Projekte zeichne eine gerade Linie vom Anfangsbezugpunkt
-- zum Endbezugspunkt
projekte_mit_direkter_linie AS (
    SELECT 
        pp.t_id,
        pp.abteilung,
        pp.kreis,
        pp.projektleiter,
        pp.gemeinde,
        pp.strasse,
        pp.projekt,
        pp.projektnr,
        pp.kreditjahr_p,
        pp.kreditjahr_a,
        pp.astart,
        pp.ende,
        pp.klasse,
        pp.aphase,
        pp.achsnr,
        pp.bpanfang,
        pp.bpende,
        pp.bemerkungen,
        pp.projektsuffix,
        pp.projektidentifikation,
        pp.ranfangsbezugspunkt,
        pp.rendbezugspunkt,
        ST_Multi(ST_MakeLine(kb.geometrie, kb2.geometrie)) as geometrie,
        'direkte_linie' AS fall
    FROM 
        tabelle_projekte pp 
    JOIN
        avt_mehrjahresplanung_v1.kantonsstrassen_bezugspunkt kb 
    ON
        pp.ranfangsbezugspunkt = kb.t_id
    JOIN
        avt_mehrjahresplanung_v1.kantonsstrassen_bezugspunkt kb2 
    ON
        pp.rendbezugspunkt = kb2.t_id
    WHERE
        pp.projektidentifikation NOT IN (SELECT projektidentifikation FROM projekte_mit_manuell_erfasster_geometrie)
    AND
        pp.projektidentifikation NOT IN (SELECT projektidentifikation FROM projekte_an_einer_achse)
    AND
        pp.projektidentifikation NOT IN (SELECT projektidentifikation FROM projekte_an_mehreren_achsen)
)

SELECT
    abteilung,
    kreis,
    projektleiter,
    gemeinde,
    strasse,
    projekt,
    projektnr,
    kreditjahr_p,
    kreditjahr_a,
    astart,
    ende,
    klasse,
    aphase,
    achsnr,
    bpanfang,
    bpende,
    bemerkungen,
    projektsuffix,
    geometrie
FROM
    projekte_mit_manuell_erfasster_geometrie
UNION
SELECT
    abteilung,
    kreis,
    projektleiter,
    gemeinde,
    strasse,
    projekt,
    projektnr,
    kreditjahr_p,
    kreditjahr_a,
    astart,
    ende,
    klasse,
    aphase,
    achsnr,
    bpanfang,
    bpende,
    bemerkungen,
    projektsuffix,
    geometrie
FROM
    projekte_an_einer_achse
UNION
SELECT
    abteilung,
    kreis,
    projektleiter,
    gemeinde,
    strasse,
    projekt,
    projektnr,
    kreditjahr_p,
    kreditjahr_a,
    astart,
    ende,
    klasse,
    aphase,
    achsnr,
    bpanfang,
    bpende,
    bemerkungen,
    projektsuffix,
    geometrie
FROM
    projekte_an_mehreren_achsen
UNION
SELECT
    abteilung,
    kreis,
    projektleiter,
    gemeinde,
    strasse,
    projekt,
    projektnr,
    kreditjahr_p,
    kreditjahr_a,
    astart,
    ende,
    klasse,
    aphase,
    achsnr,
    bpanfang,
    bpende,
    bemerkungen,
    projektsuffix,
    geometrie
FROM
    projekte_mit_direkter_linie (net.sf.jsqlparser.parser.ParseException: Encountered unexpected token: "\n\n\n" <ST_SEMICOLON>
    at line 68, column 3.

Was expecting one of:

    "ACTION"
    "ACTIVE"
    "ADD"
    "ADVANCE"
    "ADVISE"
    "AGAINST"
    "AGGREGATE"
    "ALGORITHM"
    "ALTER"
    "ANALYZE"
    "APPLY"
    "APPROXIMATE"
    "ARCHIVE"
    "ARRAY"
    "ASC"
    "AT"
    "AUTHORIZATION"
    "AUTO"
    "AUTO_INCREMENT"
    "BASE64"
    "BEGIN"
    "BERNOULLI"
    "BINARY"
    "BIT"
    "BLOCK"
    "BROWSE"
    "BUFFERS"
    "BY"
    "BYTE"
    "BYTES"
    "CACHE"
    "CALL"
    "CASCADE"
    "CASE"
    "CAST"
    "CHANGE"
    "CHANGES"
    "CHAR"
    "CHARACTER"
    "CHECKPOINT"
    "CLOSE"
    "COALESCE"
    "COLLATE"
    "COLUMN"
    "COLUMNS"
    "COMMENT"
    "COMMIT"
    "CONCURRENTLY"
    "CONFLICT"
    "CONNECT"
    "CONSTRAINTS"
    "CONVERT"
    "CORRESPONDING"
    "COSTS"
    "COUNT"
    "CREATE"
    "CS"
    "CYCLE"
    "DATA"
    "DATABASE"
    "DATETIME"
    "DBA_RECYCLEBIN"
    "DDL"
    "DECLARE"
    "DEFAULT"
    "DEFERRABLE"
    "DELAYED"
    "DELETE"
    "DESC"
    "DESCRIBE"
    "DISABLE"
    "DISCARD"
    "DISCONNECT"
    "DIV"
    "DML"
    "DO"
    "DOMAIN"
    "DROP"
    "DUMP"
    "DUPLICATE"
    "ELEMENTS"
    "EMIT"
    "ENABLE"
    "ENCRYPTION"
    "END"
    "ENFORCED"
    "ENGINE"
    "ERROR"
    "ESCAPE"
    "EXCHANGE"
    "EXCLUDE"
    "EXEC"
    "EXECUTE"
    "EXPLAIN"
    "EXPLICIT"
    "EXTENDED"
    "EXTRACT"
    "FILTER"
    "FIRST"
    "FLUSH"
    "FN"
    "FOLLOWING"
    "FORMAT"
    "FULLTEXT"
    "FUNCTION"
    "GRANT"
    "GROUP"
    "GROUP_CONCAT"
    "GUARD"
    "HASH"
    "HIGH"
    "HIGH_PRIORITY"
    "HISTORY"
    "HOPPING"
    "IGNORE"
    "IMPORT"
    "INCLUDE"
    "INCLUDE_NULL_VALUES"
    "INCREMENT"
    "INDEX"
    "INSERT"
    "INTERLEAVE"
    "INTERPRET"
    "INTERVAL"
    "INVALIDATE"
    "INVERSE"
    "INVISIBLE"
    "ISNULL"
    "JSON"
    "JSON_ARRAY"
    "JSON_ARRAYAGG"
    "JSON_OBJECT"
    "JSON_OBJECTAGG"
    "KEEP"
    "KEY"
    "KEYS"
    "KEY_BLOCK_SIZE"
    "LAST"
    "LEADING"
    "LESS"
    "LINK"
    "LOCAL"
    "LOCK"
    "LOCKED"
    "LOG"
    "LONGTEXT"
    "LOOP"
    "LOW"
    "LOW_PRIORITY"
    "MATCH"
    "MATCHED"
    "MATCH_ALL"
    "MATCH_ANY"
    "MATCH_PHRASE"
    "MATCH_PHRASE_PREFIX"
    "MATCH_REGEXP"
    "MATERIALIZED"
    "MAX"
    "MAXVALUE"
    "MEDIUMTEXT"
    "MEMBER"
    "MERGE"
    "MIN"
    "MINVALUE"
    "MODIFY"
    "MOVEMENT"
    "NAME"
    "NEXT"
    "NO"
    "NOCACHE"
    "NOKEEP"
    "NOLOCK"
    "NOMAXVALUE"
    "NOMINVALUE"
    "NOORDER"
    "NOTHING"
    "NOTNULL"
    "NOVALIDATE"
    "NOWAIT"
    "NULLS"
    "OF"
    "OFF"
    "ON"
    "OPEN"
    "ORDINALITY"
    "OVER"
    "OVERFLOW"
    "OVERLAPS"
    "OVERRIDING"
    "OVERWRITE"
    "PARALLEL"
    "PARENT"
    "PARSER"
    "PARTITION"
    "PARTITIONING"
    "PATH"
    "PERCENT"
    "PLACING"
    "PLAN"
    "PLUS"
    "PRECEDING"
    "PRIMARY"
    "PURGE"
    "QUALIFY"
    "QUERY"
    "QUICK"
    "QUIESCE"
    "RANGE"
    "RAW"
    "READ"
    "REBUILD"
    "RECURSIVE"
    "RECYCLEBIN"
    "REFERENCES"
    "REFRESH"
    "REGEXP"
    "REGEXP_LIKE"
    "REGISTER"
    "REMOTE"
    "REMOVE"
    "RENAME"
    "REORGANIZE"
    "REPAIR"
    "REPEATABLE"
    "REPLACE"
    "RESET"
    "RESPECT"
    "RESTART"
    "RESTRICT"
    "RESTRICTED"
    "RESUMABLE"
    "RESUME"
    "RETURN"
    "RLIKE"
    "ROLLBACK"
    "ROLLUP"
    "ROOT"
    "ROW"
    "ROWS"
    "RR"
    "RS"
    "SAFE_CAST"
    "SAVEPOINT"
    "SCHEMA"
    "SECURE"
    "SEED"
    "SEPARATOR"
    "SEQUENCE"
    "SESSION"
    "SETS"
    "SHARE"
    "SHOW"
    "SHUTDOWN"
    "SIBLINGS"
    "SIGNED"
    "SIMILAR"
    "SIZE"
    "SKIP"
    "SPATIAL"
    "START"
    "STORED"
    "STRICT"
    "STRING"
    "STRUCT"
    "SUMMARIZE"
    "SUSPEND"
    "SWITCH"
    "SYNONYM"
    "SYSTEM"
    "TABLE"
    "TABLES"
    "TABLESPACE"
    "TEMP"
    "TEMPORARY"
    "TEXT"
    "THAN"
    "THEN"
    "TIMEOUT"
    "TIMESTAMPTZ"
    "TIMEZONE"
    "TINYTEXT"
    "TO"
    "TOP"
    "TRIGGER"
    "TRUNCATE"
    "TRY_CAST"
    "TUMBLING"
    "TYPE"
    "UNLOGGED"
    "UNQIESCE"
    "UNSIGNED"
    "UPDATE"
    "UPSERT"
    "UR"
    "USER"
    "VALIDATE"
    "VALIDATION"
    "VALUE"
    "VALUES"
    "VERBOSE"
    "VIEW"
    "VISIBLE"
    "VOLATILE"
    "WAIT"
    "WITHIN"
    "WITHOUT"
    "WITHOUT_ARRAY_WRAPPER"
    "WORK"
    "XML"
    "XMLAGG"
    "XMLDATA"
    "XMLSCHEMA"
    "XMLTEXT"
    "XSINIL"
    "YAML"
    "YES"
    "ZONE"
    <DATA_TYPE>
    <K_DATETIMELITERAL>
    <K_DATE_LITERAL>
    <K_ISOLATION>
    <K_STRING_FUNCTION_NAME>
    <K_TEXT_LITERAL>
    <K_TIME_KEY_EXPR>
    <S_IDENTIFIER>
    <S_QUOTED_IDENTIFIER>
)
********************************************************************************
--------------------------------------------------------------------------------
avt_mehrjahresplanung_pub/select_bezugspunkte.sql
--------------------------------------------------------------------------------
avt_mehrjahresplanung_pub/update_projekt.sql
--------------------------------------------------------------------------------
avt_mehrjahresplanung_pub/select_achsen.sql
--------------------------------------------------------------------------------
avt_mehrjahresplanung_pub/delete_projekte.sql
--------------------------------------------------------------------------------
avt_mehrjahresplanung_pub/update_projektgeometrie.sql
--------------------------------------------------------------------------------
amb_zivilschutz_adressen_export/amb_zivilschutz_adressen_staging_adressen_zivilschutz.sql
class net.sf.jsqlparser.JSQLParserException
net.sf.jsqlparser.parser.ParseException: Encountered unexpected token:<EOF>
    at line 1, column 37.

Was expecting one of:

    "("
    "ALTER"
    "ANALYZE"
    "BEGIN"
    "CALL"
    "COMMENT"
    "COMMIT"
    "CREATE"
    "DECLARE"
    "DELETE"
    "DESC"
    "DESCRIBE"
    "DROP"
    "EXEC"
    "EXECUTE"
    "EXPLAIN"
    "FROM"
    "GRANT"
    "IF"
    "INSERT"
    "MERGE"
    "PURGE"
    "REFRESH"
    "RENAME"
    "REPLACE"
    "RESET"
    "ROLLBACK"
    "SAVEPOINT"
    "SET"
    "SHOW"
    "SUMMARIZE"
    "TABLE"
    "TRUNCATE"
    "UPDATE"
    "UPSERT"
    "USE"
    "VALUE"
    "VALUES"
    "WITH"
    <K_SELECT>

Error parsing: --Adresse für das Projekt Zivilschutz (net.sf.jsqlparser.parser.ParseException: Encountered unexpected token:<EOF>
    at line 1, column 37.

Was expecting one of:

    "("
    "ALTER"
    "ANALYZE"
    "BEGIN"
    "CALL"
    "COMMENT"
    "COMMIT"
    "CREATE"
    "DECLARE"
    "DELETE"
    "DESC"
    "DESCRIBE"
    "DROP"
    "EXEC"
    "EXECUTE"
    "EXPLAIN"
    "FROM"
    "GRANT"
    "IF"
    "INSERT"
    "MERGE"
    "PURGE"
    "REFRESH"
    "RENAME"
    "REPLACE"
    "RESET"
    "ROLLBACK"
    "SAVEPOINT"
    "SET"
    "SHOW"
    "SUMMARIZE"
    "TABLE"
    "TRUNCATE"
    "UPDATE"
    "UPSERT"
    "USE"
    "VALUE"
    "VALUES"
    "WITH"
    <K_SELECT>
)
********************************************************************************
class net.sf.jsqlparser.JSQLParserException
net.sf.jsqlparser.parser.ParseException: Encountered unexpected token: "f\u00fcr" <S_IDENTIFIER>
    at line 1, column 1.

Was expecting one of:

    "("
    "ALTER"
    "ANALYZE"
    "BEGIN"
    "CALL"
    "COMMENT"
    "COMMIT"
    "CREATE"
    "DECLARE"
    "DELETE"
    "DESC"
    "DESCRIBE"
    "DROP"
    "EXEC"
    "EXECUTE"
    "EXPLAIN"
    "FROM"
    "GRANT"
    "IF"
    "INSERT"
    "MERGE"
    "PURGE"
    "REFRESH"
    "RENAME"
    "REPLACE"
    "RESET"
    "ROLLBACK"
    "SAVEPOINT"
    "SET"
    "SHOW"
    "SUMMARIZE"
    "TABLE"
    "TRUNCATE"
    "UPDATE"
    "UPSERT"
    "USE"
    "VALUE"
    "VALUES"
    "WITH"
    <K_SELECT>

Error parsing: für Frima Om Computer
WITH
adressenZusammenfuehren AS (
    SELECT
        DISTINCT ON (a.strassenname, a.nummer, a.ortschaft) -- in Tabelle adressen.adressen gibt es doppelte Adresse wegen EO.Flaechenelement
        a.t_id,
        a.strassenname AS lokalisationsname,
        a.nummer as hausnummer,
        a.plz4 AS plz,
        a.ortschaft,
        g.gemeindename AS gemeinde,
        a.egid AS gwr_egid,
        a.edid AS gwr_edid,
        ST_X(a.geometrie) AS koord_ost,
        st_y(a.geometrie) AS koord_nord,
        a.astatus,
        b.geometrie AS gwr_egid_geom,
        a.geometrie AS gwr_edid_geom,
        a.bfsnr
    FROM
        agi_swisstopo_gebaeudeadressen_pub_v1.gebaeudeadressen_adresse AS a
    LEFT JOIN agi_mopublic_pub.mopublic_bodenbedeckung AS b
        ON 
        a.geometrie && b.geometrie
        AND
        st_distance(a.geometrie, b.geometrie) = 0
    LEFT JOIN agi_mopublic_pub.mopublic_gemeindegrenze AS g
        ON a.bfsnr::int = g.bfs_nr
    WHERE
        a.nummer IS NOT NULL -- nur die mit Hausnummern
    AND
        b.art_txt = 'Gebaeude'
UNION ALL
        SELECT
        DISTINCT ON (a.strassenname, a.nummer, a.ortschaft) -- in Tabelle adressen.adressen gibt es doppelte Adresse wegen EO.Flaechenelement
        a.t_id,
        a.strassenname AS lokalisationsname,
        a.nummer as hausnummer,
        a.plz4 AS plz,
        a.ortschaft,
        g.gemeindename AS gemeinde,
        a.egid AS gwr_egid,
        a.edid AS gwr_edid,
        ST_X(a.geometrie) AS koord_ost,
        st_y(a.geometrie) AS koord_nord,
        a.astatus,
        b.geometrie AS gwr_egid_geom,
        a.geometrie AS gwr_edid_geom,
        a.bfsnr
    FROM
        agi_swisstopo_gebaeudeadressen_pub_v1.gebaeudeadressen_adresse AS a
    LEFT JOIN agi_mopublic_pub.mopublic_bodenbedeckung_proj AS b
        ON 
        a.geometrie && b.geometrie
        AND
        st_distance(a.geometrie, b.geometrie) = 0
    LEFT JOIN agi_mopublic_pub.mopublic_gemeindegrenze AS g
        ON a.bfsnr::int = g.bfs_nr
    WHERE
        a.nummer IS NOT NULL -- nur die mit Hausnummern
    AND
        b.art_txt = 'Gebaeude'
UNION ALL
        SELECT
        DISTINCT ON (a.strassenname, a.nummer, a.ortschaft) -- in Tabelle adressen.adressen gibt es doppelte Adresse wegen EO.Flaechenelement
        a.t_id,
        a.strassenname AS lokalisationsname,
        a.nummer as hausnummer,
        a.plz4 AS plz,
        a.ortschaft,
        g.gemeindename AS gemeinde,
        a.egid AS gwr_egid,
        a.edid AS gwr_edid,
        ST_X(a.geometrie) AS koord_ost,
        st_y(a.geometrie) AS koord_nord,
        a.astatus,
        b.geometrie AS gwr_egid_geom,
        a.geometrie AS gwr_edid_geom,
        a.bfsnr
    FROM
        agi_swisstopo_gebaeudeadressen_pub_v1.gebaeudeadressen_adresse AS a
    LEFT JOIN agi_mopublic_pub.mopublic_einzelobjekt_flaeche AS b
        ON 
        a.geometrie && b.geometrie
        AND
        st_distance(a.geometrie, b.geometrie) = 0
    LEFT JOIN agi_mopublic_pub.mopublic_gemeindegrenze AS g
        ON a.bfsnr::int = g.bfs_nr
    WHERE
        a.nummer IS NOT NULL -- nur die mit Hausnummern
    AND
        b.art_txt = 'Unterstand' OR b.art_txt = 'unterirdisches_Gebaeude'
UNION ALL
    SELECT
        DISTINCT ON (a.strassenname, a.hausnummer, a.ortschaft) -- Adressen BB
        a.t_id,
        a.strassenname AS lokalisationsname,
        a.hausnummer,
        a.plz,
        a.ortschaft,
        g.gemeindename AS gemeinde,
        a.egid AS gwr_egid,
        a.edid AS gwr_edid,
        ST_X(a.lage) AS koord_ost,
        st_y(a.lage) AS koord_nord,
        a.astatus,
        b.geometrie AS gwr_egid_geom,
        a.lage AS gwr_edid_geom,
        CAST(a.bfs_nr AS varchar(20)) AS bfs_nr
    FROM
        agi_mopublic_pub.mopublic_gebaeudeadresse AS a
    LEFT JOIN agi_mopublic_pub.mopublic_bodenbedeckung AS b
        ON 
        a.lage && b.geometrie
        AND
        st_distance(a.lage, b.geometrie) = 0
    LEFT JOIN agi_mopublic_pub.mopublic_gemeindegrenze AS g
        ON a.bfs_nr::int = g.bfs_nr
    WHERE
        a.hausnummer IS NOT NULL -- nur die mit Hausnummern
    AND
        b.art_txt = 'Gebaeude' AND a.egid IS NULL
UNION ALL
    SELECT
        DISTINCT ON (a.strassenname, a.hausnummer, a.ortschaft) -- Adressen Pro BB
        a.t_id,
        a.strassenname AS lokalisationsname,
        a.hausnummer,
        a.plz,
        a.ortschaft,
        g.gemeindename AS gemeinde,
        a.egid AS gwr_egid,
        a.edid AS gwr_edid,
        ST_X(a.lage) AS koord_ost,
        st_y(a.lage) AS koord_nord,
        a.astatus,
        b.geometrie AS gwr_egid_geom,
        a.lage AS gwr_edid_geom,
        CAST(a.bfs_nr AS varchar(20)) AS bfs_nr
    FROM
        agi_mopublic_pub.mopublic_gebaeudeadresse AS a
    LEFT JOIN agi_mopublic_pub.mopublic_bodenbedeckung_proj AS b
        ON 
        a.lage && b.geometrie
        AND
        st_distance(a.lage, b.geometrie) = 0
    LEFT JOIN agi_mopublic_pub.mopublic_gemeindegrenze AS g
        ON a.bfs_nr::int = g.bfs_nr
    WHERE
        a.hausnummer IS NOT NULL -- nur die mit Hausnummern
    AND
        b.art_txt = 'Gebaeude' AND a.egid IS NULL
UNION ALL
    SELECT
        DISTINCT ON (a.strassenname, a.hausnummer, a.ortschaft) --Adresse EO.Flaechenelement
        a.t_id,
        a.strassenname AS lokalisationsname,
        a.hausnummer,
        a.plz,
        a.ortschaft,
        g.gemeindename AS gemeinde,
        a.egid AS gwr_egid,
        a.edid AS gwr_edid,
        ST_X(a.lage) AS koord_ost,
        st_y(a.lage) AS koord_nord,
        a.astatus,
        b.geometrie AS gwr_egid_geom,
        a.lage AS gwr_edid_geom,
        CAST(a.bfs_nr AS varchar(20)) AS bfs_nr
    FROM
        agi_mopublic_pub.mopublic_gebaeudeadresse AS a
    LEFT JOIN agi_mopublic_pub.mopublic_einzelobjekt_flaeche AS b
        ON 
        a.lage && b.geometrie
        AND
        st_distance(a.lage, b.geometrie) = 0
    LEFT JOIN agi_mopublic_pub.mopublic_gemeindegrenze AS g
        ON a.bfs_nr::int = g.bfs_nr
    WHERE
        a.hausnummer IS NOT NULL -- nur die mit Hausnummern
    AND
        (b.art_txt = 'Unterstand' OR b.art_txt = 'unterirdisches_Gebaeude') AND a.egid IS NULL
),
adressen AS (
    SELECT
        DISTINCT ON (lokalisationsname, hausnummer, ortschaft) -- in Tabelle adressen.adressen gibt es doppelte Adresse wegen EO.Flaechenelement
        t_id,
        lokalisationsname,
        hausnummer,
        plz,
        ortschaft,
        gemeinde,
        gwr_egid,
        gwr_edid,
        koord_ost,
        koord_nord,
        astatus,
        gwr_egid_geom,
        gwr_edid_geom,
        bfsnr
    FROM
        adressenZusammenfuehren
),
grundstueck AS (
    SELECT
        ls.nummer AS grundstuecknummer,
        ls.geometrie,
        g.aname AS grundbuchkreis,
        ls.bfs_nr
    FROM
        agi_mopublic_pub.mopublic_grundstueck AS ls
    LEFT JOIN agi_av_gb_admin_einteilung_pub.grundbuchkreise_grundbuchkreis AS g
        ON g.nbident = ls.nbident
    WHERE ls.art_txt = 'Liegenschaft'
),
geb_objektnamen AS (
    SELECT
        a.t_id,
        STRING_AGG(o.objektname, ', ') AS objektname -- mehrere Objektnamen pro BB.Gebäude möglich
    FROM adressen AS a
    JOIN
        agi_mopublic_pub.mopublic_objektname_pos AS o 
        ON 
        o.pos && a.gwr_egid_geom
        AND
        st_distance(o.pos, a.gwr_egid_geom) = 0
    GROUP BY
        a.t_id
)

INSERT INTO amb_zivilschutz_adressen_staging_pub.adressen_zivilschutz (lokalisationsname,hausnummer,plz,ortschaft,gemeinde,gwr_egid,gwr_edid,koord_ost,koord_nord,astatus,objektname,grundstuecknummer,grundbuchkreis)
(
    SELECT
        a.lokalisationsname,
        a.hausnummer,
        a.plz,
        a.ortschaft,
        a.gemeinde,
        a.gwr_egid,
        a.gwr_edid,
        a.koord_ost,
        a.koord_nord,
        a.astatus,
        o.objektname,
        g.grundstuecknummer,
        g.grundbuchkreis
    FROM
        adressen AS a
        LEFT JOIN
        geb_objektnamen AS o
        ON a.t_id = o.t_id,
        grundstueck AS g
    WHERE
        a.gwr_edid_geom && g.geometrie
        AND
        st_distance(a.gwr_edid_geom, g.geometrie) = 0
        AND
        a.bfsnr::int = g.bfs_nr
) (net.sf.jsqlparser.parser.ParseException: Encountered unexpected token: "f\u00fcr" <S_IDENTIFIER>
    at line 1, column 1.

Was expecting one of:

    "("
    "ALTER"
    "ANALYZE"
    "BEGIN"
    "CALL"
    "COMMENT"
    "COMMIT"
    "CREATE"
    "DECLARE"
    "DELETE"
    "DESC"
    "DESCRIBE"
    "DROP"
    "EXEC"
    "EXECUTE"
    "EXPLAIN"
    "FROM"
    "GRANT"
    "IF"
    "INSERT"
    "MERGE"
    "PURGE"
    "REFRESH"
    "RENAME"
    "REPLACE"
    "RESET"
    "ROLLBACK"
    "SAVEPOINT"
    "SET"
    "SHOW"
    "SUMMARIZE"
    "TABLE"
    "TRUNCATE"
    "UPDATE"
    "UPSERT"
    "USE"
    "VALUE"
    "VALUES"
    "WITH"
    <K_SELECT>
)
********************************************************************************
--------------------------------------------------------------------------------
amb_zivilschutz_adressen_export/amb_zivilschutz_adressen_staging_adressen_zivilschutz_delete.sql
--------------------------------------------------------------------------------
afu_stehende_gewaesser_pub/afu_stehendes_gewaesser_pub.sql
--------------------------------------------------------------------------------
afu_qrcat_berechnungen/toxisch_unguenstigste_sektoren.sql
--------------------------------------------------------------------------------
afu_qrcat_berechnungen/letalflaechen.sql
--------------------------------------------------------------------------------
dsbjd_pikettregionen_militaerjustiz/dsbjd_pikettregionen_militaerjustiz_pub.sql
--------------------------------------------------------------------------------
ada_archaeologie_pub/update_relation/unlink_geomless_rrb.sql
--------------------------------------------------------------------------------
ada_archaeologie_pub/update_relation/delete_unlinked_rrb.sql
--------------------------------------------------------------------------------
ada_archaeologie_pub/update_relation/fst_rrb.sql
--------------------------------------------------------------------------------
ada_archaeologie_pub/update_relation/attr_geo.sql
--------------------------------------------------------------------------------
ada_archaeologie_pub/public/flaeche_delete.sql
--------------------------------------------------------------------------------
ada_archaeologie_pub/public/punkt_insert.sql
--------------------------------------------------------------------------------
ada_archaeologie_pub/public/punkt_delete.sql
--------------------------------------------------------------------------------
ada_archaeologie_pub/public/flaeche_insert.sql
--------------------------------------------------------------------------------
ada_archaeologie_pub/to_pub_db/punkt.sql
class net.sf.jsqlparser.JSQLParserException
net.sf.jsqlparser.parser.ParseException: Encountered unexpected token: "(" "("
    at line 11, column 14.

Was expecting one of:

    <EOF>
    <ST_SEMICOLON>

Error parsing: SELECT
    f.fundstellen_nummer, 
    f.x_koordinate,
    f.y_koordinate,
    fundst_adresse_flurname, 
    fundstellen_art, 
    CAST(geschuetzt as boolean) as geschuetzt, 
    geschuetzt::varchar as geschuetzt_txt, -- Attribut wird von schema-job angelegt. Setzen auf dummy-wert.
    qualitaet_lokalisierung, 
    qualitaet_lokalisierung as qualitaet_lokalisierung_txt,
    substring(kurzbeschreibung FOR 3000) as kurzbeschreibung, 
    gemeindename_ablage, 
    rrb_nummer,
    public.ST_Point(x_koordinate::float, y_koordinate::float) AS punkt
FROM 
    ada_archaeologie_v1.fachapplikation_fundstelle f
LEFT JOIN 
    ada_archaeologie_v1.geo_flaeche g ON f.t_id = g.fundstelle_role 
WHERE 
    g.t_id IS NULL (net.sf.jsqlparser.parser.ParseException: Encountered unexpected token: "(" "("
    at line 11, column 14.

Was expecting one of:

    <EOF>
    <ST_SEMICOLON>
)
********************************************************************************
--------------------------------------------------------------------------------
ada_archaeologie_pub/to_pub_db/ablage_gemeinde.sql
--------------------------------------------------------------------------------
ada_archaeologie_pub/to_pub_db/schutzbereich.sql
--------------------------------------------------------------------------------
ada_archaeologie_pub/to_pub_db/flaeche.sql
class net.sf.jsqlparser.JSQLParserException
net.sf.jsqlparser.parser.ParseException: Encountered unexpected token: "(" "("
    at line 11, column 14.

Was expecting one of:

    <EOF>
    <ST_SEMICOLON>

Error parsing: SELECT
    f.fundstellen_nummer, 
    f.x_koordinate,
    f.y_koordinate,
    fundst_adresse_flurname, 
    fundstellen_art, 
    CAST(geschuetzt as boolean) as geschuetzt, 
    geschuetzt::varchar as geschuetzt_txt, -- Attribut wird von schema-job angelegt. Setzen auf dummy-wert.
    qualitaet_lokalisierung, 
    qualitaet_lokalisierung as qualitaet_lokalisierung_txt,
    substring(kurzbeschreibung FOR 3000) as kurzbeschreibung, 
    gemeindename_ablage, 
    rrb_nummer,
    g.amultipolygon 
FROM 
    ada_archaeologie_v1.geo_flaeche g
JOIN
    ada_archaeologie_v1.fachapplikation_fundstelle f ON g.fundstelle_role = f.t_id 
WHERE 
    oereb_flaeche IS FALSE (net.sf.jsqlparser.parser.ParseException: Encountered unexpected token: "(" "("
    at line 11, column 14.

Was expecting one of:

    <EOF>
    <ST_SEMICOLON>
)
********************************************************************************
--------------------------------------------------------------------------------
ada_archaeologie_pub/import/fundstelle.sql
--------------------------------------------------------------------------------
ada_archaeologie_pub/import/rrb.sql
--------------------------------------------------------------------------------
ada_archaeologie_pub/enum_txt/update_txt.sql
class java.lang.ClassCastException
class net.sf.jsqlparser.statement.update.ParenthesedUpdate cannot be cast to class net.sf.jsqlparser.statement.select.ParenthesedSelect (net.sf.jsqlparser.statement.update.ParenthesedUpdate and net.sf.jsqlparser.statement.select.ParenthesedSelect are in unnamed module of loader 'app')
Error parsing: WITH 

enum_map AS (
    SELECT 
        ilicode AS enum_val,
        dispname AS enum_display
    FROM
        ada_archaeologie_pub_v1.public_qualitaet_lokalisierung_typ
),

upd_punkt_restr AS (
    UPDATE 
        ada_archaeologie_pub_v1.restricted_punktfundstelle
    SET 
        qualitaet_lokalisierung_txt = enum_display
    FROM
        enum_map m
    WHERE 
        enum_val = qualitaet_lokalisierung
),

upd_punkt_public AS (
    UPDATE 
        ada_archaeologie_pub_v1.public_punktfundstelle_siedlungsgebiet
    SET 
        qualitaet_lokalisierung_txt = enum_display
    FROM
        enum_map m
    WHERE 
        enum_val = qualitaet_lokalisierung
),

upd_flaeche_restr AS (
    UPDATE 
        ada_archaeologie_pub_v1.restricted_flaechenfundstelle
    SET 
        qualitaet_lokalisierung_txt = enum_display
    FROM
        enum_map m
    WHERE 
        enum_val = qualitaet_lokalisierung
)

-- upd_flaeche_public
UPDATE 
    ada_archaeologie_pub_v1.public_flaechenfundstelle_siedlungsgebiet
SET 
    qualitaet_lokalisierung_txt = enum_display
FROM
    enum_map m
WHERE 
    enum_val = qualitaet_lokalisierung (class net.sf.jsqlparser.statement.update.ParenthesedUpdate cannot be cast to class net.sf.jsqlparser.statement.select.ParenthesedSelect (net.sf.jsqlparser.statement.update.ParenthesedUpdate and net.sf.jsqlparser.statement.select.ParenthesedSelect are in unnamed module of loader 'app'))
********************************************************************************
--------------------------------------------------------------------------------
amb_regionale_fuehrungsstaebe_pub/regionale_fuehrungsstaebe.sql
--------------------------------------------------------------------------------
awjf_wegsanierungen_pub/awjf_wegsanierungen_pub_wegsanierungen_wegsanierung.sql
--------------------------------------------------------------------------------
avt_bodenfaktor_pub/delete_from_bodenfaktor.sql
--------------------------------------------------------------------------------
avt_bodenfaktor_pub/insert_into_bodenfaktor.sql
--------------------------------------------------------------------------------
afu_hydrologische_einzugsgebiete_pub/einzugsgebiet_mittel.sql
--------------------------------------------------------------------------------
afu_hydrologische_einzugsgebiete_pub/einzugsgebiet_gross.sql
--------------------------------------------------------------------------------
afu_hydrologische_einzugsgebiete_pub/einzugsgebiet_klein.sql
--------------------------------------------------------------------------------
awjf_waldplan_bestandeskarte_pub/awjf_waldplan_bestandeskarte_uebersicht_pub.sql
--------------------------------------------------------------------------------
awjf_waldplan_bestandeskarte_pub/awjf_waldplan_bestandeskarte_pub.sql
--------------------------------------------------------------------------------
afu_gewaesser_gewaessereigenschaften_pub/gewaessereigenschaften.sql
--------------------------------------------------------------------------------
afu_gewaesser_gewaessereigenschaften_pub/updateTxtCols.sql
--------------------------------------------------------------------------------
agi_qm_betrieb/geo_doppelte_schemas.sql
class net.sf.jsqlparser.JSQLParserException
net.sf.jsqlparser.parser.ParseException: Encountered unexpected token: "ATTACH" <S_IDENTIFIER>
    at line 1, column 1.

Was expecting one of:

    "("
    "ALTER"
    "ANALYZE"
    "BEGIN"
    "CALL"
    "COMMENT"
    "COMMIT"
    "CREATE"
    "DECLARE"
    "DELETE"
    "DESC"
    "DESCRIBE"
    "DROP"
    "EXEC"
    "EXECUTE"
    "EXPLAIN"
    "FROM"
    "GRANT"
    "IF"
    "INSERT"
    "MERGE"
    "PURGE"
    "REFRESH"
    "RENAME"
    "REPLACE"
    "RESET"
    "ROLLBACK"
    "SAVEPOINT"
    "SET"
    "SHOW"
    "SUMMARIZE"
    "TABLE"
    "TRUNCATE"
    "UPDATE"
    "UPSERT"
    "USE"
    "VALUE"
    "VALUES"
    "WITH"
    <K_SELECT>

Error parsing: ATTACH xxx_1 AS pubdb (TYPE POSTGRES, READ_ONLY) (net.sf.jsqlparser.parser.ParseException: Encountered unexpected token: "ATTACH" <S_IDENTIFIER>
    at line 1, column 1.

Was expecting one of:

    "("
    "ALTER"
    "ANALYZE"
    "BEGIN"
    "CALL"
    "COMMENT"
    "COMMIT"
    "CREATE"
    "DECLARE"
    "DELETE"
    "DESC"
    "DESCRIBE"
    "DROP"
    "EXEC"
    "EXECUTE"
    "EXPLAIN"
    "FROM"
    "GRANT"
    "IF"
    "INSERT"
    "MERGE"
    "PURGE"
    "REFRESH"
    "RENAME"
    "REPLACE"
    "RESET"
    "ROLLBACK"
    "SAVEPOINT"
    "SET"
    "SHOW"
    "SUMMARIZE"
    "TABLE"
    "TRUNCATE"
    "UPDATE"
    "UPSERT"
    "USE"
    "VALUE"
    "VALUES"
    "WITH"
    <K_SELECT>
)
********************************************************************************
class net.sf.jsqlparser.JSQLParserException
net.sf.jsqlparser.parser.ParseException: Encountered unexpected token: "ATTACH" <S_IDENTIFIER>
    at line 1, column 1.

Was expecting one of:

    "("
    "ALTER"
    "ANALYZE"
    "BEGIN"
    "CALL"
    "COMMENT"
    "COMMIT"
    "CREATE"
    "DECLARE"
    "DELETE"
    "DESC"
    "DESCRIBE"
    "DROP"
    "EXEC"
    "EXECUTE"
    "EXPLAIN"
    "FROM"
    "GRANT"
    "IF"
    "INSERT"
    "MERGE"
    "PURGE"
    "REFRESH"
    "RENAME"
    "REPLACE"
    "RESET"
    "ROLLBACK"
    "SAVEPOINT"
    "SET"
    "SHOW"
    "SUMMARIZE"
    "TABLE"
    "TRUNCATE"
    "UPDATE"
    "UPSERT"
    "USE"
    "VALUE"
    "VALUES"
    "WITH"
    <K_SELECT>

Error parsing: ATTACH xxx_1 AS editdb (TYPE POSTGRES, READ_ONLY) (net.sf.jsqlparser.parser.ParseException: Encountered unexpected token: "ATTACH" <S_IDENTIFIER>
    at line 1, column 1.

Was expecting one of:

    "("
    "ALTER"
    "ANALYZE"
    "BEGIN"
    "CALL"
    "COMMENT"
    "COMMIT"
    "CREATE"
    "DECLARE"
    "DELETE"
    "DESC"
    "DESCRIBE"
    "DROP"
    "EXEC"
    "EXECUTE"
    "EXPLAIN"
    "FROM"
    "GRANT"
    "IF"
    "INSERT"
    "MERGE"
    "PURGE"
    "REFRESH"
    "RENAME"
    "REPLACE"
    "RESET"
    "ROLLBACK"
    "SAVEPOINT"
    "SET"
    "SHOW"
    "SUMMARIZE"
    "TABLE"
    "TRUNCATE"
    "UPDATE"
    "UPSERT"
    "USE"
    "VALUE"
    "VALUES"
    "WITH"
    <K_SELECT>
)
********************************************************************************
class net.sf.jsqlparser.JSQLParserException
net.sf.jsqlparser.parser.ParseException: Encountered unexpected token: "COPY" <S_IDENTIFIER>
    at line 1, column 1.

Was expecting one of:

    "("
    "ALTER"
    "ANALYZE"
    "BEGIN"
    "CALL"
    "COMMENT"
    "COMMIT"
    "CREATE"
    "DECLARE"
    "DELETE"
    "DESC"
    "DESCRIBE"
    "DROP"
    "EXEC"
    "EXECUTE"
    "EXPLAIN"
    "FROM"
    "GRANT"
    "IF"
    "INSERT"
    "MERGE"
    "PURGE"
    "REFRESH"
    "RENAME"
    "REPLACE"
    "RESET"
    "ROLLBACK"
    "SAVEPOINT"
    "SET"
    "SHOW"
    "SUMMARIZE"
    "TABLE"
    "TRUNCATE"
    "UPDATE"
    "UPSERT"
    "USE"
    "VALUE"
    "VALUES"
    "WITH"
    <K_SELECT>

Error parsing: COPY geoDoppelteSchemasPub TO '/tmp/qmbetrieb/geo_doppelte_schemas.csv' (HEADER, DELIMITER ' (net.sf.jsqlparser.parser.ParseException: Encountered unexpected token: "COPY" <S_IDENTIFIER>
    at line 1, column 1.

Was expecting one of:

    "("
    "ALTER"
    "ANALYZE"
    "BEGIN"
    "CALL"
    "COMMENT"
    "COMMIT"
    "CREATE"
    "DECLARE"
    "DELETE"
    "DESC"
    "DESCRIBE"
    "DROP"
    "EXEC"
    "EXECUTE"
    "EXPLAIN"
    "FROM"
    "GRANT"
    "IF"
    "INSERT"
    "MERGE"
    "PURGE"
    "REFRESH"
    "RENAME"
    "REPLACE"
    "RESET"
    "ROLLBACK"
    "SAVEPOINT"
    "SET"
    "SHOW"
    "SUMMARIZE"
    "TABLE"
    "TRUNCATE"
    "UPDATE"
    "UPSERT"
    "USE"
    "VALUE"
    "VALUES"
    "WITH"
    <K_SELECT>
)
********************************************************************************
class net.sf.jsqlparser.JSQLParserException
net.sf.jsqlparser.parser.TokenMgrException: Lexical error at line 1, column 3.  Encountered: <EOF> after prefix "\')"
Error parsing: ') (net.sf.jsqlparser.parser.TokenMgrException: Lexical error at line 1, column 3.  Encountered: <EOF> after prefix "\')")
********************************************************************************
--------------------------------------------------------------------------------
agi_qm_betrieb/simi_schema_ohne_tabelle.sql
class net.sf.jsqlparser.JSQLParserException
net.sf.jsqlparser.parser.ParseException: Encountered unexpected token: "ATTACH" <S_IDENTIFIER>
    at line 1, column 1.

Was expecting one of:

    "("
    "ALTER"
    "ANALYZE"
    "BEGIN"
    "CALL"
    "COMMENT"
    "COMMIT"
    "CREATE"
    "DECLARE"
    "DELETE"
    "DESC"
    "DESCRIBE"
    "DROP"
    "EXEC"
    "EXECUTE"
    "EXPLAIN"
    "FROM"
    "GRANT"
    "IF"
    "INSERT"
    "MERGE"
    "PURGE"
    "REFRESH"
    "RENAME"
    "REPLACE"
    "RESET"
    "ROLLBACK"
    "SAVEPOINT"
    "SET"
    "SHOW"
    "SUMMARIZE"
    "TABLE"
    "TRUNCATE"
    "UPDATE"
    "UPSERT"
    "USE"
    "VALUE"
    "VALUES"
    "WITH"
    <K_SELECT>

Error parsing: ATTACH xxx_1 AS simidb (TYPE POSTGRES, READ_ONLY) (net.sf.jsqlparser.parser.ParseException: Encountered unexpected token: "ATTACH" <S_IDENTIFIER>
    at line 1, column 1.

Was expecting one of:

    "("
    "ALTER"
    "ANALYZE"
    "BEGIN"
    "CALL"
    "COMMENT"
    "COMMIT"
    "CREATE"
    "DECLARE"
    "DELETE"
    "DESC"
    "DESCRIBE"
    "DROP"
    "EXEC"
    "EXECUTE"
    "EXPLAIN"
    "FROM"
    "GRANT"
    "IF"
    "INSERT"
    "MERGE"
    "PURGE"
    "REFRESH"
    "RENAME"
    "REPLACE"
    "RESET"
    "ROLLBACK"
    "SAVEPOINT"
    "SET"
    "SHOW"
    "SUMMARIZE"
    "TABLE"
    "TRUNCATE"
    "UPDATE"
    "UPSERT"
    "USE"
    "VALUE"
    "VALUES"
    "WITH"
    <K_SELECT>
)
********************************************************************************
class net.sf.jsqlparser.JSQLParserException
net.sf.jsqlparser.parser.ParseException: Encountered unexpected token: "COPY" <S_IDENTIFIER>
    at line 1, column 1.

Was expecting one of:

    "("
    "ALTER"
    "ANALYZE"
    "BEGIN"
    "CALL"
    "COMMENT"
    "COMMIT"
    "CREATE"
    "DECLARE"
    "DELETE"
    "DESC"
    "DESCRIBE"
    "DROP"
    "EXEC"
    "EXECUTE"
    "EXPLAIN"
    "FROM"
    "GRANT"
    "IF"
    "INSERT"
    "MERGE"
    "PURGE"
    "REFRESH"
    "RENAME"
    "REPLACE"
    "RESET"
    "ROLLBACK"
    "SAVEPOINT"
    "SET"
    "SHOW"
    "SUMMARIZE"
    "TABLE"
    "TRUNCATE"
    "UPDATE"
    "UPSERT"
    "USE"
    "VALUE"
    "VALUES"
    "WITH"
    <K_SELECT>

Error parsing: COPY simiSchemaOhneTabelle TO '/tmp/qmbetrieb/simi_schema_ohne_tabelle.csv' (HEADER, DELIMITER ' (net.sf.jsqlparser.parser.ParseException: Encountered unexpected token: "COPY" <S_IDENTIFIER>
    at line 1, column 1.

Was expecting one of:

    "("
    "ALTER"
    "ANALYZE"
    "BEGIN"
    "CALL"
    "COMMENT"
    "COMMIT"
    "CREATE"
    "DECLARE"
    "DELETE"
    "DESC"
    "DESCRIBE"
    "DROP"
    "EXEC"
    "EXECUTE"
    "EXPLAIN"
    "FROM"
    "GRANT"
    "IF"
    "INSERT"
    "MERGE"
    "PURGE"
    "REFRESH"
    "RENAME"
    "REPLACE"
    "RESET"
    "ROLLBACK"
    "SAVEPOINT"
    "SET"
    "SHOW"
    "SUMMARIZE"
    "TABLE"
    "TRUNCATE"
    "UPDATE"
    "UPSERT"
    "USE"
    "VALUE"
    "VALUES"
    "WITH"
    <K_SELECT>
)
********************************************************************************
class net.sf.jsqlparser.JSQLParserException
net.sf.jsqlparser.parser.TokenMgrException: Lexical error at line 1, column 3.  Encountered: <EOF> after prefix "\')"
Error parsing: ') (net.sf.jsqlparser.parser.TokenMgrException: Lexical error at line 1, column 3.  Encountered: <EOF> after prefix "\')")
********************************************************************************
--------------------------------------------------------------------------------
agi_qm_betrieb/simi_table_ohne_tableview.sql
class net.sf.jsqlparser.JSQLParserException
net.sf.jsqlparser.parser.ParseException: Encountered unexpected token: "ATTACH" <S_IDENTIFIER>
    at line 1, column 1.

Was expecting one of:

    "("
    "ALTER"
    "ANALYZE"
    "BEGIN"
    "CALL"
    "COMMENT"
    "COMMIT"
    "CREATE"
    "DECLARE"
    "DELETE"
    "DESC"
    "DESCRIBE"
    "DROP"
    "EXEC"
    "EXECUTE"
    "EXPLAIN"
    "FROM"
    "GRANT"
    "IF"
    "INSERT"
    "MERGE"
    "PURGE"
    "REFRESH"
    "RENAME"
    "REPLACE"
    "RESET"
    "ROLLBACK"
    "SAVEPOINT"
    "SET"
    "SHOW"
    "SUMMARIZE"
    "TABLE"
    "TRUNCATE"
    "UPDATE"
    "UPSERT"
    "USE"
    "VALUE"
    "VALUES"
    "WITH"
    <K_SELECT>

Error parsing: ATTACH xxx_1 AS simidb (TYPE POSTGRES, READ_ONLY) (net.sf.jsqlparser.parser.ParseException: Encountered unexpected token: "ATTACH" <S_IDENTIFIER>
    at line 1, column 1.

Was expecting one of:

    "("
    "ALTER"
    "ANALYZE"
    "BEGIN"
    "CALL"
    "COMMENT"
    "COMMIT"
    "CREATE"
    "DECLARE"
    "DELETE"
    "DESC"
    "DESCRIBE"
    "DROP"
    "EXEC"
    "EXECUTE"
    "EXPLAIN"
    "FROM"
    "GRANT"
    "IF"
    "INSERT"
    "MERGE"
    "PURGE"
    "REFRESH"
    "RENAME"
    "REPLACE"
    "RESET"
    "ROLLBACK"
    "SAVEPOINT"
    "SET"
    "SHOW"
    "SUMMARIZE"
    "TABLE"
    "TRUNCATE"
    "UPDATE"
    "UPSERT"
    "USE"
    "VALUE"
    "VALUES"
    "WITH"
    <K_SELECT>
)
********************************************************************************
class net.sf.jsqlparser.JSQLParserException
net.sf.jsqlparser.parser.ParseException: Encountered unexpected token: "COPY" <S_IDENTIFIER>
    at line 1, column 1.

Was expecting one of:

    "("
    "ALTER"
    "ANALYZE"
    "BEGIN"
    "CALL"
    "COMMENT"
    "COMMIT"
    "CREATE"
    "DECLARE"
    "DELETE"
    "DESC"
    "DESCRIBE"
    "DROP"
    "EXEC"
    "EXECUTE"
    "EXPLAIN"
    "FROM"
    "GRANT"
    "IF"
    "INSERT"
    "MERGE"
    "PURGE"
    "REFRESH"
    "RENAME"
    "REPLACE"
    "RESET"
    "ROLLBACK"
    "SAVEPOINT"
    "SET"
    "SHOW"
    "SUMMARIZE"
    "TABLE"
    "TRUNCATE"
    "UPDATE"
    "UPSERT"
    "USE"
    "VALUE"
    "VALUES"
    "WITH"
    <K_SELECT>

Error parsing: COPY simiTableOhneTableView TO '/tmp/qmbetrieb/simi_table_ohne_tableview.csv' (HEADER, DELIMITER ' (net.sf.jsqlparser.parser.ParseException: Encountered unexpected token: "COPY" <S_IDENTIFIER>
    at line 1, column 1.

Was expecting one of:

    "("
    "ALTER"
    "ANALYZE"
    "BEGIN"
    "CALL"
    "COMMENT"
    "COMMIT"
    "CREATE"
    "DECLARE"
    "DELETE"
    "DESC"
    "DESCRIBE"
    "DROP"
    "EXEC"
    "EXECUTE"
    "EXPLAIN"
    "FROM"
    "GRANT"
    "IF"
    "INSERT"
    "MERGE"
    "PURGE"
    "REFRESH"
    "RENAME"
    "REPLACE"
    "RESET"
    "ROLLBACK"
    "SAVEPOINT"
    "SET"
    "SHOW"
    "SUMMARIZE"
    "TABLE"
    "TRUNCATE"
    "UPDATE"
    "UPSERT"
    "USE"
    "VALUE"
    "VALUES"
    "WITH"
    <K_SELECT>
)
********************************************************************************
class net.sf.jsqlparser.JSQLParserException
net.sf.jsqlparser.parser.TokenMgrException: Lexical error at line 1, column 3.  Encountered: <EOF> after prefix "\')"
Error parsing: ') (net.sf.jsqlparser.parser.TokenMgrException: Lexical error at line 1, column 3.  Encountered: <EOF> after prefix "\')")
********************************************************************************
--------------------------------------------------------------------------------
agi_qm_betrieb/missing_ebau_layer.sql
class net.sf.jsqlparser.JSQLParserException
net.sf.jsqlparser.parser.ParseException: Encountered unexpected token: "ATTACH" <S_IDENTIFIER>
    at line 1, column 1.

Was expecting one of:

    "("
    "ALTER"
    "ANALYZE"
    "BEGIN"
    "CALL"
    "COMMENT"
    "COMMIT"
    "CREATE"
    "DECLARE"
    "DELETE"
    "DESC"
    "DESCRIBE"
    "DROP"
    "EXEC"
    "EXECUTE"
    "EXPLAIN"
    "FROM"
    "GRANT"
    "IF"
    "INSERT"
    "MERGE"
    "PURGE"
    "REFRESH"
    "RENAME"
    "REPLACE"
    "RESET"
    "ROLLBACK"
    "SAVEPOINT"
    "SET"
    "SHOW"
    "SUMMARIZE"
    "TABLE"
    "TRUNCATE"
    "UPDATE"
    "UPSERT"
    "USE"
    "VALUE"
    "VALUES"
    "WITH"
    <K_SELECT>

Error parsing: ATTACH xxx_1 AS simidb (TYPE POSTGRES, READ_ONLY) (net.sf.jsqlparser.parser.ParseException: Encountered unexpected token: "ATTACH" <S_IDENTIFIER>
    at line 1, column 1.

Was expecting one of:

    "("
    "ALTER"
    "ANALYZE"
    "BEGIN"
    "CALL"
    "COMMENT"
    "COMMIT"
    "CREATE"
    "DECLARE"
    "DELETE"
    "DESC"
    "DESCRIBE"
    "DROP"
    "EXEC"
    "EXECUTE"
    "EXPLAIN"
    "FROM"
    "GRANT"
    "IF"
    "INSERT"
    "MERGE"
    "PURGE"
    "REFRESH"
    "RENAME"
    "REPLACE"
    "RESET"
    "ROLLBACK"
    "SAVEPOINT"
    "SET"
    "SHOW"
    "SUMMARIZE"
    "TABLE"
    "TRUNCATE"
    "UPDATE"
    "UPSERT"
    "USE"
    "VALUE"
    "VALUES"
    "WITH"
    <K_SELECT>
)
********************************************************************************
class net.sf.jsqlparser.JSQLParserException
net.sf.jsqlparser.parser.ParseException: Encountered unexpected token: "COPY" <S_IDENTIFIER>
    at line 1, column 1.

Was expecting one of:

    "("
    "ALTER"
    "ANALYZE"
    "BEGIN"
    "CALL"
    "COMMENT"
    "COMMIT"
    "CREATE"
    "DECLARE"
    "DELETE"
    "DESC"
    "DESCRIBE"
    "DROP"
    "EXEC"
    "EXECUTE"
    "EXPLAIN"
    "FROM"
    "GRANT"
    "IF"
    "INSERT"
    "MERGE"
    "PURGE"
    "REFRESH"
    "RENAME"
    "REPLACE"
    "RESET"
    "ROLLBACK"
    "SAVEPOINT"
    "SET"
    "SHOW"
    "SUMMARIZE"
    "TABLE"
    "TRUNCATE"
    "UPDATE"
    "UPSERT"
    "USE"
    "VALUE"
    "VALUES"
    "WITH"
    <K_SELECT>

Error parsing: COPY missingEbauLayer TO '/tmp/qmbetrieb/missing_ebau_layer.csv' (HEADER, DELIMITER ' (net.sf.jsqlparser.parser.ParseException: Encountered unexpected token: "COPY" <S_IDENTIFIER>
    at line 1, column 1.

Was expecting one of:

    "("
    "ALTER"
    "ANALYZE"
    "BEGIN"
    "CALL"
    "COMMENT"
    "COMMIT"
    "CREATE"
    "DECLARE"
    "DELETE"
    "DESC"
    "DESCRIBE"
    "DROP"
    "EXEC"
    "EXECUTE"
    "EXPLAIN"
    "FROM"
    "GRANT"
    "IF"
    "INSERT"
    "MERGE"
    "PURGE"
    "REFRESH"
    "RENAME"
    "REPLACE"
    "RESET"
    "ROLLBACK"
    "SAVEPOINT"
    "SET"
    "SHOW"
    "SUMMARIZE"
    "TABLE"
    "TRUNCATE"
    "UPDATE"
    "UPSERT"
    "USE"
    "VALUE"
    "VALUES"
    "WITH"
    <K_SELECT>
)
********************************************************************************
class net.sf.jsqlparser.JSQLParserException
net.sf.jsqlparser.parser.TokenMgrException: Lexical error at line 1, column 3.  Encountered: <EOF> after prefix "\')"
Error parsing: ') (net.sf.jsqlparser.parser.TokenMgrException: Lexical error at line 1, column 3.  Encountered: <EOF> after prefix "\')")
********************************************************************************
--------------------------------------------------------------------------------
agi_qm_betrieb/diff_kennung_simi_datenabgabe.sql
class net.sf.jsqlparser.JSQLParserException
net.sf.jsqlparser.parser.ParseException: Encountered unexpected token: "ATTACH" <S_IDENTIFIER>
    at line 1, column 1.

Was expecting one of:

    "("
    "ALTER"
    "ANALYZE"
    "BEGIN"
    "CALL"
    "COMMENT"
    "COMMIT"
    "CREATE"
    "DECLARE"
    "DELETE"
    "DESC"
    "DESCRIBE"
    "DROP"
    "EXEC"
    "EXECUTE"
    "EXPLAIN"
    "FROM"
    "GRANT"
    "IF"
    "INSERT"
    "MERGE"
    "PURGE"
    "REFRESH"
    "RENAME"
    "REPLACE"
    "RESET"
    "ROLLBACK"
    "SAVEPOINT"
    "SET"
    "SHOW"
    "SUMMARIZE"
    "TABLE"
    "TRUNCATE"
    "UPDATE"
    "UPSERT"
    "USE"
    "VALUE"
    "VALUES"
    "WITH"
    <K_SELECT>

Error parsing: ATTACH xxx_1 AS simidb (TYPE POSTGRES, READ_ONLY) (net.sf.jsqlparser.parser.ParseException: Encountered unexpected token: "ATTACH" <S_IDENTIFIER>
    at line 1, column 1.

Was expecting one of:

    "("
    "ALTER"
    "ANALYZE"
    "BEGIN"
    "CALL"
    "COMMENT"
    "COMMIT"
    "CREATE"
    "DECLARE"
    "DELETE"
    "DESC"
    "DESCRIBE"
    "DROP"
    "EXEC"
    "EXECUTE"
    "EXPLAIN"
    "FROM"
    "GRANT"
    "IF"
    "INSERT"
    "MERGE"
    "PURGE"
    "REFRESH"
    "RENAME"
    "REPLACE"
    "RESET"
    "ROLLBACK"
    "SAVEPOINT"
    "SET"
    "SHOW"
    "SUMMARIZE"
    "TABLE"
    "TRUNCATE"
    "UPDATE"
    "UPSERT"
    "USE"
    "VALUE"
    "VALUES"
    "WITH"
    <K_SELECT>
)
********************************************************************************
class net.sf.jsqlparser.JSQLParserException
net.sf.jsqlparser.parser.ParseException: Encountered unexpected token: "COPY" <S_IDENTIFIER>
    at line 1, column 1.

Was expecting one of:

    "("
    "ALTER"
    "ANALYZE"
    "BEGIN"
    "CALL"
    "COMMENT"
    "COMMIT"
    "CREATE"
    "DECLARE"
    "DELETE"
    "DESC"
    "DESCRIBE"
    "DROP"
    "EXEC"
    "EXECUTE"
    "EXPLAIN"
    "FROM"
    "GRANT"
    "IF"
    "INSERT"
    "MERGE"
    "PURGE"
    "REFRESH"
    "RENAME"
    "REPLACE"
    "RESET"
    "ROLLBACK"
    "SAVEPOINT"
    "SET"
    "SHOW"
    "SUMMARIZE"
    "TABLE"
    "TRUNCATE"
    "UPDATE"
    "UPSERT"
    "USE"
    "VALUE"
    "VALUES"
    "WITH"
    <K_SELECT>

Error parsing: COPY (SELECT * FROM myresult_diff) TO '/tmp/qmbetrieb/diff_kennung_simi_datenabgabe.csv' (HEADER, DELIMITER ' (net.sf.jsqlparser.parser.ParseException: Encountered unexpected token: "COPY" <S_IDENTIFIER>
    at line 1, column 1.

Was expecting one of:

    "("
    "ALTER"
    "ANALYZE"
    "BEGIN"
    "CALL"
    "COMMENT"
    "COMMIT"
    "CREATE"
    "DECLARE"
    "DELETE"
    "DESC"
    "DESCRIBE"
    "DROP"
    "EXEC"
    "EXECUTE"
    "EXPLAIN"
    "FROM"
    "GRANT"
    "IF"
    "INSERT"
    "MERGE"
    "PURGE"
    "REFRESH"
    "RENAME"
    "REPLACE"
    "RESET"
    "ROLLBACK"
    "SAVEPOINT"
    "SET"
    "SHOW"
    "SUMMARIZE"
    "TABLE"
    "TRUNCATE"
    "UPDATE"
    "UPSERT"
    "USE"
    "VALUE"
    "VALUES"
    "WITH"
    <K_SELECT>
)
********************************************************************************
class net.sf.jsqlparser.JSQLParserException
net.sf.jsqlparser.parser.TokenMgrException: Lexical error at line 1, column 3.  Encountered: <EOF> after prefix "\')"
Error parsing: ') (net.sf.jsqlparser.parser.TokenMgrException: Lexical error at line 1, column 3.  Encountered: <EOF> after prefix "\')")
********************************************************************************
--------------------------------------------------------------------------------
agi_qm_betrieb/simple_theme_publication_csv.sql
class net.sf.jsqlparser.JSQLParserException
net.sf.jsqlparser.parser.ParseException: Encountered unexpected token: "LOAD" <S_IDENTIFIER>
    at line 1, column 1.

Was expecting one of:

    "("
    "ALTER"
    "ANALYZE"
    "BEGIN"
    "CALL"
    "COMMENT"
    "COMMIT"
    "CREATE"
    "DECLARE"
    "DELETE"
    "DESC"
    "DESCRIBE"
    "DROP"
    "EXEC"
    "EXECUTE"
    "EXPLAIN"
    "FROM"
    "GRANT"
    "IF"
    "INSERT"
    "MERGE"
    "PURGE"
    "REFRESH"
    "RENAME"
    "REPLACE"
    "RESET"
    "ROLLBACK"
    "SAVEPOINT"
    "SET"
    "SHOW"
    "SUMMARIZE"
    "TABLE"
    "TRUNCATE"
    "UPDATE"
    "UPSERT"
    "USE"
    "VALUE"
    "VALUES"
    "WITH"
    <K_SELECT>

Error parsing: LOAD spatial (net.sf.jsqlparser.parser.ParseException: Encountered unexpected token: "LOAD" <S_IDENTIFIER>
    at line 1, column 1.

Was expecting one of:

    "("
    "ALTER"
    "ANALYZE"
    "BEGIN"
    "CALL"
    "COMMENT"
    "COMMIT"
    "CREATE"
    "DECLARE"
    "DELETE"
    "DESC"
    "DESCRIBE"
    "DROP"
    "EXEC"
    "EXECUTE"
    "EXPLAIN"
    "FROM"
    "GRANT"
    "IF"
    "INSERT"
    "MERGE"
    "PURGE"
    "REFRESH"
    "RENAME"
    "REPLACE"
    "RESET"
    "ROLLBACK"
    "SAVEPOINT"
    "SET"
    "SHOW"
    "SUMMARIZE"
    "TABLE"
    "TRUNCATE"
    "UPDATE"
    "UPSERT"
    "USE"
    "VALUE"
    "VALUES"
    "WITH"
    <K_SELECT>
)
********************************************************************************
class net.sf.jsqlparser.JSQLParserException
net.sf.jsqlparser.parser.ParseException: Encountered unexpected token: "ATTACH" <S_IDENTIFIER>
    at line 1, column 1.

Was expecting one of:

    "("
    "ALTER"
    "ANALYZE"
    "BEGIN"
    "CALL"
    "COMMENT"
    "COMMIT"
    "CREATE"
    "DECLARE"
    "DELETE"
    "DESC"
    "DESCRIBE"
    "DROP"
    "EXEC"
    "EXECUTE"
    "EXPLAIN"
    "FROM"
    "GRANT"
    "IF"
    "INSERT"
    "MERGE"
    "PURGE"
    "REFRESH"
    "RENAME"
    "REPLACE"
    "RESET"
    "ROLLBACK"
    "SAVEPOINT"
    "SET"
    "SHOW"
    "SUMMARIZE"
    "TABLE"
    "TRUNCATE"
    "UPDATE"
    "UPSERT"
    "USE"
    "VALUE"
    "VALUES"
    "WITH"
    <K_SELECT>

Error parsing: ATTACH xxx_1 AS simidb (TYPE POSTGRES, READ_ONLY) (net.sf.jsqlparser.parser.ParseException: Encountered unexpected token: "ATTACH" <S_IDENTIFIER>
    at line 1, column 1.

Was expecting one of:

    "("
    "ALTER"
    "ANALYZE"
    "BEGIN"
    "CALL"
    "COMMENT"
    "COMMIT"
    "CREATE"
    "DECLARE"
    "DELETE"
    "DESC"
    "DESCRIBE"
    "DROP"
    "EXEC"
    "EXECUTE"
    "EXPLAIN"
    "FROM"
    "GRANT"
    "IF"
    "INSERT"
    "MERGE"
    "PURGE"
    "REFRESH"
    "RENAME"
    "REPLACE"
    "RESET"
    "ROLLBACK"
    "SAVEPOINT"
    "SET"
    "SHOW"
    "SUMMARIZE"
    "TABLE"
    "TRUNCATE"
    "UPDATE"
    "UPSERT"
    "USE"
    "VALUE"
    "VALUES"
    "WITH"
    <K_SELECT>
)
********************************************************************************
class net.sf.jsqlparser.JSQLParserException
net.sf.jsqlparser.parser.ParseException: Encountered unexpected token: "COPY" <S_IDENTIFIER>
    at line 1, column 1.

Was expecting one of:

    "("
    "ALTER"
    "ANALYZE"
    "BEGIN"
    "CALL"
    "COMMENT"
    "COMMIT"
    "CREATE"
    "DECLARE"
    "DELETE"
    "DESC"
    "DESCRIBE"
    "DROP"
    "EXEC"
    "EXECUTE"
    "EXPLAIN"
    "FROM"
    "GRANT"
    "IF"
    "INSERT"
    "MERGE"
    "PURGE"
    "REFRESH"
    "RENAME"
    "REPLACE"
    "RESET"
    "ROLLBACK"
    "SAVEPOINT"
    "SET"
    "SHOW"
    "SUMMARIZE"
    "TABLE"
    "TRUNCATE"
    "UPDATE"
    "UPSERT"
    "USE"
    "VALUE"
    "VALUES"
    "WITH"
    <K_SELECT>

Error parsing: COPY simpleThemePublicationCsv TO '/tmp/simple_theme_publication_csv.csv' (HEADER false) (net.sf.jsqlparser.parser.ParseException: Encountered unexpected token: "COPY" <S_IDENTIFIER>
    at line 1, column 1.

Was expecting one of:

    "("
    "ALTER"
    "ANALYZE"
    "BEGIN"
    "CALL"
    "COMMENT"
    "COMMIT"
    "CREATE"
    "DECLARE"
    "DELETE"
    "DESC"
    "DESCRIBE"
    "DROP"
    "EXEC"
    "EXECUTE"
    "EXPLAIN"
    "FROM"
    "GRANT"
    "IF"
    "INSERT"
    "MERGE"
    "PURGE"
    "REFRESH"
    "RENAME"
    "REPLACE"
    "RESET"
    "ROLLBACK"
    "SAVEPOINT"
    "SET"
    "SHOW"
    "SUMMARIZE"
    "TABLE"
    "TRUNCATE"
    "UPDATE"
    "UPSERT"
    "USE"
    "VALUE"
    "VALUES"
    "WITH"
    <K_SELECT>
)
********************************************************************************
--------------------------------------------------------------------------------
agi_qm_betrieb/simi_raster_ohne_datasetview.sql
class net.sf.jsqlparser.JSQLParserException
net.sf.jsqlparser.parser.ParseException: Encountered unexpected token: "ATTACH" <S_IDENTIFIER>
    at line 1, column 1.

Was expecting one of:

    "("
    "ALTER"
    "ANALYZE"
    "BEGIN"
    "CALL"
    "COMMENT"
    "COMMIT"
    "CREATE"
    "DECLARE"
    "DELETE"
    "DESC"
    "DESCRIBE"
    "DROP"
    "EXEC"
    "EXECUTE"
    "EXPLAIN"
    "FROM"
    "GRANT"
    "IF"
    "INSERT"
    "MERGE"
    "PURGE"
    "REFRESH"
    "RENAME"
    "REPLACE"
    "RESET"
    "ROLLBACK"
    "SAVEPOINT"
    "SET"
    "SHOW"
    "SUMMARIZE"
    "TABLE"
    "TRUNCATE"
    "UPDATE"
    "UPSERT"
    "USE"
    "VALUE"
    "VALUES"
    "WITH"
    <K_SELECT>

Error parsing: ATTACH xxx_1 AS simidb (TYPE POSTGRES, READ_ONLY) (net.sf.jsqlparser.parser.ParseException: Encountered unexpected token: "ATTACH" <S_IDENTIFIER>
    at line 1, column 1.

Was expecting one of:

    "("
    "ALTER"
    "ANALYZE"
    "BEGIN"
    "CALL"
    "COMMENT"
    "COMMIT"
    "CREATE"
    "DECLARE"
    "DELETE"
    "DESC"
    "DESCRIBE"
    "DROP"
    "EXEC"
    "EXECUTE"
    "EXPLAIN"
    "FROM"
    "GRANT"
    "IF"
    "INSERT"
    "MERGE"
    "PURGE"
    "REFRESH"
    "RENAME"
    "REPLACE"
    "RESET"
    "ROLLBACK"
    "SAVEPOINT"
    "SET"
    "SHOW"
    "SUMMARIZE"
    "TABLE"
    "TRUNCATE"
    "UPDATE"
    "UPSERT"
    "USE"
    "VALUE"
    "VALUES"
    "WITH"
    <K_SELECT>
)
********************************************************************************
class net.sf.jsqlparser.JSQLParserException
net.sf.jsqlparser.parser.ParseException: Encountered unexpected token: "COPY" <S_IDENTIFIER>
    at line 1, column 1.

Was expecting one of:

    "("
    "ALTER"
    "ANALYZE"
    "BEGIN"
    "CALL"
    "COMMENT"
    "COMMIT"
    "CREATE"
    "DECLARE"
    "DELETE"
    "DESC"
    "DESCRIBE"
    "DROP"
    "EXEC"
    "EXECUTE"
    "EXPLAIN"
    "FROM"
    "GRANT"
    "IF"
    "INSERT"
    "MERGE"
    "PURGE"
    "REFRESH"
    "RENAME"
    "REPLACE"
    "RESET"
    "ROLLBACK"
    "SAVEPOINT"
    "SET"
    "SHOW"
    "SUMMARIZE"
    "TABLE"
    "TRUNCATE"
    "UPDATE"
    "UPSERT"
    "USE"
    "VALUE"
    "VALUES"
    "WITH"
    <K_SELECT>

Error parsing: COPY simiRasterOhneDatasetView TO '/tmp/qmbetrieb/simi_raster_ohne_datasetview.csv' (HEADER, DELIMITER ' (net.sf.jsqlparser.parser.ParseException: Encountered unexpected token: "COPY" <S_IDENTIFIER>
    at line 1, column 1.

Was expecting one of:

    "("
    "ALTER"
    "ANALYZE"
    "BEGIN"
    "CALL"
    "COMMENT"
    "COMMIT"
    "CREATE"
    "DECLARE"
    "DELETE"
    "DESC"
    "DESCRIBE"
    "DROP"
    "EXEC"
    "EXECUTE"
    "EXPLAIN"
    "FROM"
    "GRANT"
    "IF"
    "INSERT"
    "MERGE"
    "PURGE"
    "REFRESH"
    "RENAME"
    "REPLACE"
    "RESET"
    "ROLLBACK"
    "SAVEPOINT"
    "SET"
    "SHOW"
    "SUMMARIZE"
    "TABLE"
    "TRUNCATE"
    "UPDATE"
    "UPSERT"
    "USE"
    "VALUE"
    "VALUES"
    "WITH"
    <K_SELECT>
)
********************************************************************************
class net.sf.jsqlparser.JSQLParserException
net.sf.jsqlparser.parser.TokenMgrException: Lexical error at line 1, column 3.  Encountered: <EOF> after prefix "\')"
Error parsing: ') (net.sf.jsqlparser.parser.TokenMgrException: Lexical error at line 1, column 3.  Encountered: <EOF> after prefix "\')")
********************************************************************************
--------------------------------------------------------------------------------
agi_qm_betrieb/relational_theme_publication_csv.sql
class net.sf.jsqlparser.JSQLParserException
net.sf.jsqlparser.parser.ParseException: Encountered unexpected token: "LOAD" <S_IDENTIFIER>
    at line 1, column 1.

Was expecting one of:

    "("
    "ALTER"
    "ANALYZE"
    "BEGIN"
    "CALL"
    "COMMENT"
    "COMMIT"
    "CREATE"
    "DECLARE"
    "DELETE"
    "DESC"
    "DESCRIBE"
    "DROP"
    "EXEC"
    "EXECUTE"
    "EXPLAIN"
    "FROM"
    "GRANT"
    "IF"
    "INSERT"
    "MERGE"
    "PURGE"
    "REFRESH"
    "RENAME"
    "REPLACE"
    "RESET"
    "ROLLBACK"
    "SAVEPOINT"
    "SET"
    "SHOW"
    "SUMMARIZE"
    "TABLE"
    "TRUNCATE"
    "UPDATE"
    "UPSERT"
    "USE"
    "VALUE"
    "VALUES"
    "WITH"
    <K_SELECT>

Error parsing: LOAD spatial (net.sf.jsqlparser.parser.ParseException: Encountered unexpected token: "LOAD" <S_IDENTIFIER>
    at line 1, column 1.

Was expecting one of:

    "("
    "ALTER"
    "ANALYZE"
    "BEGIN"
    "CALL"
    "COMMENT"
    "COMMIT"
    "CREATE"
    "DECLARE"
    "DELETE"
    "DESC"
    "DESCRIBE"
    "DROP"
    "EXEC"
    "EXECUTE"
    "EXPLAIN"
    "FROM"
    "GRANT"
    "IF"
    "INSERT"
    "MERGE"
    "PURGE"
    "REFRESH"
    "RENAME"
    "REPLACE"
    "RESET"
    "ROLLBACK"
    "SAVEPOINT"
    "SET"
    "SHOW"
    "SUMMARIZE"
    "TABLE"
    "TRUNCATE"
    "UPDATE"
    "UPSERT"
    "USE"
    "VALUE"
    "VALUES"
    "WITH"
    <K_SELECT>
)
********************************************************************************
class net.sf.jsqlparser.JSQLParserException
net.sf.jsqlparser.parser.ParseException: Encountered unexpected token: "ATTACH" <S_IDENTIFIER>
    at line 1, column 1.

Was expecting one of:

    "("
    "ALTER"
    "ANALYZE"
    "BEGIN"
    "CALL"
    "COMMENT"
    "COMMIT"
    "CREATE"
    "DECLARE"
    "DELETE"
    "DESC"
    "DESCRIBE"
    "DROP"
    "EXEC"
    "EXECUTE"
    "EXPLAIN"
    "FROM"
    "GRANT"
    "IF"
    "INSERT"
    "MERGE"
    "PURGE"
    "REFRESH"
    "RENAME"
    "REPLACE"
    "RESET"
    "ROLLBACK"
    "SAVEPOINT"
    "SET"
    "SHOW"
    "SUMMARIZE"
    "TABLE"
    "TRUNCATE"
    "UPDATE"
    "UPSERT"
    "USE"
    "VALUE"
    "VALUES"
    "WITH"
    <K_SELECT>

Error parsing: ATTACH xxx_1 AS simidb (TYPE POSTGRES, READ_ONLY) (net.sf.jsqlparser.parser.ParseException: Encountered unexpected token: "ATTACH" <S_IDENTIFIER>
    at line 1, column 1.

Was expecting one of:

    "("
    "ALTER"
    "ANALYZE"
    "BEGIN"
    "CALL"
    "COMMENT"
    "COMMIT"
    "CREATE"
    "DECLARE"
    "DELETE"
    "DESC"
    "DESCRIBE"
    "DROP"
    "EXEC"
    "EXECUTE"
    "EXPLAIN"
    "FROM"
    "GRANT"
    "IF"
    "INSERT"
    "MERGE"
    "PURGE"
    "REFRESH"
    "RENAME"
    "REPLACE"
    "RESET"
    "ROLLBACK"
    "SAVEPOINT"
    "SET"
    "SHOW"
    "SUMMARIZE"
    "TABLE"
    "TRUNCATE"
    "UPDATE"
    "UPSERT"
    "USE"
    "VALUE"
    "VALUES"
    "WITH"
    <K_SELECT>
)
********************************************************************************
class net.sf.jsqlparser.JSQLParserException
net.sf.jsqlparser.parser.ParseException: Encountered unexpected token: "COPY" <S_IDENTIFIER>
    at line 1, column 1.

Was expecting one of:

    "("
    "ALTER"
    "ANALYZE"
    "BEGIN"
    "CALL"
    "COMMENT"
    "COMMIT"
    "CREATE"
    "DECLARE"
    "DELETE"
    "DESC"
    "DESCRIBE"
    "DROP"
    "EXEC"
    "EXECUTE"
    "EXPLAIN"
    "FROM"
    "GRANT"
    "IF"
    "INSERT"
    "MERGE"
    "PURGE"
    "REFRESH"
    "RENAME"
    "REPLACE"
    "RESET"
    "ROLLBACK"
    "SAVEPOINT"
    "SET"
    "SHOW"
    "SUMMARIZE"
    "TABLE"
    "TRUNCATE"
    "UPDATE"
    "UPSERT"
    "USE"
    "VALUE"
    "VALUES"
    "WITH"
    <K_SELECT>

Error parsing: COPY relationalThemePublicationCsv TO '/tmp/relational_theme_publication_csv.csv' (HEADER false) (net.sf.jsqlparser.parser.ParseException: Encountered unexpected token: "COPY" <S_IDENTIFIER>
    at line 1, column 1.

Was expecting one of:

    "("
    "ALTER"
    "ANALYZE"
    "BEGIN"
    "CALL"
    "COMMENT"
    "COMMIT"
    "CREATE"
    "DECLARE"
    "DELETE"
    "DESC"
    "DESCRIBE"
    "DROP"
    "EXEC"
    "EXECUTE"
    "EXPLAIN"
    "FROM"
    "GRANT"
    "IF"
    "INSERT"
    "MERGE"
    "PURGE"
    "REFRESH"
    "RENAME"
    "REPLACE"
    "RESET"
    "ROLLBACK"
    "SAVEPOINT"
    "SET"
    "SHOW"
    "SUMMARIZE"
    "TABLE"
    "TRUNCATE"
    "UPDATE"
    "UPSERT"
    "USE"
    "VALUE"
    "VALUES"
    "WITH"
    <K_SELECT>
)
********************************************************************************
--------------------------------------------------------------------------------
afu_ewsabfrage_2d/1_CopyToPub/abfrageperimeter.sql
--------------------------------------------------------------------------------
afu_ewsabfrage_2d/1_CopyToPub/hinweis.sql
--------------------------------------------------------------------------------
afu_ewsabfrage_2d/1_CopyToPub/grundstueck.sql
--------------------------------------------------------------------------------
afu_ewsabfrage_2d/1_CopyToPub/tiefenbeschraenkung.sql
--------------------------------------------------------------------------------
afu_ewsabfrage_2d/1_CopyToPub/abklaerung.sql
--------------------------------------------------------------------------------
afu_ewsabfrage_2d/0_CopyToStaging/gewaesserschutz_schutzareal.sql
--------------------------------------------------------------------------------
afu_ewsabfrage_2d/0_CopyToStaging/gewaesserschutz_schutzzone.sql
--------------------------------------------------------------------------------
afu_ewsabfrage_2d/0_CopyToStaging/rutschung_tief.sql
--------------------------------------------------------------------------------
afu_ewsabfrage_2d/0_CopyToStaging/bohrprofil.sql
--------------------------------------------------------------------------------
afu_ewsabfrage_2d/0_CopyToStaging/grundwasserstrom_begrenzung_hgw.sql
--------------------------------------------------------------------------------
afu_ewsabfrage_2d/0_CopyToStaging/belasteter_standort.sql
--------------------------------------------------------------------------------
afu_ewsabfrage_2d/0_CopyToStaging/ewsabfrage_tiefenbeschraenkung.sql
--------------------------------------------------------------------------------
afu_ewsabfrage_2d/0_CopyToStaging/abklaerung.sql
--------------------------------------------------------------------------------
afu_ewsabfrage_2d/0_CopyToStaging/oekomorphologie.sql
--------------------------------------------------------------------------------
afu_ewsabfrage_2d/0_CopyToStaging/mopublic_grundstueck.sql
--------------------------------------------------------------------------------
afu_ewsabfrage_2d/0_CopyToStaging/deleteStageObjects.sql
--------------------------------------------------------------------------------
avt_verkehrszaehlstellen_pub/avt_verkehrszaehlstellen_pub_verkehrszhlstllen_verkehrszaehlstelle.sql
--------------------------------------------------------------------------------
alw_strukturverbesserungen_suissemelio/oekologie_trockenmauer.sql
--------------------------------------------------------------------------------
alw_strukturverbesserungen_suissemelio/entwaesserung_bodenstruktur_pumpwerk.sql
--------------------------------------------------------------------------------
alw_strukturverbesserungen_suissemelio/bewaesserung_punkt.sql
--------------------------------------------------------------------------------
alw_strukturverbesserungen_suissemelio/elektroversorgung_punkt.sql
--------------------------------------------------------------------------------
alw_strukturverbesserungen_suissemelio/entwaesserung_bodenstruktur_linie.sql
--------------------------------------------------------------------------------
alw_strukturverbesserungen_suissemelio/beizugsgebiet.sql
--------------------------------------------------------------------------------
alw_strukturverbesserungen_suissemelio/wasserversorgung_leitung.sql
--------------------------------------------------------------------------------
alw_strukturverbesserungen_suissemelio/entwaesserung_bodenstruktur_flaeche.sql
--------------------------------------------------------------------------------
alw_strukturverbesserungen_suissemelio/oekologie_linie.sql
--------------------------------------------------------------------------------
alw_strukturverbesserungen_suissemelio/wege_bruecke_lehnenviadukt.sql
--------------------------------------------------------------------------------
alw_strukturverbesserungen_suissemelio/projekt.sql
--------------------------------------------------------------------------------
alw_strukturverbesserungen_suissemelio/wegebau_linie.sql
--------------------------------------------------------------------------------
alw_strukturverbesserungen_suissemelio/wasserversorgung_punkt.sql
--------------------------------------------------------------------------------
alw_strukturverbesserungen_suissemelio/elektroversorgung_linie.sql
--------------------------------------------------------------------------------
alw_strukturverbesserungen_suissemelio/bewaesserung_linie.sql
--------------------------------------------------------------------------------
alw_strukturverbesserungen_suissemelio/bewaesserung_flaeche.sql
--------------------------------------------------------------------------------
alw_strukturverbesserungen_suissemelio/oekologie_flaeche.sql
--------------------------------------------------------------------------------
agi_lkmap_pub/sql/wasser/delete.sql
--------------------------------------------------------------------------------
agi_lkmap_pub/sql/wasser/lkpunkt.sql
--------------------------------------------------------------------------------
agi_lkmap_pub/sql/wasser/lkflaeche.sql
--------------------------------------------------------------------------------
agi_lkmap_pub/sql/wasser/lklinie.sql
--------------------------------------------------------------------------------
arp_mjpnl_gelan_update/mjpnl_update_vereinbarungen_gelan_kulturflaechen.sql
--------------------------------------------------------------------------------
arp_mjpnl_gelan_update/mjpnl_update_vereinbarungen_gelan_bewirtschafter.sql
--------------------------------------------------------------------------------
arp_mjpnl_gelan_update/update_betrieb_bff2-flaechen.sql
--------------------------------------------------------------------------------
arp_mjpnl_gelan_update/delete_gelandata_from_other_year.sql
--------------------------------------------------------------------------------
arp_mjpnl_gelan_update/mjpnl_update_vereinbarungen_gelan_bewirtschaftungseinheiten.sql
--------------------------------------------------------------------------------
agi_inventar_hoheitsgrenzen_pub/agi_inventar_hoheitsgrenzen_pub_kantonsgrenzstein.sql
--------------------------------------------------------------------------------
afu_ara_einzugsgebiete_pub/afu_ara_einzugsgebiete.sql
--------------------------------------------------------------------------------
arp_sein_konfiguration_local/update_thema_gruppe.sql
--------------------------------------------------------------------------------
arp_sein_konfiguration_local/bundesinventar_amphibien_laichgebiete_import_shp.sql
class net.sf.jsqlparser.JSQLParserException
net.sf.jsqlparser.parser.ParseException: Encountered unexpected token: "LOAD" <S_IDENTIFIER>
    at line 1, column 1.

Was expecting one of:

    "("
    "ALTER"
    "ANALYZE"
    "BEGIN"
    "CALL"
    "COMMENT"
    "COMMIT"
    "CREATE"
    "DECLARE"
    "DELETE"
    "DESC"
    "DESCRIBE"
    "DROP"
    "EXEC"
    "EXECUTE"
    "EXPLAIN"
    "FROM"
    "GRANT"
    "IF"
    "INSERT"
    "MERGE"
    "PURGE"
    "REFRESH"
    "RENAME"
    "REPLACE"
    "RESET"
    "ROLLBACK"
    "SAVEPOINT"
    "SET"
    "SHOW"
    "SUMMARIZE"
    "TABLE"
    "TRUNCATE"
    "UPDATE"
    "UPSERT"
    "USE"
    "VALUE"
    "VALUES"
    "WITH"
    <K_SELECT>

Error parsing: LOAD spatial (net.sf.jsqlparser.parser.ParseException: Encountered unexpected token: "LOAD" <S_IDENTIFIER>
    at line 1, column 1.

Was expecting one of:

    "("
    "ALTER"
    "ANALYZE"
    "BEGIN"
    "CALL"
    "COMMENT"
    "COMMIT"
    "CREATE"
    "DECLARE"
    "DELETE"
    "DESC"
    "DESCRIBE"
    "DROP"
    "EXEC"
    "EXECUTE"
    "EXPLAIN"
    "FROM"
    "GRANT"
    "IF"
    "INSERT"
    "MERGE"
    "PURGE"
    "REFRESH"
    "RENAME"
    "REPLACE"
    "RESET"
    "ROLLBACK"
    "SAVEPOINT"
    "SET"
    "SHOW"
    "SUMMARIZE"
    "TABLE"
    "TRUNCATE"
    "UPDATE"
    "UPSERT"
    "USE"
    "VALUE"
    "VALUES"
    "WITH"
    <K_SELECT>
)
********************************************************************************
--------------------------------------------------------------------------------
arp_sein_konfiguration_local/bundesinventar_flachmmore_import_shp.sql
class net.sf.jsqlparser.JSQLParserException
net.sf.jsqlparser.parser.ParseException: Encountered unexpected token: "LOAD" <S_IDENTIFIER>
    at line 1, column 1.

Was expecting one of:

    "("
    "ALTER"
    "ANALYZE"
    "BEGIN"
    "CALL"
    "COMMENT"
    "COMMIT"
    "CREATE"
    "DECLARE"
    "DELETE"
    "DESC"
    "DESCRIBE"
    "DROP"
    "EXEC"
    "EXECUTE"
    "EXPLAIN"
    "FROM"
    "GRANT"
    "IF"
    "INSERT"
    "MERGE"
    "PURGE"
    "REFRESH"
    "RENAME"
    "REPLACE"
    "RESET"
    "ROLLBACK"
    "SAVEPOINT"
    "SET"
    "SHOW"
    "SUMMARIZE"
    "TABLE"
    "TRUNCATE"
    "UPDATE"
    "UPSERT"
    "USE"
    "VALUE"
    "VALUES"
    "WITH"
    <K_SELECT>

Error parsing: LOAD spatial (net.sf.jsqlparser.parser.ParseException: Encountered unexpected token: "LOAD" <S_IDENTIFIER>
    at line 1, column 1.

Was expecting one of:

    "("
    "ALTER"
    "ANALYZE"
    "BEGIN"
    "CALL"
    "COMMENT"
    "COMMIT"
    "CREATE"
    "DECLARE"
    "DELETE"
    "DESC"
    "DESCRIBE"
    "DROP"
    "EXEC"
    "EXECUTE"
    "EXPLAIN"
    "FROM"
    "GRANT"
    "IF"
    "INSERT"
    "MERGE"
    "PURGE"
    "REFRESH"
    "RENAME"
    "REPLACE"
    "RESET"
    "ROLLBACK"
    "SAVEPOINT"
    "SET"
    "SHOW"
    "SUMMARIZE"
    "TABLE"
    "TRUNCATE"
    "UPDATE"
    "UPSERT"
    "USE"
    "VALUE"
    "VALUES"
    "WITH"
    <K_SELECT>
)
********************************************************************************
--------------------------------------------------------------------------------
arp_sein_konfiguration_local/transfer_grundlagen.sql
--------------------------------------------------------------------------------
arp_sein_konfiguration_local/bundesinventar_vogelreservate_import_shp.sql
--------------------------------------------------------------------------------
arp_sein_konfiguration_local/postgis_agglo_massnahmen_gen4_import.sql
--------------------------------------------------------------------------------
arp_sein_konfiguration_local/create_table_duckdb.sql
--------------------------------------------------------------------------------
arp_sein_konfiguration_local/postgis_agglo_massnahmen_gen1_import.sql
--------------------------------------------------------------------------------
arp_sein_konfiguration_local/clean_tables.sql
--------------------------------------------------------------------------------
arp_sein_konfiguration_local/bundesinventar_amphibien_wanderobjekte_import_shp.sql
class net.sf.jsqlparser.JSQLParserException
net.sf.jsqlparser.parser.ParseException: Encountered unexpected token: "LOAD" <S_IDENTIFIER>
    at line 1, column 1.

Was expecting one of:

    "("
    "ALTER"
    "ANALYZE"
    "BEGIN"
    "CALL"
    "COMMENT"
    "COMMIT"
    "CREATE"
    "DECLARE"
    "DELETE"
    "DESC"
    "DESCRIBE"
    "DROP"
    "EXEC"
    "EXECUTE"
    "EXPLAIN"
    "FROM"
    "GRANT"
    "IF"
    "INSERT"
    "MERGE"
    "PURGE"
    "REFRESH"
    "RENAME"
    "REPLACE"
    "RESET"
    "ROLLBACK"
    "SAVEPOINT"
    "SET"
    "SHOW"
    "SUMMARIZE"
    "TABLE"
    "TRUNCATE"
    "UPDATE"
    "UPSERT"
    "USE"
    "VALUE"
    "VALUES"
    "WITH"
    <K_SELECT>

Error parsing: LOAD spatial (net.sf.jsqlparser.parser.ParseException: Encountered unexpected token: "LOAD" <S_IDENTIFIER>
    at line 1, column 1.

Was expecting one of:

    "("
    "ALTER"
    "ANALYZE"
    "BEGIN"
    "CALL"
    "COMMENT"
    "COMMIT"
    "CREATE"
    "DECLARE"
    "DELETE"
    "DESC"
    "DESCRIBE"
    "DROP"
    "EXEC"
    "EXECUTE"
    "EXPLAIN"
    "FROM"
    "GRANT"
    "IF"
    "INSERT"
    "MERGE"
    "PURGE"
    "REFRESH"
    "RENAME"
    "REPLACE"
    "RESET"
    "ROLLBACK"
    "SAVEPOINT"
    "SET"
    "SHOW"
    "SUMMARIZE"
    "TABLE"
    "TRUNCATE"
    "UPDATE"
    "UPSERT"
    "USE"
    "VALUE"
    "VALUES"
    "WITH"
    <K_SELECT>
)
********************************************************************************
--------------------------------------------------------------------------------
arp_sein_konfiguration_local/bundesinventar_trockenwiesen_trockenweiden_import_shp.sql
--------------------------------------------------------------------------------
arp_sein_konfiguration_local/attach_pubdb.sql
class net.sf.jsqlparser.JSQLParserException
net.sf.jsqlparser.parser.ParseException: Encountered unexpected token: "ATTACH" <S_IDENTIFIER>
    at line 1, column 1.

Was expecting one of:

    "("
    "ALTER"
    "ANALYZE"
    "BEGIN"
    "CALL"
    "COMMENT"
    "COMMIT"
    "CREATE"
    "DECLARE"
    "DELETE"
    "DESC"
    "DESCRIBE"
    "DROP"
    "EXEC"
    "EXECUTE"
    "EXPLAIN"
    "FROM"
    "GRANT"
    "IF"
    "INSERT"
    "MERGE"
    "PURGE"
    "REFRESH"
    "RENAME"
    "REPLACE"
    "RESET"
    "ROLLBACK"
    "SAVEPOINT"
    "SET"
    "SHOW"
    "SUMMARIZE"
    "TABLE"
    "TRUNCATE"
    "UPDATE"
    "UPSERT"
    "USE"
    "VALUE"
    "VALUES"
    "WITH"
    <K_SELECT>

Error parsing: ATTACH xxx_1 AS pubdb (TYPE POSTGRES, READ_ONLY) (net.sf.jsqlparser.parser.ParseException: Encountered unexpected token: "ATTACH" <S_IDENTIFIER>
    at line 1, column 1.

Was expecting one of:

    "("
    "ALTER"
    "ANALYZE"
    "BEGIN"
    "CALL"
    "COMMENT"
    "COMMIT"
    "CREATE"
    "DECLARE"
    "DELETE"
    "DESC"
    "DESCRIBE"
    "DROP"
    "EXEC"
    "EXECUTE"
    "EXPLAIN"
    "FROM"
    "GRANT"
    "IF"
    "INSERT"
    "MERGE"
    "PURGE"
    "REFRESH"
    "RENAME"
    "REPLACE"
    "RESET"
    "ROLLBACK"
    "SAVEPOINT"
    "SET"
    "SHOW"
    "SUMMARIZE"
    "TABLE"
    "TRUNCATE"
    "UPDATE"
    "UPSERT"
    "USE"
    "VALUE"
    "VALUES"
    "WITH"
    <K_SELECT>
)
********************************************************************************
--------------------------------------------------------------------------------
arp_sein_konfiguration_local/postgis_agglo_massnahmen_gen3_import.sql
--------------------------------------------------------------------------------
arp_sein_konfiguration_local/bundesinventar_auen_import_shp.sql
--------------------------------------------------------------------------------
arp_sein_konfiguration_local/bundesinventar_bln_import_shp.sql
--------------------------------------------------------------------------------
arp_sein_konfiguration_local/load_extensions.sql
class net.sf.jsqlparser.JSQLParserException
net.sf.jsqlparser.parser.ParseException: Encountered unexpected token: "LOAD" <S_IDENTIFIER>
    at line 2, column 1.

Was expecting one of:

    "("
    "ALTER"
    "ANALYZE"
    "BEGIN"
    "CALL"
    "COMMENT"
    "COMMIT"
    "CREATE"
    "DECLARE"
    "DELETE"
    "DESC"
    "DESCRIBE"
    "DROP"
    "EXEC"
    "EXECUTE"
    "EXPLAIN"
    "FROM"
    "GRANT"
    "IF"
    "INSERT"
    "MERGE"
    "PURGE"
    "REFRESH"
    "RENAME"
    "REPLACE"
    "RESET"
    "ROLLBACK"
    "SAVEPOINT"
    "SET"
    "SHOW"
    "SUMMARIZE"
    "TABLE"
    "TRUNCATE"
    "UPDATE"
    "UPSERT"
    "USE"
    "VALUE"
    "VALUES"
    "WITH"
    <K_SELECT>

Error parsing: --- DuckDB Extensions ---
LOAD spatial (net.sf.jsqlparser.parser.ParseException: Encountered unexpected token: "LOAD" <S_IDENTIFIER>
    at line 2, column 1.

Was expecting one of:

    "("
    "ALTER"
    "ANALYZE"
    "BEGIN"
    "CALL"
    "COMMENT"
    "COMMIT"
    "CREATE"
    "DECLARE"
    "DELETE"
    "DESC"
    "DESCRIBE"
    "DROP"
    "EXEC"
    "EXECUTE"
    "EXPLAIN"
    "FROM"
    "GRANT"
    "IF"
    "INSERT"
    "MERGE"
    "PURGE"
    "REFRESH"
    "RENAME"
    "REPLACE"
    "RESET"
    "ROLLBACK"
    "SAVEPOINT"
    "SET"
    "SHOW"
    "SUMMARIZE"
    "TABLE"
    "TRUNCATE"
    "UPDATE"
    "UPSERT"
    "USE"
    "VALUE"
    "VALUES"
    "WITH"
    <K_SELECT>
)
********************************************************************************
class net.sf.jsqlparser.JSQLParserException
net.sf.jsqlparser.parser.ParseException: Encountered unexpected token: "LOAD" <S_IDENTIFIER>
    at line 1, column 1.

Was expecting one of:

    "("
    "ALTER"
    "ANALYZE"
    "BEGIN"
    "CALL"
    "COMMENT"
    "COMMIT"
    "CREATE"
    "DECLARE"
    "DELETE"
    "DESC"
    "DESCRIBE"
    "DROP"
    "EXEC"
    "EXECUTE"
    "EXPLAIN"
    "FROM"
    "GRANT"
    "IF"
    "INSERT"
    "MERGE"
    "PURGE"
    "REFRESH"
    "RENAME"
    "REPLACE"
    "RESET"
    "ROLLBACK"
    "SAVEPOINT"
    "SET"
    "SHOW"
    "SUMMARIZE"
    "TABLE"
    "TRUNCATE"
    "UPDATE"
    "UPSERT"
    "USE"
    "VALUE"
    "VALUES"
    "WITH"
    <K_SELECT>

Error parsing: LOAD httpfs (net.sf.jsqlparser.parser.ParseException: Encountered unexpected token: "LOAD" <S_IDENTIFIER>
    at line 1, column 1.

Was expecting one of:

    "("
    "ALTER"
    "ANALYZE"
    "BEGIN"
    "CALL"
    "COMMENT"
    "COMMIT"
    "CREATE"
    "DECLARE"
    "DELETE"
    "DESC"
    "DESCRIBE"
    "DROP"
    "EXEC"
    "EXECUTE"
    "EXPLAIN"
    "FROM"
    "GRANT"
    "IF"
    "INSERT"
    "MERGE"
    "PURGE"
    "REFRESH"
    "RENAME"
    "REPLACE"
    "RESET"
    "ROLLBACK"
    "SAVEPOINT"
    "SET"
    "SHOW"
    "SUMMARIZE"
    "TABLE"
    "TRUNCATE"
    "UPDATE"
    "UPSERT"
    "USE"
    "VALUE"
    "VALUES"
    "WITH"
    <K_SELECT>
)
********************************************************************************
class net.sf.jsqlparser.JSQLParserException
net.sf.jsqlparser.parser.ParseException: Encountered unexpected token: "LOAD" <S_IDENTIFIER>
    at line 1, column 1.

Was expecting one of:

    "("
    "ALTER"
    "ANALYZE"
    "BEGIN"
    "CALL"
    "COMMENT"
    "COMMIT"
    "CREATE"
    "DECLARE"
    "DELETE"
    "DESC"
    "DESCRIBE"
    "DROP"
    "EXEC"
    "EXECUTE"
    "EXPLAIN"
    "FROM"
    "GRANT"
    "IF"
    "INSERT"
    "MERGE"
    "PURGE"
    "REFRESH"
    "RENAME"
    "REPLACE"
    "RESET"
    "ROLLBACK"
    "SAVEPOINT"
    "SET"
    "SHOW"
    "SUMMARIZE"
    "TABLE"
    "TRUNCATE"
    "UPDATE"
    "UPSERT"
    "USE"
    "VALUE"
    "VALUES"
    "WITH"
    <K_SELECT>

Error parsing: LOAD postgres (net.sf.jsqlparser.parser.ParseException: Encountered unexpected token: "LOAD" <S_IDENTIFIER>
    at line 1, column 1.

Was expecting one of:

    "("
    "ALTER"
    "ANALYZE"
    "BEGIN"
    "CALL"
    "COMMENT"
    "COMMIT"
    "CREATE"
    "DECLARE"
    "DELETE"
    "DESC"
    "DESCRIBE"
    "DROP"
    "EXEC"
    "EXECUTE"
    "EXPLAIN"
    "FROM"
    "GRANT"
    "IF"
    "INSERT"
    "MERGE"
    "PURGE"
    "REFRESH"
    "RENAME"
    "REPLACE"
    "RESET"
    "ROLLBACK"
    "SAVEPOINT"
    "SET"
    "SHOW"
    "SUMMARIZE"
    "TABLE"
    "TRUNCATE"
    "UPDATE"
    "UPSERT"
    "USE"
    "VALUE"
    "VALUES"
    "WITH"
    <K_SELECT>
)
********************************************************************************
--------------------------------------------------------------------------------
arp_sein_konfiguration_local/detach_db.sql
class net.sf.jsqlparser.JSQLParserException
net.sf.jsqlparser.parser.ParseException: Encountered unexpected token: "DETACH" <S_IDENTIFIER>
    at line 1, column 1.

Was expecting one of:

    "("
    "ALTER"
    "ANALYZE"
    "BEGIN"
    "CALL"
    "COMMENT"
    "COMMIT"
    "CREATE"
    "DECLARE"
    "DELETE"
    "DESC"
    "DESCRIBE"
    "DROP"
    "EXEC"
    "EXECUTE"
    "EXPLAIN"
    "FROM"
    "GRANT"
    "IF"
    "INSERT"
    "MERGE"
    "PURGE"
    "REFRESH"
    "RENAME"
    "REPLACE"
    "RESET"
    "ROLLBACK"
    "SAVEPOINT"
    "SET"
    "SHOW"
    "SUMMARIZE"
    "TABLE"
    "TRUNCATE"
    "UPDATE"
    "UPSERT"
    "USE"
    "VALUE"
    "VALUES"
    "WITH"
    <K_SELECT>

Error parsing: DETACH editdb (net.sf.jsqlparser.parser.ParseException: Encountered unexpected token: "DETACH" <S_IDENTIFIER>
    at line 1, column 1.

Was expecting one of:

    "("
    "ALTER"
    "ANALYZE"
    "BEGIN"
    "CALL"
    "COMMENT"
    "COMMIT"
    "CREATE"
    "DECLARE"
    "DELETE"
    "DESC"
    "DESCRIBE"
    "DROP"
    "EXEC"
    "EXECUTE"
    "EXPLAIN"
    "FROM"
    "GRANT"
    "IF"
    "INSERT"
    "MERGE"
    "PURGE"
    "REFRESH"
    "RENAME"
    "REPLACE"
    "RESET"
    "ROLLBACK"
    "SAVEPOINT"
    "SET"
    "SHOW"
    "SUMMARIZE"
    "TABLE"
    "TRUNCATE"
    "UPDATE"
    "UPSERT"
    "USE"
    "VALUE"
    "VALUES"
    "WITH"
    <K_SELECT>
)
********************************************************************************
class net.sf.jsqlparser.JSQLParserException
net.sf.jsqlparser.parser.ParseException: Encountered unexpected token: "DETACH" <S_IDENTIFIER>
    at line 1, column 1.

Was expecting one of:

    "("
    "ALTER"
    "ANALYZE"
    "BEGIN"
    "CALL"
    "COMMENT"
    "COMMIT"
    "CREATE"
    "DECLARE"
    "DELETE"
    "DESC"
    "DESCRIBE"
    "DROP"
    "EXEC"
    "EXECUTE"
    "EXPLAIN"
    "FROM"
    "GRANT"
    "IF"
    "INSERT"
    "MERGE"
    "PURGE"
    "REFRESH"
    "RENAME"
    "REPLACE"
    "RESET"
    "ROLLBACK"
    "SAVEPOINT"
    "SET"
    "SHOW"
    "SUMMARIZE"
    "TABLE"
    "TRUNCATE"
    "UPDATE"
    "UPSERT"
    "USE"
    "VALUE"
    "VALUES"
    "WITH"
    <K_SELECT>

Error parsing: DETACH pubdb (net.sf.jsqlparser.parser.ParseException: Encountered unexpected token: "DETACH" <S_IDENTIFIER>
    at line 1, column 1.

Was expecting one of:

    "("
    "ALTER"
    "ANALYZE"
    "BEGIN"
    "CALL"
    "COMMENT"
    "COMMIT"
    "CREATE"
    "DECLARE"
    "DELETE"
    "DESC"
    "DESCRIBE"
    "DROP"
    "EXEC"
    "EXECUTE"
    "EXPLAIN"
    "FROM"
    "GRANT"
    "IF"
    "INSERT"
    "MERGE"
    "PURGE"
    "REFRESH"
    "RENAME"
    "REPLACE"
    "RESET"
    "ROLLBACK"
    "SAVEPOINT"
    "SET"
    "SHOW"
    "SUMMARIZE"
    "TABLE"
    "TRUNCATE"
    "UPDATE"
    "UPSERT"
    "USE"
    "VALUE"
    "VALUES"
    "WITH"
    <K_SELECT>
)
********************************************************************************
--------------------------------------------------------------------------------
arp_sein_konfiguration_local/objektinfos_grundlagen_import_postgis.sql
--------------------------------------------------------------------------------
arp_sein_konfiguration_local/postgis_agglo_massnahmen_gen2_import.sql
--------------------------------------------------------------------------------
arp_sein_konfiguration_local/datenaggregation.sql
--------------------------------------------------------------------------------
arp_sein_konfiguration_local/attach_editdb.sql
class net.sf.jsqlparser.JSQLParserException
net.sf.jsqlparser.parser.ParseException: Encountered unexpected token: "ATTACH" <S_IDENTIFIER>
    at line 1, column 1.

Was expecting one of:

    "("
    "ALTER"
    "ANALYZE"
    "BEGIN"
    "CALL"
    "COMMENT"
    "COMMIT"
    "CREATE"
    "DECLARE"
    "DELETE"
    "DESC"
    "DESCRIBE"
    "DROP"
    "EXEC"
    "EXECUTE"
    "EXPLAIN"
    "FROM"
    "GRANT"
    "IF"
    "INSERT"
    "MERGE"
    "PURGE"
    "REFRESH"
    "RENAME"
    "REPLACE"
    "RESET"
    "ROLLBACK"
    "SAVEPOINT"
    "SET"
    "SHOW"
    "SUMMARIZE"
    "TABLE"
    "TRUNCATE"
    "UPDATE"
    "UPSERT"
    "USE"
    "VALUE"
    "VALUES"
    "WITH"
    <K_SELECT>

Error parsing: ATTACH xxx_1 AS editdb (TYPE POSTGRES, READ_ONLY) (net.sf.jsqlparser.parser.ParseException: Encountered unexpected token: "ATTACH" <S_IDENTIFIER>
    at line 1, column 1.

Was expecting one of:

    "("
    "ALTER"
    "ANALYZE"
    "BEGIN"
    "CALL"
    "COMMENT"
    "COMMIT"
    "CREATE"
    "DECLARE"
    "DELETE"
    "DESC"
    "DESCRIBE"
    "DROP"
    "EXEC"
    "EXECUTE"
    "EXPLAIN"
    "FROM"
    "GRANT"
    "IF"
    "INSERT"
    "MERGE"
    "PURGE"
    "REFRESH"
    "RENAME"
    "REPLACE"
    "RESET"
    "ROLLBACK"
    "SAVEPOINT"
    "SET"
    "SHOW"
    "SUMMARIZE"
    "TABLE"
    "TRUNCATE"
    "UPDATE"
    "UPSERT"
    "USE"
    "VALUE"
    "VALUES"
    "WITH"
    <K_SELECT>
)
********************************************************************************
--------------------------------------------------------------------------------
arp_sein_konfiguration_local/bundesinventar_hochmoore_import_shp.sql
class net.sf.jsqlparser.JSQLParserException
net.sf.jsqlparser.parser.ParseException: Encountered unexpected token: "LOAD" <S_IDENTIFIER>
    at line 1, column 1.

Was expecting one of:

    "("
    "ALTER"
    "ANALYZE"
    "BEGIN"
    "CALL"
    "COMMENT"
    "COMMIT"
    "CREATE"
    "DECLARE"
    "DELETE"
    "DESC"
    "DESCRIBE"
    "DROP"
    "EXEC"
    "EXECUTE"
    "EXPLAIN"
    "FROM"
    "GRANT"
    "IF"
    "INSERT"
    "MERGE"
    "PURGE"
    "REFRESH"
    "RENAME"
    "REPLACE"
    "RESET"
    "ROLLBACK"
    "SAVEPOINT"
    "SET"
    "SHOW"
    "SUMMARIZE"
    "TABLE"
    "TRUNCATE"
    "UPDATE"
    "UPSERT"
    "USE"
    "VALUE"
    "VALUES"
    "WITH"
    <K_SELECT>

Error parsing: LOAD spatial (net.sf.jsqlparser.parser.ParseException: Encountered unexpected token: "LOAD" <S_IDENTIFIER>
    at line 1, column 1.

Was expecting one of:

    "("
    "ALTER"
    "ANALYZE"
    "BEGIN"
    "CALL"
    "COMMENT"
    "COMMIT"
    "CREATE"
    "DECLARE"
    "DELETE"
    "DESC"
    "DESCRIBE"
    "DROP"
    "EXEC"
    "EXECUTE"
    "EXPLAIN"
    "FROM"
    "GRANT"
    "IF"
    "INSERT"
    "MERGE"
    "PURGE"
    "REFRESH"
    "RENAME"
    "REPLACE"
    "RESET"
    "ROLLBACK"
    "SAVEPOINT"
    "SET"
    "SHOW"
    "SUMMARIZE"
    "TABLE"
    "TRUNCATE"
    "UPDATE"
    "UPSERT"
    "USE"
    "VALUE"
    "VALUES"
    "WITH"
    <K_SELECT>
)
********************************************************************************
--------------------------------------------------------------------------------
alw_fruchtfolgeflaechen_export_ai/qualitaet.sql
--------------------------------------------------------------------------------
alw_fruchtfolgeflaechen_export_ai/fruchtfolgeflaechen.sql
--------------------------------------------------------------------------------
alw_fruchtfolgeflaechen_export_ai/truncate_qualitaet.sql
--------------------------------------------------------------------------------
alw_fruchtfolgeflaechen_export_ai/metadaten.sql
--------------------------------------------------------------------------------
afu_baugrundklassen_pub/afu_baugrundklassen_pub.sql
--------------------------------------------------------------------------------
alw_landwirtschaft_tierhaltung_pub/basket.sql
--------------------------------------------------------------------------------
alw_landwirtschaft_tierhaltung_pub/kultur_punktelement.sql
--------------------------------------------------------------------------------
alw_landwirtschaft_tierhaltung_pub/tierstandorte.sql
--------------------------------------------------------------------------------
alw_landwirtschaft_tierhaltung_pub/kultur_flaeche.sql
--------------------------------------------------------------------------------
alw_landwirtschaft_tierhaltung_pub/dataset.sql
--------------------------------------------------------------------------------
alw_landwirtschaft_tierhaltung_pub/bewirtschaftungseinheit.sql
--------------------------------------------------------------------------------
alw_landwirtschaft_tierhaltung_pub/bff_qualitaet.sql
--------------------------------------------------------------------------------
arp_naturschutzobjekte_pub/flechte.sql
--------------------------------------------------------------------------------
arp_naturschutzobjekte_pub/flachmoor.sql
--------------------------------------------------------------------------------
arp_naturschutzobjekte_pub/karch_objekt.sql
--------------------------------------------------------------------------------
arp_naturschutzobjekte_pub/blaue_flaechen_grenchen.sql
--------------------------------------------------------------------------------
arp_naturschutzobjekte_pub/amphibienstandort.sql
--------------------------------------------------------------------------------
arp_naturschutzobjekte_pub/moos.sql
--------------------------------------------------------------------------------
arp_mjpnl_v2_auszahlung/update_mjpnl_abrechnung_per_vereinbarung.sql
--------------------------------------------------------------------------------
arp_mjpnl_v2_auszahlung/update_mjpnl_abrechnung_per_leistung.sql
--------------------------------------------------------------------------------
arp_mjpnl_v2_auszahlung/update_mjpnl_abrechnung_per_bewirtschafter.sql
--------------------------------------------------------------------------------
afu_schutzbauten_pub/select_schutzbautenobjekt_wasser_linie.sql
--------------------------------------------------------------------------------
afu_schutzbauten_pub/select_schutzbautenobjekt_sturz_linie.sql
--------------------------------------------------------------------------------
afu_schutzbauten_pub/select_schutzbautenobjekt_rutschung_punkt.sql
--------------------------------------------------------------------------------
afu_schutzbauten_pub/select_schutzbautenobjekt_wasser_punkt.sql
--------------------------------------------------------------------------------
afu_schutzbauten_pub/select_schutzbautenobjekt_sturz_punkt.sql
--------------------------------------------------------------------------------
afu_schutzbauten_pub/select_schutzbautenobjekt_sturz_flaeche.sql
--------------------------------------------------------------------------------
afu_schutzbauten_pub/select_schutzbautenobjekt_rutschung_linie.sql
--------------------------------------------------------------------------------
afu_schutzbauten_pub/select_schutzbautenobjekt_rutschung_flaeche.sql
--------------------------------------------------------------------------------
afu_schutzbauten_pub/select_schutzbautenobjekt_wasser_flaeche.sql
--------------------------------------------------------------------------------
arp_agglomerationsprogramme_pub/arp_agglomerationsprogramme_pub_agglomrtnsprgrmme_massnahme_punkt.sql
--------------------------------------------------------------------------------
arp_agglomerationsprogramme_pub/arp_agglomerationsprogramme_pub_agglomrtnsprgrmme_massnahme.sql
--------------------------------------------------------------------------------
arp_agglomerationsprogramme_pub/arp_agglomerationsprogramme_pub_agglomrtnsprgrmme_massnahme_flaeche.sql
--------------------------------------------------------------------------------
arp_agglomerationsprogramme_pub/arp_agglomerationsprogramme_pub_agglomrtnsprgrmme_massnahme_linie.sql
--------------------------------------------------------------------------------
arp_agglomerationsprogramme_pub/arp_agglomerationsprogramme_pub_agglomrtnsprgrmme_uebersicht_gemeinde.sql
--------------------------------------------------------------------------------
afu_quellen_ungefasst_csvimport/update_sql/geom_koord.sql
--------------------------------------------------------------------------------
afu_quellen_ungefasst_csvimport/update_sql/defaults.sql
--------------------------------------------------------------------------------
afu_quellen_ungefasst_csvimport/update_sql/domain.sql
--------------------------------------------------------------------------------
afu_quellen_ungefasst_csvimport/update_sql/dates.sql
--------------------------------------------------------------------------------
afu_quellen_ungefasst_csvimport/update_sql/gemeinde.sql
--------------------------------------------------------------------------------
afu_quellen_ungefasst_csvimport/update_sql/_domain_map.sql
--------------------------------------------------------------------------------
afu_quellen_ungefasst_csvimport/update_sql/gemeinde_stump.sql
--------------------------------------------------------------------------------
afu_quellen_ungefasst_csvimport/replace_quellen.sql
class java.lang.ClassCastException
class net.sf.jsqlparser.statement.delete.ParenthesedDelete cannot be cast to class net.sf.jsqlparser.statement.select.ParenthesedSelect (net.sf.jsqlparser.statement.delete.ParenthesedDelete and net.sf.jsqlparser.statement.select.ParenthesedSelect are in unnamed module of loader 'app')
Error parsing: WITH 

existing AS (
    SELECT 
        q.id_quelle
    FROM 
        xxx_1.quelle_ungefasst q
    JOIN 
        xxx_2.csv_import i ON q.id_quelle = i.id_quelle
),

delete_existing AS (
    DELETE FROM 
        xxx_1.quelle_ungefasst q
    USING 
        existing
    WHERE 
        q.id_quelle = existing.id_quelle
)

INSERT INTO 
    xxx_1.quelle_ungefasst (
        id_quelle, 
        flurname, 
        quellenname, 
        hoehe, 
        austrittsform, 
        quellgroesse, 
        schuettungsverhalten, 
        quellschuettung, 
        vernetzung,
        austrittsanzahl, 
        bemerkungen, 
        fassung, 
        wasserentnahme, 
        trittschaeden, 
        sommerbeschattung, 
        substrate, 
        revitobjekt, 
        gesamtbewertung,
        punkt,
        datum,
        gemeindename,
        x_koordinate,
        y_koordinate,
        bioerhebung,
        importdatum,
        dok_url       
    )
SELECT 
    id_quelle, 
    flurname, 
    quellenname, 
    hoehe, 
    austrittsform, 
    quellgroesse, 
    schuettungsverhalten, 
    quellschuettung, 
    vernetzung,
    austrittsanzahl, 
    bemerkungen, 
    fassung, 
    wasserentnahme, 
    trittschaeden, 
    sommerbeschattung, 
    substrate, 
    revitobjekt, 
    gesamtbewertung,
    punkt,
    datum,
    gemeindename,
    x_koordinate,
    y_koordinate,
    bioerhebung,
    importdatum,
    concat('https://geo.so.ch/docs/ch.so.afu.quellen_ungefasst.quellen/', id_quelle, '.pdf') AS dok_url  
FROM 
    xxx_2.csv_import (class net.sf.jsqlparser.statement.delete.ParenthesedDelete cannot be cast to class net.sf.jsqlparser.statement.select.ParenthesedSelect (net.sf.jsqlparser.statement.delete.ParenthesedDelete and net.sf.jsqlparser.statement.select.ParenthesedSelect are in unnamed module of loader 'app'))
********************************************************************************
--------------------------------------------------------------------------------
afu_quellen_ungefasst_csvimport/del_csv.sql
--------------------------------------------------------------------------------
alw_tiergesundheit_pflanzengesundheit_massnahmen_pub/alw_pflanzengesundheit_massnahmengebiet.sql
--------------------------------------------------------------------------------
alw_tiergesundheit_pflanzengesundheit_massnahmen_pub/alw_tiergesundheit_massnahmengebiet.sql
--------------------------------------------------------------------------------
alw_tiergesundheit_pflanzengesundheit_massnahmen_pub/alw_bienen_sperrgebiete.sql
--------------------------------------------------------------------------------
arp_mjpnl_v2_initialisierung/update_betrieb_bff2-flaechen.sql
--------------------------------------------------------------------------------
arp_mjpnl_v2_initialisierung/delete_gelandata_from_other_year.sql
--------------------------------------------------------------------------------
ada_denkmalschutz_pub/denkmal_polygon.sql
--------------------------------------------------------------------------------
ada_denkmalschutz_pub/denkmal_punkt.sql
--------------------------------------------------------------------------------
afu_abbaustellen_pub/deleteAppData.sql
class net.sf.jsqlparser.JSQLParserException
net.sf.jsqlparser.parser.ParseException: Encountered unexpected token: "xxx_1" <S_IDENTIFIER>
    at line 1, column 20.

Was expecting one of:

    ","
    <EOF>
    <ST_SEMICOLON>

Error parsing: SET search_path TO xxx_1 (net.sf.jsqlparser.parser.ParseException: Encountered unexpected token: "xxx_1" <S_IDENTIFIER>
    at line 1, column 20.

Was expecting one of:

    ","
    <EOF>
    <ST_SEMICOLON>
)
********************************************************************************
--------------------------------------------------------------------------------
afu_abbaustellen_pub/abbaustelle.sql
--------------------------------------------------------------------------------
hba_grundstuecke_pub/transfer_grundstuecke.sql
--------------------------------------------------------------------------------
hba_grundstuecke_pub/truncate_table.sql
--------------------------------------------------------------------------------
awjf_jagdreviere_jagdbanngebiete_pub/awjf_jagdreviere_jagdbanngebiete_pub_jagdbanngebiete_jagdbanngebiete.sql
--------------------------------------------------------------------------------
awjf_jagdreviere_jagdbanngebiete_pub/awjf_jagdreviere_jagdbanngebiete_pub_jagdreviere_jagdreviere.sql
--------------------------------------------------------------------------------
hba_gebaeude_pub/transfer_gebaeude.sql
--------------------------------------------------------------------------------
hba_gebaeude_pub/truncate_table.sql
--------------------------------------------------------------------------------
arp_auswertung_nutzungsplanung_pub/bauzonenstatistik_bebauungsstand_mit_zonen_und_lsgrenzen.sql
--------------------------------------------------------------------------------
arp_auswertung_nutzungsplanung_pub/bauzonenstatistik_bebauungsstand_pro_gemeinde.sql
--------------------------------------------------------------------------------
arp_auswertung_nutzungsplanung_pub/bauzonenstatistik_liegenschaft_nach_bebauungsstand_ohne_uebersteuerung.sql
--------------------------------------------------------------------------------
arp_auswertung_nutzungsplanung_pub/bauzonenstatistik_liegenschaft_nach_bebauungsstand.sql
--------------------------------------------------------------------------------
arp_auswertung_nutzungsplanung_pub/bauzonenstatistik_pruefscript_zusammenzuege_bauzonen_pro_gemeinde.sql
--------------------------------------------------------------------------------
arp_auswertung_nutzungsplanung_pub/bauzonenstatistik_uebertrag_uebersteuerung_bebauungsstand_editdb.sql
--------------------------------------------------------------------------------
arp_auswertung_nutzungsplanung_pub/bauzonenstatistik_bebauungsstand_mit_zonen_ohne_lsgrenzen.sql
--------------------------------------------------------------------------------
arp_auswertung_nutzungsplanung_pub/bauzonenstatistik_gines.sql
--------------------------------------------------------------------------------
afu_gewaesserschutz_zonen_areale_pub/gewaesserschutz_schutzareal.sql
--------------------------------------------------------------------------------
afu_gewaesserschutz_zonen_areale_pub/gewaesserschutz_schutzzone.sql
--------------------------------------------------------------------------------
afu_gewaesserschutz_zonen_areale_pub/delete_arp_nutzungsplanung_planregister_pub_grundwasserschutz.sql
--------------------------------------------------------------------------------
afu_gewaesserschutz_zonen_areale_pub/insert_arp_nutzungsplanung_planregister_pub_grundwasserschutz.sql
--------------------------------------------------------------------------------
afu_gewaesserschutz_zonen_areale_pub/gewaesserschutz_schutzzone_staging.sql
--------------------------------------------------------------------------------
afu_gewaesserschutz_zonen_areale_pub/delete_afu_gewaesserschutz_staging.sql
--------------------------------------------------------------------------------
afu_gewaesserschutz_zonen_areale_pub/delete_arp_nutzungsplanung_planregister_pub_doppelte_dokumente.sql
--------------------------------------------------------------------------------
afu_gewaesserschutz_zonen_areale_pub/gewaesserschutz_schutzareal_staging.sql
--------------------------------------------------------------------------------
arp_richtplan_fruchtfolgeflaechen_pub/arp_richtplan_pub_fruchtfolgeflaeche.sql
--------------------------------------------------------------------------------
afu_quellen_ungefasst_pub/updTxtCol.sql
class net.sf.jsqlparser.JSQLParserException
net.sf.jsqlparser.parser.ParseException: Encountered unexpected token: "xxx_1" <S_IDENTIFIER>
    at line 1, column 20.

Was expecting one of:

    ","
    <EOF>
    <ST_SEMICOLON>

Error parsing: SET search_path TO xxx_1, public (net.sf.jsqlparser.parser.ParseException: Encountered unexpected token: "xxx_1" <S_IDENTIFIER>
    at line 1, column 20.

Was expecting one of:

    ","
    <EOF>
    <ST_SEMICOLON>
)
********************************************************************************
--------------------------------------------------------------------------------
afu_quellen_ungefasst_pub/erhebungsstand.sql
--------------------------------------------------------------------------------
afu_quellen_ungefasst_pub/quelle.sql
--------------------------------------------------------------------------------
agi_polizeiregionen_pub/agi_polizeiregionen_pub.sql
--------------------------------------------------------------------------------
afu_oekomorphologie_csvimport/bauwerk/copy.sql
class net.sf.jsqlparser.JSQLParserException
net.sf.jsqlparser.parser.ParseException: Encountered unexpected token: "xxx_1" <S_IDENTIFIER>
    at line 1, column 20.

Was expecting one of:

    ","
    <EOF>
    <ST_SEMICOLON>

Error parsing: SET search_path TO xxx_1 (net.sf.jsqlparser.parser.ParseException: Encountered unexpected token: "xxx_1" <S_IDENTIFIER>
    at line 1, column 20.

Was expecting one of:

    ","
    <EOF>
    <ST_SEMICOLON>
)
********************************************************************************
--------------------------------------------------------------------------------
afu_oekomorphologie_csvimport/bauwerk/del_csv.sql
class net.sf.jsqlparser.JSQLParserException
net.sf.jsqlparser.parser.ParseException: Encountered unexpected token: "xxx_1" <S_IDENTIFIER>
    at line 1, column 20.

Was expecting one of:

    ","
    <EOF>
    <ST_SEMICOLON>

Error parsing: SET search_path TO xxx_1 (net.sf.jsqlparser.parser.ParseException: Encountered unexpected token: "xxx_1" <S_IDENTIFIER>
    at line 1, column 20.

Was expecting one of:

    ","
    <EOF>
    <ST_SEMICOLON>
)
********************************************************************************
--------------------------------------------------------------------------------
afu_oekomorphologie_csvimport/absturz/copy.sql
class net.sf.jsqlparser.JSQLParserException
net.sf.jsqlparser.parser.ParseException: Encountered unexpected token: "xxx_1" <S_IDENTIFIER>
    at line 1, column 20.

Was expecting one of:

    ","
    <EOF>
    <ST_SEMICOLON>

Error parsing: SET search_path TO xxx_1 (net.sf.jsqlparser.parser.ParseException: Encountered unexpected token: "xxx_1" <S_IDENTIFIER>
    at line 1, column 20.

Was expecting one of:

    ","
    <EOF>
    <ST_SEMICOLON>
)
********************************************************************************
--------------------------------------------------------------------------------
afu_oekomorphologie_csvimport/absturz/del_csv.sql
class net.sf.jsqlparser.JSQLParserException
net.sf.jsqlparser.parser.ParseException: Encountered unexpected token: "xxx_1" <S_IDENTIFIER>
    at line 1, column 20.

Was expecting one of:

    ","
    <EOF>
    <ST_SEMICOLON>

Error parsing: SET search_path TO xxx_1 (net.sf.jsqlparser.parser.ParseException: Encountered unexpected token: "xxx_1" <S_IDENTIFIER>
    at line 1, column 20.

Was expecting one of:

    ","
    <EOF>
    <ST_SEMICOLON>
)
********************************************************************************
--------------------------------------------------------------------------------
afu_oekomorphologie_csvimport/oekomorph/copy.sql
class net.sf.jsqlparser.JSQLParserException
net.sf.jsqlparser.parser.ParseException: Encountered unexpected token: "xxx_1" <S_IDENTIFIER>
    at line 1, column 20.

Was expecting one of:

    ","
    <EOF>
    <ST_SEMICOLON>

Error parsing: SET search_path TO xxx_1 (net.sf.jsqlparser.parser.ParseException: Encountered unexpected token: "xxx_1" <S_IDENTIFIER>
    at line 1, column 20.

Was expecting one of:

    ","
    <EOF>
    <ST_SEMICOLON>
)
********************************************************************************
--------------------------------------------------------------------------------
afu_oekomorphologie_csvimport/oekomorph/del_csv.sql
class net.sf.jsqlparser.JSQLParserException
net.sf.jsqlparser.parser.ParseException: Encountered unexpected token: "xxx_1" <S_IDENTIFIER>
    at line 1, column 20.

Was expecting one of:

    ","
    <EOF>
    <ST_SEMICOLON>

Error parsing: SET search_path TO xxx_1 (net.sf.jsqlparser.parser.ParseException: Encountered unexpected token: "xxx_1" <S_IDENTIFIER>
    at line 1, column 20.

Was expecting one of:

    ","
    <EOF>
    <ST_SEMICOLON>
)
********************************************************************************
--------------------------------------------------------------------------------
afu_oekomorphologie_csvimport/linien_event/set_fk.sql
class net.sf.jsqlparser.JSQLParserException
net.sf.jsqlparser.parser.ParseException: Encountered unexpected token: "xxx_1" <S_IDENTIFIER>
    at line 1, column 20.

Was expecting one of:

    ","
    <EOF>
    <ST_SEMICOLON>

Error parsing: SET search_path TO xxx_1 (net.sf.jsqlparser.parser.ParseException: Encountered unexpected token: "xxx_1" <S_IDENTIFIER>
    at line 1, column 20.

Was expecting one of:

    ","
    <EOF>
    <ST_SEMICOLON>
)
********************************************************************************
--------------------------------------------------------------------------------
afu_oekomorphologie_csvimport/linien_event/calc_geom.sql
class net.sf.jsqlparser.JSQLParserException
net.sf.jsqlparser.parser.ParseException: Encountered unexpected token: "xxx_1" <S_IDENTIFIER>
    at line 1, column 20.

Was expecting one of:

    ","
    <EOF>
    <ST_SEMICOLON>

Error parsing: SET search_path TO xxx_1 (net.sf.jsqlparser.parser.ParseException: Encountered unexpected token: "xxx_1" <S_IDENTIFIER>
    at line 1, column 20.

Was expecting one of:

    ","
    <EOF>
    <ST_SEMICOLON>
)
********************************************************************************
--------------------------------------------------------------------------------
afu_oekomorphologie_csvimport/punkt_event/set_fk.sql
class net.sf.jsqlparser.JSQLParserException
net.sf.jsqlparser.parser.ParseException: Encountered unexpected token: "xxx_1" <S_IDENTIFIER>
    at line 1, column 20.

Was expecting one of:

    ","
    <EOF>
    <ST_SEMICOLON>

Error parsing: SET search_path TO xxx_1 (net.sf.jsqlparser.parser.ParseException: Encountered unexpected token: "xxx_1" <S_IDENTIFIER>
    at line 1, column 20.

Was expecting one of:

    ","
    <EOF>
    <ST_SEMICOLON>
)
********************************************************************************
--------------------------------------------------------------------------------
afu_oekomorphologie_csvimport/punkt_event/calc_geom.sql
class net.sf.jsqlparser.JSQLParserException
net.sf.jsqlparser.parser.ParseException: Encountered unexpected token: "xxx_1" <S_IDENTIFIER>
    at line 1, column 20.

Was expecting one of:

    ","
    <EOF>
    <ST_SEMICOLON>

Error parsing: SET search_path TO xxx_1 (net.sf.jsqlparser.parser.ParseException: Encountered unexpected token: "xxx_1" <S_IDENTIFIER>
    at line 1, column 20.

Was expecting one of:

    ","
    <EOF>
    <ST_SEMICOLON>
)
********************************************************************************
--------------------------------------------------------------------------------
agi_layer_rollout/assert_consistent/missing_themepubs.sql
--------------------------------------------------------------------------------
agi_layer_rollout/assert_consistent/missing_subareas.sql
--------------------------------------------------------------------------------
agi_layer_rollout/assert_consistent/copy_prod_subareas.sql
--------------------------------------------------------------------------------
agi_layer_rollout/assert_consistent/copy_prod_themepubs.sql
--------------------------------------------------------------------------------
agi_layer_rollout/post_copy_on_int/publish_all_themepubs.sql
class net.sf.jsqlparser.JSQLParserException
net.sf.jsqlparser.parser.ParseException: Encountered unexpected token: "\n\n\n" <ST_SEMICOLON>
    at line 24, column 2.

Was expecting one of:

    "("
    ","
    "DELETE"
    "FROM"
    "INSERT"
    "MERGE"
    "UPDATE"
    "VALUE"
    "VALUES"
    "WITH"
    <K_SELECT>

Error parsing: -- Erstellt "künstlich" die Gebietsverknüpfungen für alle publizierten Themenbereitstellungen
WITH 

publ_themepubs AS (
    SELECT 
        id AS tp_id,
        coverage_ident AS tp_cov_ident
    FROM
        simi.simitheme_theme_publication
    WHERE 
            public_model_name IS NOT NULL
        AND 
            coverage_ident IS NOT NULL
),

publ_subareas AS (
    SELECT 
        id AS area_id,
        tp_id
    FROM
        simi.simitheme_sub_area s
    JOIN
        publ_themepubs t ON s.coverage_ident = t.tp_cov_ident    
)


INSERT INTO 
    simi.simitheme_published_sub_area(
        id, 
        update_ts, 
        create_ts, 
        created_by, 
        "version", 
        published, 
        prev_published, 
        sub_area_id, 
        theme_publication_id
    )
SELECT 
    gen_random_uuid() AS id,
    now() AS update_ts,
    now() AS create_ts,
    'admin' AS created_by,
    1 AS "version",
    now() AS published,
    now() AS prev_published,
    area_id AS sub_area_id,
    tp_id AS theme_publication_id
FROM 
    publ_subareas (net.sf.jsqlparser.parser.ParseException: Encountered unexpected token: "\n\n\n" <ST_SEMICOLON>
    at line 24, column 2.

Was expecting one of:

    "("
    ","
    "DELETE"
    "FROM"
    "INSERT"
    "MERGE"
    "UPDATE"
    "VALUE"
    "VALUES"
    "WITH"
    <K_SELECT>
)
********************************************************************************
--------------------------------------------------------------------------------
agi_layer_rollout/work/code_gen.sql
class net.sf.jsqlparser.JSQLParserException
net.sf.jsqlparser.parser.TokenMgrException: Lexical error at line 50, column 37.  Encountered: <EOF>
Error parsing: -- Helper-Skript zur Erzeugung der DELETE und TransferSet-Statements

WITH 

tbl AS (
	SELECT 
		'copy/data/' AS folder,
		tbl,
		ROW_NUMBER() OVER() AS rownum
	FROM (
		VALUES		
		('simitheme_theme_publication_custom_file_type_link')		
		,('simitheme_file_type')	
		,('simitheme_theme_publication')
		,('simitheme_theme')
		,('simitheme_sub_org')
		,('simitheme_agency')
		,('simitheme_org_unit')
	)
	AS t(tbl)
),

parts AS (
	SELECT 
		array_to_string( 
			array_remove( 
				string_to_array(tbl, '_'),
				split_part(tbl, '_', 1)
			),
			'_'
		) AS filename_prefix,
		'simi.' || tbl AS tbl_full,
		tbl.*
	FROM
		tbl
),

tset AS (
	SELECT
		concat('new TransferSet(''', folder, filename_prefix, '.sql', ''', ''', tbl_full, ''', false),') AS tset
	FROM 
		parts
	ORDER BY 
		rownum desc

),

del AS (
	SELECT
		concat('DELETE FROM ', tbl_full, ' (net.sf.jsqlparser.parser.TokenMgrException: Lexical error at line 50, column 37.  Encountered: <EOF>)
********************************************************************************
class net.sf.jsqlparser.JSQLParserException
net.sf.jsqlparser.parser.TokenMgrException: Lexical error at line 8, column 19.  Encountered: <EOF> after prefix "\') AS del\n\tFROM \n\t\tparts\n\tORDER BY \n\t\trownum asc\n)\n\nSELECT * FROM tset"
Error parsing: ') AS del
	FROM 
		parts
	ORDER BY 
		rownum asc
)

SELECT * FROM tset (net.sf.jsqlparser.parser.TokenMgrException: Lexical error at line 8, column 19.  Encountered: <EOF> after prefix "\') AS del\n\tFROM \n\t\tparts\n\tORDER BY \n\t\trownum asc\n)\n\nSELECT * FROM tset")
********************************************************************************
--------------------------------------------------------------------------------
agi_layer_rollout/copy/product/layer_group.sql
--------------------------------------------------------------------------------
agi_layer_rollout/copy/product/external_wms_service.sql
--------------------------------------------------------------------------------
agi_layer_rollout/copy/product/product_list.sql
--------------------------------------------------------------------------------
agi_layer_rollout/copy/product/data_product.sql
--------------------------------------------------------------------------------
agi_layer_rollout/copy/product/properties_in_list.sql
--------------------------------------------------------------------------------
agi_layer_rollout/copy/product/facade_layer.sql
--------------------------------------------------------------------------------
agi_layer_rollout/copy/product/single_actor.sql
--------------------------------------------------------------------------------
agi_layer_rollout/copy/product/map.sql
--------------------------------------------------------------------------------
agi_layer_rollout/copy/product/_delete_rows.sql
--------------------------------------------------------------------------------
agi_layer_rollout/copy/product/properties_in_facade.sql
--------------------------------------------------------------------------------
agi_layer_rollout/copy/product/data_product_pub_scope.sql
--------------------------------------------------------------------------------
agi_layer_rollout/copy/product/external_wms_layers.sql
--------------------------------------------------------------------------------
agi_layer_rollout/copy/iam/group_user_link.sql
--------------------------------------------------------------------------------
agi_layer_rollout/copy/iam/role_group_link.sql
--------------------------------------------------------------------------------
agi_layer_rollout/copy/iam/identity.sql
--------------------------------------------------------------------------------
agi_layer_rollout/copy/iam/role_user_link.sql
--------------------------------------------------------------------------------
agi_layer_rollout/copy/iam/permission.sql
--------------------------------------------------------------------------------
agi_layer_rollout/copy/iam/group.sql
--------------------------------------------------------------------------------
agi_layer_rollout/copy/iam/_delete_rows.sql
--------------------------------------------------------------------------------
agi_layer_rollout/copy/iam/role.sql
--------------------------------------------------------------------------------
agi_layer_rollout/copy/iam/user.sql
--------------------------------------------------------------------------------
agi_layer_rollout/copy/theme/org_unit.sql
--------------------------------------------------------------------------------
agi_layer_rollout/copy/theme/theme_publication.sql
--------------------------------------------------------------------------------
agi_layer_rollout/copy/theme/theme_publication_custom_file_type_link.sql
--------------------------------------------------------------------------------
agi_layer_rollout/copy/theme/file_type.sql
--------------------------------------------------------------------------------
agi_layer_rollout/copy/theme/theme.sql
--------------------------------------------------------------------------------
agi_layer_rollout/copy/theme/_delete_rows.sql
--------------------------------------------------------------------------------
agi_layer_rollout/copy/theme/sub_org.sql
--------------------------------------------------------------------------------
agi_layer_rollout/copy/theme/agency.sql
--------------------------------------------------------------------------------
agi_layer_rollout/copy/extended/relation.sql
--------------------------------------------------------------------------------
agi_layer_rollout/copy/extended/dependency.sql
--------------------------------------------------------------------------------
agi_layer_rollout/copy/extended/_delete_rows.sql
--------------------------------------------------------------------------------
agi_layer_rollout/copy/data/postgres_table.sql
--------------------------------------------------------------------------------
agi_layer_rollout/copy/data/data_set_view.sql
--------------------------------------------------------------------------------
agi_layer_rollout/copy/data/postgres_db.sql
--------------------------------------------------------------------------------
agi_layer_rollout/copy/data/view_field.sql
--------------------------------------------------------------------------------
agi_layer_rollout/copy/data/table_field.sql
--------------------------------------------------------------------------------
agi_layer_rollout/copy/data/db_schema.sql
--------------------------------------------------------------------------------
agi_layer_rollout/copy/data/table_view.sql
--------------------------------------------------------------------------------
agi_layer_rollout/copy/data/styleasset.sql
--------------------------------------------------------------------------------
agi_layer_rollout/copy/data/_delete_rows.sql
--------------------------------------------------------------------------------
agi_layer_rollout/copy/data/raster_ds.sql
--------------------------------------------------------------------------------
agi_layer_rollout/copy/data/raster_view.sql
--------------------------------------------------------------------------------
agi_layer_rollout/post_copy/restore_pub_dates.sql
class net.sf.jsqlparser.JSQLParserException
net.sf.jsqlparser.parser.ParseException: Encountered unexpected token:<EOF>
    at line 55, column 24.

Was expecting one of:

    "("
    ","
    "DELETE"
    "FROM"
    "INSERT"
    "MERGE"
    "UPDATE"
    "VALUE"
    "VALUES"
    "WITH"
    <K_SELECT>

Error parsing: WITH 

themepub_ident AS (
	SELECT
		concat_ws(
			':',
			t.identifier,
			COALESCE(tp.class_suffix_override, 'VOID')
		) AS fullident,
		tp.id
	FROM
		simi.simitheme_theme_publication tp 
	JOIN
		simi.simitheme_theme t ON tp.theme_id = t.id 
),

helper_idents AS (
	SELECT 
		concat_ws(
			':',
			h.theme_identifier,
			COALESCE(h.tpub_class_suffix_override , 'VOID')
		) AS tp_fullident,
		concat_ws(':', h.subarea_coverage_ident, subarea_identifier) AS area_fullident,
		h.id
	FROM 
		simi.simitheme_published_sub_area_helper h
),

area_ident AS ( -- 
	SELECT 
		concat_ws(':', a.coverage_ident , a.identifier) AS fullident,
		a.id
	FROM 
		simi.simitheme_sub_area a
),

leftjoin AS (
	SELECT
		(tp.id IS NULL) AS tp_broken,
		h.tp_fullident,
		(a.id IS NULL) AS area_broken,
		h.area_fullident,
		h.id AS helper_id,
		tp.id AS tp_id,
		a.id AS area_id
	FROM
		helper_idents h
	LEFT JOIN 
		themepub_ident tp ON h.tp_fullident = tp.fullident
	LEFT JOIN 
		area_ident a ON h.area_fullident = a.fullident
)

--SELECT * FROM leftjoin (net.sf.jsqlparser.parser.ParseException: Encountered unexpected token:<EOF>
    at line 55, column 24.

Was expecting one of:

    "("
    ","
    "DELETE"
    "FROM"
    "INSERT"
    "MERGE"
    "UPDATE"
    "VALUE"
    "VALUES"
    "WITH"
    <K_SELECT>
)
********************************************************************************
--------------------------------------------------------------------------------
agi_layer_rollout/pre_copy/clear_helper.sql
--------------------------------------------------------------------------------
agi_layer_rollout/pre_copy/clear_pub_dates.sql
--------------------------------------------------------------------------------
agi_layer_rollout/pre_copy/backup_to_helper.sql
--------------------------------------------------------------------------------
arp_mjpnl_v2_gelan_update/mjpnl_update_vereinbarungen_gelan_kulturflaechen.sql
--------------------------------------------------------------------------------
arp_mjpnl_v2_gelan_update/mjpnl_update_vereinbarungen_gelan_bewirtschafter.sql
--------------------------------------------------------------------------------
arp_mjpnl_v2_gelan_update/update_betrieb_bff2-flaechen.sql
--------------------------------------------------------------------------------
arp_mjpnl_v2_gelan_update/delete_gelandata_from_other_year.sql
--------------------------------------------------------------------------------
arp_mjpnl_v2_gelan_update/mjpnl_update_vereinbarungen_gelan_bewirtschaftungseinheiten.sql
--------------------------------------------------------------------------------
arp_statpopent_hektarraster/hektarraster.sql
class net.sf.jsqlparser.JSQLParserException
net.sf.jsqlparser.parser.ParseException: Encountered unexpected token: "." "."
    at line 11, column 6.

Was expecting:

    ")"

Error parsing: -- neuer Insert mit neuem Hektarraster (on-the-fly generiert)
INSERT INTO 
  xxx_1.hektarraster_statpopstatent
     (geometrie,population_onlypermantresidents,population_total,employees_fulltimeequivalents,employees_total)
     
WITH grid_temp AS (
  --Grid über Kanton generieren
  SELECT 
    (
      ST_SquareGrid(100, geometrie)
    ).* 
  FROM 
    xxx_2.hoheitsgrenzen_kantonsgrenze kg
), 
--nur Zellen behalten die tatsächlich eine Intersection mit Kanton haben
grid AS (
  SELECT 
    g.geom AS geometrie 
  FROM 
    grid_temp g 
    LEFT JOIN xxx_2.hoheitsgrenzen_kantonsgrenze kg ON ST_Intersects(g.geom, kg.geometrie) 
  WHERE 
    kg.kantonskuerzel IS NOT NULL
), 
--we do separate steps for each join - seems to run faster than all-in-one step
pperm AS (
  --permanent residents
  SELECT 
    g.geometrie, 
    count(pp.*) AS population_onlypermantresidents --,
  FROM 
    grid g 
    LEFT JOIN xxx_1.statpop pp ON ST_Within(pp.geometrie, g.geometrie) 
    AND pp.populationtype = 1 
  GROUP BY 
    g.geometrie
), 
ptot AS (
  --total population
  SELECT 
    g.geometrie, 
    g.population_onlypermantresidents, 
    count(p.*) AS population_total 
  FROM 
    pperm g 
    LEFT JOIN xxx_1.statpop p ON ST_Within(p.geometrie, g.geometrie) 
  GROUP BY 
    g.geometrie, 
    g.population_onlypermantresidents
), 
empft AS (
  --employees_fulltimeequivalents
  SELECT 
    g.geometrie, 
    g.population_onlypermantresidents, 
    g.population_total, 
    COALESCE(
      SUM(eft.empfte), 
      0
    ) AS employees_fulltimeequivalents 
  FROM 
    ptot g 
    LEFT JOIN xxx_1.statent eft ON ST_Within(eft.geometrie, g.geometrie) 
  GROUP BY 
    g.geometrie, 
    g.population_onlypermantresidents, 
    g.population_total
)
--finally also join employees_total
SELECT 
  g.geometrie AS geometrie,
  g.population_onlypermantresidents,
  g.population_total, 
  g.employees_fulltimeequivalents, 
  COALESCE(
    SUM(etot.emptot), 
    0
  ) AS employees_total 
FROM 
  empft g 
  LEFT JOIN xxx_1.statent etot ON ST_Within(etot.geometrie, g.geometrie) 
GROUP BY 
  g.geometrie, 
  g.population_onlypermantresidents, 
  g.population_total, 
  g.employees_fulltimeequivalents (net.sf.jsqlparser.parser.ParseException: Encountered unexpected token: "." "."
    at line 11, column 6.

Was expecting:

    ")"
)
********************************************************************************
--------------------------------------------------------------------------------
avt_oeffentlicher_verkehr_pub/avt_oeffentlicher_verkehr_pub_netz.sql
--------------------------------------------------------------------------------
avt_oeffentlicher_verkehr_pub/avt_oeffentlicher_verkehr_pub_haltestellen.sql
--------------------------------------------------------------------------------
awjf_efj_geodaten_upload/geodaten.sql
--------------------------------------------------------------------------------
alw_gewaesserraum_pub/alw_gewaesserraum.sql
--------------------------------------------------------------------------------
agem_finanz_und_lastenausgleich/agem_fila.sql
--------------------------------------------------------------------------------
afu_asiatische_hornisse_pub/afu_asiatische_hornisse_pub.sql
--------------------------------------------------------------------------------
agi_hoheitsgrenzen_pub/agi_hoheitsgrenzen_edit_pub_to_pub_gemeindegrenze.sql
--------------------------------------------------------------------------------
agi_hoheitsgrenzen_pub/agi_hoheitsgrenzen_edit_pub_to_pub_bezirksname_a3.sql
--------------------------------------------------------------------------------
agi_hoheitsgrenzen_pub/agi_hoheitsgrenzen_edit_pub_bezirksname_a3.sql
--------------------------------------------------------------------------------
agi_hoheitsgrenzen_pub/agi_hoheitsgrenzen_edit_pub_to_pub_gemeindegrenze_generalisiert.sql
--------------------------------------------------------------------------------
agi_hoheitsgrenzen_pub/agi_hoheitsgrenzen_edit_pub_gemeindegrenze.sql
--------------------------------------------------------------------------------
agi_hoheitsgrenzen_pub/agi_hoheitsgrenzen_edit_pub_to_pub_bezirksname_a4.sql
--------------------------------------------------------------------------------
agi_hoheitsgrenzen_pub/agi_hoheitsgrenzen_edit_pub_bezirksname_a4.sql
--------------------------------------------------------------------------------
agi_hoheitsgrenzen_pub/agi_hoheitsgrenzen_edit_pub_bezirksgrenze.sql
--------------------------------------------------------------------------------
agi_hoheitsgrenzen_pub/agi_hoheitsgrenzen_edit_pub_to_pub_kantonsgrenze_generalisiert.sql
--------------------------------------------------------------------------------
agi_hoheitsgrenzen_pub/agi_hoheitsgrenzen_edit_pub_gemeindegrenze_generalisiert.sql
--------------------------------------------------------------------------------
agi_hoheitsgrenzen_pub/agi_hoheitsgrenzen_edit_pub_to_pub_gemeindename_a3.sql
--------------------------------------------------------------------------------
agi_hoheitsgrenzen_pub/agi_hoheitsgrenzen_edit_pub_bezirksgrenze_generalisiert.sql
--------------------------------------------------------------------------------
agi_hoheitsgrenzen_pub/fix_geometries.sql
--------------------------------------------------------------------------------
agi_hoheitsgrenzen_pub/agi_hoheitsgrenzen_edit_pub_to_pub_bezirksgrenze.sql
--------------------------------------------------------------------------------
agi_hoheitsgrenzen_pub/agi_hoheitsgrenzen_edit_pub_to_pub_gemeindename_a4.sql
--------------------------------------------------------------------------------
agi_hoheitsgrenzen_pub/agi_hoheitsgrenzen_edit_pub_kantonsname_a3.sql
--------------------------------------------------------------------------------
agi_hoheitsgrenzen_pub/agi_hoheitsgrenzen_edit_pub_to_pub_bezirksgrenze_generalisiert.sql
--------------------------------------------------------------------------------
agi_hoheitsgrenzen_pub/agi_hoheitsgrenzen_edit_pub_to_pub_kantonsgrenze.sql
--------------------------------------------------------------------------------
agi_hoheitsgrenzen_pub/agi_hoheitsgrenzen_edit_pub_to_pub_kantonsname_a3.sql
--------------------------------------------------------------------------------
agi_hoheitsgrenzen_pub/agi_hoheitsgrenzen_edit_pub_gemeindename_a3.sql
--------------------------------------------------------------------------------
agi_hoheitsgrenzen_pub/agi_hoheitsgrenzen_edit_pub_kantonsgrenze_generalisiert.sql
--------------------------------------------------------------------------------
agi_hoheitsgrenzen_pub/agi_hoheitsgrenzen_edit_pub_kantonsname_a4.sql
--------------------------------------------------------------------------------
agi_hoheitsgrenzen_pub/agi_hoheitsgrenzen_edit_pub_gemeindename_a4.sql
--------------------------------------------------------------------------------
agi_hoheitsgrenzen_pub/agi_hoheitsgrenzen_edit_pub_to_pub_kantonsname_a4.sql
--------------------------------------------------------------------------------
agi_hoheitsgrenzen_pub/agi_hoheitsgrenzen_edit_pub_kantonsgrenze.sql
--------------------------------------------------------------------------------
docker-compose/initdb.sql
class net.sf.jsqlparser.JSQLParserException
net.sf.jsqlparser.parser.TokenMgrException: Lexical error at line 3, column 1.  Encountered: '\\' (92),
Error parsing: -- Install additional extensions

\conninfo

CREATE EXTENSION postgis_raster (net.sf.jsqlparser.parser.TokenMgrException: Lexical error at line 3, column 1.  Encountered: '\\' (92),)
********************************************************************************
class net.sf.jsqlparser.JSQLParserException
net.sf.jsqlparser.parser.ParseException: Encountered unexpected token: "\"uuid-ossp\"" <S_QUOTED_IDENTIFIER>
    at line 1, column 18.

Was expecting one of:

    "."
    "INDEX"

Error parsing: CREATE EXTENSION "uuid-ossp" (net.sf.jsqlparser.parser.ParseException: Encountered unexpected token: "\"uuid-ossp\"" <S_QUOTED_IDENTIFIER>
    at line 1, column 18.

Was expecting one of:

    "."
    "INDEX"
)
********************************************************************************
class net.sf.jsqlparser.JSQLParserException
net.sf.jsqlparser.parser.ParseException: Encountered unexpected token:<EOF>
    at line 1, column 37.

Was expecting one of:

    "("
    "ALTER"
    "ANALYZE"
    "BEGIN"
    "CALL"
    "COMMENT"
    "COMMIT"
    "CREATE"
    "DECLARE"
    "DELETE"
    "DESC"
    "DESCRIBE"
    "DROP"
    "EXEC"
    "EXECUTE"
    "EXPLAIN"
    "FROM"
    "GRANT"
    "IF"
    "INSERT"
    "MERGE"
    "PURGE"
    "REFRESH"
    "RENAME"
    "REPLACE"
    "RESET"
    "ROLLBACK"
    "SAVEPOINT"
    "SET"
    "SHOW"
    "SUMMARIZE"
    "TABLE"
    "TRUNCATE"
    "UPDATE"
    "UPSERT"
    "USE"
    "VALUE"
    "VALUES"
    "WITH"
    <K_SELECT>

Error parsing: --CREATE EXTENSION pg_stat_statements (net.sf.jsqlparser.parser.ParseException: Encountered unexpected token:<EOF>
    at line 1, column 37.

Was expecting one of:

    "("
    "ALTER"
    "ANALYZE"
    "BEGIN"
    "CALL"
    "COMMENT"
    "COMMIT"
    "CREATE"
    "DECLARE"
    "DELETE"
    "DESC"
    "DESCRIBE"
    "DROP"
    "EXEC"
    "EXECUTE"
    "EXPLAIN"
    "FROM"
    "GRANT"
    "IF"
    "INSERT"
    "MERGE"
    "PURGE"
    "REFRESH"
    "RENAME"
    "REPLACE"
    "RESET"
    "ROLLBACK"
    "SAVEPOINT"
    "SET"
    "SHOW"
    "SUMMARIZE"
    "TABLE"
    "TRUNCATE"
    "UPDATE"
    "UPSERT"
    "USE"
    "VALUE"
    "VALUES"
    "WITH"
    <K_SELECT>
)
********************************************************************************
--------------------------------------------------------------------------------
awjf_waldwanderwege_pub/waldwanderwege_wanderwege.sql
--------------------------------------------------------------------------------
awjf_waldwanderwege_pub/waldwanderwege_posten.sql
--------------------------------------------------------------------------------
agi_adressen_pub/agi_adressen_pub_benanntes_gebiet.sql
--------------------------------------------------------------------------------
agi_adressen_pub/agi_adressen_pub_verbindungslinie_strasse_hausnummer.sql
--------------------------------------------------------------------------------
arp_nutzungsplanung_import_ersterfassung/insert_arp_nutzungsplanung_transfer_pub.sql
--------------------------------------------------------------------------------
arp_nutzungsplanung_import_ersterfassung/delete_arp_nutzungsplanung_transfer.sql
--------------------------------------------------------------------------------
arp_nutzungsplanung_import_ersterfassung/delete_arp_nutzungsplanung_transfer_pub.sql
--------------------------------------------------------------------------------
arp_nutzungsplanung_import_ersterfassung/insert_arp_nutzungsplanung_transfer.sql
--------------------------------------------------------------------------------
avt_kantonsstrassen_pub/delete_achsen_u_punkte.sql
--------------------------------------------------------------------------------
afu_bodendaten_nabodat_abfrage_pub/horizontdaten.sql
--------------------------------------------------------------------------------
afu_bodendaten_nabodat_abfrage_pub/bodenprofil.sql
--------------------------------------------------------------------------------
afu_bodendaten_nabodat_abfrage_pub/profilblatt.sql
--------------------------------------------------------------------------------
afu_bodendaten_nabodat_abfrage_pub/update_horizont.sql
--------------------------------------------------------------------------------
arp_richtplan_gewaesserschutz_pub/arp_richtplan_pub_gewaesserschutz.sql
--------------------------------------------------------------------------------
arp_nutzungsplanung_import/delete_arp_nutzungsplanung_transfer.sql
--------------------------------------------------------------------------------
arp_nutzungsplanung_import/insert_arp_nutzungsplanung_transfer.sql
--------------------------------------------------------------------------------
arp_nutzungsplanung_planregister_pub_alles/insert_arp_nutzungsplanung_planregister_pub_waldgrenze.sql
--------------------------------------------------------------------------------
arp_nutzungsplanung_planregister_pub_alles/insert_arp_nutzungsplanung_planregister_pub_naturreservate.sql
--------------------------------------------------------------------------------
arp_nutzungsplanung_planregister_pub_alles/insert_arp_nutzungsplanung_planregister_pub_kantonal.sql
--------------------------------------------------------------------------------
arp_nutzungsplanung_planregister_pub_alles/insert_arp_nutzungsplanung_planregister_pub_grundwasserschutz.sql
--------------------------------------------------------------------------------
arp_nutzungsplanung_planregister_pub_alles/insert_dataset.sql
--------------------------------------------------------------------------------
arp_nutzungsplanung_planregister_pub_alles/insert_basket.sql
--------------------------------------------------------------------------------
arp_nutzungsplanung_planregister_pub_alles/delete_arp_nutzungsplanung_planregister_pub_doppelte_dokumente.sql
--------------------------------------------------------------------------------
arp_nutzungsplanung_planregister_pub_alles/insert_arp_nutzungsplanung_planregister_pub_kommunal.sql
--------------------------------------------------------------------------------
awjf_statische_waldgrenze_pub/insert_arp_nutzungsplanung_planregister_pub_waldgrenze.sql
--------------------------------------------------------------------------------
awjf_statische_waldgrenze_pub/delete_arp_nutzungsplanung_planregister_pub_statische_waldgrenze.sql
--------------------------------------------------------------------------------
awjf_statische_waldgrenze_pub/waldgrenze_waldgrenze.sql
--------------------------------------------------------------------------------
awjf_statische_waldgrenze_pub/delete_arp_nutzungsplanung_planregister_pub_doppelte_dokumente.sql
--------------------------------------------------------------------------------
awjf_statische_waldgrenze_pub/delete_awjf_statische_waldgrenze_staging.sql
--------------------------------------------------------------------------------
amb_notfalltreffpunkte_pub/amb_notfalltreffpunkte_pub.sql
--------------------------------------------------------------------------------
agi_av_gb_abgleich_pub/agi_av_gb_abgleich_pub_uebersicht_des_vergleichs.sql
--------------------------------------------------------------------------------
agi_av_gb_abgleich_pub/agi_av_gb_abgleich_import_gb_daten.sql
--------------------------------------------------------------------------------
agi_av_gb_abgleich_pub/agi_av_gb_abgleich_import_uebersicht_des_vergleichs_staging.sql
--------------------------------------------------------------------------------
agi_av_gb_abgleich_pub/agi_av_gb_abgleich_pub_differenzen.sql
--------------------------------------------------------------------------------
agi_av_gb_abgleich_pub/agi_av_gb_abgleich_import_differenzen_staging.sql
--------------------------------------------------------------------------------
agi_av_gb_abgleich_pub/delete_from_agi_av_gb_abgleich_import.sql
--------------------------------------------------------------------------------
arp_richtplan_abbaustellen_pub/arp_richtplan_pub_abbaustellen.sql
--------------------------------------------------------------------------------
avt_kunstbauten_pub/kunstbaute.sql
--------------------------------------------------------------------------------
alw_drainagen_pub/vsadssmini_wk_mangel_leitung.sql
--------------------------------------------------------------------------------
alw_drainagen_pub/vsadssmini_saa_schacht_dr.sql
--------------------------------------------------------------------------------
alw_drainagen_pub/vsadssmini_saa_leitung_dr.sql
--------------------------------------------------------------------------------
alw_drainagen_pub/vsadssmini_wk_mangel_knoten.sql
--------------------------------------------------------------------------------
awjf_programm_biodiversitaet_wald_pub/awjf_programm_biodiversitaet_wald_pub_baumartenvielfalt.sql
--------------------------------------------------------------------------------
awjf_programm_biodiversitaet_wald_pub/awjf_programm_biodiversitaet_wald_pub_biotopflaeche.sql
--------------------------------------------------------------------------------
awjf_programm_biodiversitaet_wald_pub/awjf_programm_biodiversitaet_wald_pub_biotopbaum.sql
--------------------------------------------------------------------------------
agi_grundbuchplan_pub/update_grundbuchplan_grundstueckpos.sql
--------------------------------------------------------------------------------
agi_grundbuchplan_pub/agi_grundbuchplan_pub_grundbuchplan_liegenschaft.sql
--------------------------------------------------------------------------------
agi_grundbuchplan_pub/agi_grundbuchplan_pub_grundbuchplan_grundbuchplanauszug.sql
--------------------------------------------------------------------------------
agi_grundbuchplan_pub/agi_grundbuchplan_pub_grundbuchplan_grenzpunkt.sql
--------------------------------------------------------------------------------
agi_grundbuchplan_pub/agi_grundbuchplan_pub_grundbuchplan_grundstueckpos.sql
--------------------------------------------------------------------------------
agi_grundbuchplan_pub/agi_grundbuchplan_pub_grundbuchplan_bodenbedeckungsymbol.sql
--------------------------------------------------------------------------------
agi_av_mocheckso/agi_av_validierung_pub.sql
--------------------------------------------------------------------------------
agi_av_mocheckso/truncate_table.sql
--------------------------------------------------------------------------------
afu_stehende_gewaesser_abgleich/unlink_av_gewaesser.sql
--------------------------------------------------------------------------------
afu_stehende_gewaesser_abgleich/import_av_gewaesser.sql
--------------------------------------------------------------------------------
avt_strassenzustand_pub/delete_strassenzustand.sql
--------------------------------------------------------------------------------
avt_strassenzustand_pub/select_strassenzustand.sql
--------------------------------------------------------------------------------
avt_strassenzustand_pub/update_strassenzustand.sql
--------------------------------------------------------------------------------
alw_strukturverbesserungen_pub/beizugsgebiet.sql
--------------------------------------------------------------------------------
alw_strukturverbesserungen_pub/genossenschaft.sql
--------------------------------------------------------------------------------
alw_strukturverbesserungen_pub/massnahme.sql
--------------------------------------------------------------------------------
alw_strukturverbesserungen_pub/projekt.sql
--------------------------------------------------------------------------------
alw_strukturverbesserungen_pub/gemeinde.sql
--------------------------------------------------------------------------------
afu_erdwaermesonden_private_quellen_pub/afu_erdwaermesonden_private_quelle.sql
--------------------------------------------------------------------------------
agi_leitungskataster_pub/agi_leitungskataster_pub_abwasser_haltung.sql
--------------------------------------------------------------------------------
agi_leitungskataster_pub/agi_leitungskataster_pub_wasser_absperrorgan.sql
--------------------------------------------------------------------------------
agi_leitungskataster_pub/agi_leitungskataster_pub_abwasser_bauwerk_text.sql
--------------------------------------------------------------------------------
agi_leitungskataster_pub/agi_leitungskataster_pub_wasser_hydrant.sql
--------------------------------------------------------------------------------
agi_leitungskataster_pub/agi_leitungskataster_pub_wasser_leitung.sql
--------------------------------------------------------------------------------
agi_leitungskataster_pub/agi_leitungskataster_pub_datenbereinigung_postprocessing.sql
--------------------------------------------------------------------------------
agi_leitungskataster_pub/agi_leitungskataster_pub_elektrizitaet_trasse.sql
--------------------------------------------------------------------------------
agi_leitungskataster_pub/agi_leitungskataster_pub_wasser_anlagen.sql
--------------------------------------------------------------------------------
agi_leitungskataster_pub/agi_leitungskataster_pub_wasser_kabelpunkt.sql
--------------------------------------------------------------------------------
agi_leitungskataster_pub/agi_leitungskataster_pub_elektrizitaet_trassepunkt.sql
--------------------------------------------------------------------------------
agi_leitungskataster_pub/agi_leitungskataster_pub_wasser_rohrleitungsteil.sql
--------------------------------------------------------------------------------
agi_leitungskataster_pub/agi_leitungskataster_pub_abwasser_bauwerk.sql
--------------------------------------------------------------------------------
agi_leitungskataster_pub/agi_leitungskataster_pub_abwasser_schacht.sql
--------------------------------------------------------------------------------
agi_leitungskataster_pub/agi_leitungskataster_pub_wasser_kabel.sql
--------------------------------------------------------------------------------
arp_richtplan_richtplan_pub/arp_richtplan_richtplan_pub_richtplankarte_ueberlagernde_linie.sql
--------------------------------------------------------------------------------
arp_richtplan_richtplan_pub/arp_richtplan_richtplan_pub_detailkarten_punkt.sql
--------------------------------------------------------------------------------
arp_richtplan_richtplan_pub/arp_richtplan_richtplan_pub_raumkonzept_linie.sql
--------------------------------------------------------------------------------
arp_richtplan_richtplan_pub/delete_data.sql
--------------------------------------------------------------------------------
arp_richtplan_richtplan_pub/arp_richtplan_richtplan_pub_detailkarten_linie.sql
--------------------------------------------------------------------------------
arp_richtplan_richtplan_pub/arp_richtplan_richtplan_pub_detailkarten_flaeche.sql
--------------------------------------------------------------------------------
arp_richtplan_richtplan_pub/arp_richtplan_richtplan_pub_richtplankarte_ueberlagernder_punkt.sql
--------------------------------------------------------------------------------
arp_richtplan_richtplan_pub/arp_richtplan_richtplan_pub_raumkonzept_flaeche.sql
--------------------------------------------------------------------------------
arp_richtplan_richtplan_pub/arp_richtplan_richtplan_pub_richtplankarte_ueberlagernde_flaeche.sql
--------------------------------------------------------------------------------
arp_richtplan_richtplan_pub/arp_richtplan_richtplan_pub_raumkonzept_punkt.sql
--------------------------------------------------------------------------------
afu_geologie_pub/tektonische_strukturen_pub.sql
--------------------------------------------------------------------------------
afu_geologie_pub/pleistozaen_pub.sql
--------------------------------------------------------------------------------
afu_geologie_pub/grundschicht_pub.sql
--------------------------------------------------------------------------------
afu_geologie_pub/abrisskanten_pub.sql
--------------------------------------------------------------------------------
afu_geologie_pub/holozaen_pub.sql
--------------------------------------------------------------------------------
afu_geologie_pub/karstformen_pub.sql
--------------------------------------------------------------------------------
afu_geologie_pub/schichtfallen_pub.sql
--------------------------------------------------------------------------------
arp_mjpnl_initialisierung/update_betrieb_bff2-flaechen.sql
--------------------------------------------------------------------------------
arp_mjpnl_initialisierung/delete_gelandata_from_other_year.sql
--------------------------------------------------------------------------------
agi_plz_ortschaften_pub/insert_postleitzahl.sql
--------------------------------------------------------------------------------
agi_plz_ortschaften_pub/plzortschaften_ortschaft.sql
--------------------------------------------------------------------------------
agi_plz_ortschaften_pub/insert_ortschaft.sql
--------------------------------------------------------------------------------
agi_plz_ortschaften_pub/plzortschaften_postleitzahl.sql
--------------------------------------------------------------------------------
agi_plz_ortschaften_pub/delete_postleitzahl.sql
--------------------------------------------------------------------------------
agi_plz_ortschaften_pub/delete_ortschaft.sql
--------------------------------------------------------------------------------
afu_erdwaermesonden_nagra_pub/nagra_bohrtiefen_bohrtiefen.sql
--------------------------------------------------------------------------------
arp_richtplan_inventar_historische_verkehrswege_pub/delete_inventar_historische_verkehrswege.sql
--------------------------------------------------------------------------------
arp_richtplan_inventar_historische_verkehrswege_pub/arp_richtplan_pub_inventar_historische_verkehrswege.sql
--------------------------------------------------------------------------------
afu_erdwaermesonden_pub/bohrungen.sql
--------------------------------------------------------------------------------
alw_fruchtfolgeflaechen/03_Uebersteuerung/fff_mit_uebersteuerung.sql
class java.lang.UnsupportedOperationException
Finding tables from CreateIndex is not supported
Error parsing: CREATE INDEX IF NOT EXISTS
    fff_mit_uebersteuerung_geometrie_idx 
    ON 
    alw_fruchtfolgeflaechen.fff_mit_uebersteuerung
USING GIST(geometrie) (Finding tables from CreateIndex is not supported)
********************************************************************************
--------------------------------------------------------------------------------
alw_fruchtfolgeflaechen/03_Uebersteuerung/fff_to_edit_db.sql
--------------------------------------------------------------------------------
alw_fruchtfolgeflaechen/03_Uebersteuerung/alw_uebersteuerung_fff.sql
--------------------------------------------------------------------------------
alw_fruchtfolgeflaechen/03_Uebersteuerung/afu_abbaustellen_fff.sql
--------------------------------------------------------------------------------
alw_fruchtfolgeflaechen/01_Datenimport/schadstoffe_rebbau.sql
--------------------------------------------------------------------------------
alw_fruchtfolgeflaechen/01_Datenimport/alw_gewaesserraum_fff.sql
--------------------------------------------------------------------------------
alw_fruchtfolgeflaechen/01_Datenimport/naturreservate_reservat.sql
--------------------------------------------------------------------------------
alw_fruchtfolgeflaechen/01_Datenimport/prepare_db.sql
class net.sf.jsqlparser.JSQLParserException
net.sf.jsqlparser.parser.ParseException: Encountered unexpected token: "IF" "IF"
    at line 1, column 18.

Was expecting one of:

    "."
    "INDEX"

Error parsing: CREATE EXTENSION IF NOT EXISTS "uuid-ossp" (net.sf.jsqlparser.parser.ParseException: Encountered unexpected token: "IF" "IF"
    at line 1, column 18.

Was expecting one of:

    "."
    "INDEX"
)
********************************************************************************
--------------------------------------------------------------------------------
alw_fruchtfolgeflaechen/01_Datenimport/schadstoffe_bodenbelastungsgebiete.sql
--------------------------------------------------------------------------------
alw_fruchtfolgeflaechen/01_Datenimport/isboden_bodeneinheit.sql
--------------------------------------------------------------------------------
alw_fruchtfolgeflaechen/01_Datenimport/nutzungsplanung_grundnutzung.sql
--------------------------------------------------------------------------------
alw_fruchtfolgeflaechen/01_Datenimport/schadstoffe_stahlkonstruktion.sql
--------------------------------------------------------------------------------
alw_fruchtfolgeflaechen/01_Datenimport/schadstoffe_schrebergaerten.sql
--------------------------------------------------------------------------------
alw_fruchtfolgeflaechen/01_Datenimport/schadstoffe_stahlbruecke.sql
--------------------------------------------------------------------------------
alw_fruchtfolgeflaechen/01_Datenimport/gewaesserschutz_zone_areale.sql
--------------------------------------------------------------------------------
alw_fruchtfolgeflaechen/01_Datenimport/nutzungsplanung_erschliessung.sql
--------------------------------------------------------------------------------
alw_fruchtfolgeflaechen/01_Datenimport/gemeindegrenzen.sql
--------------------------------------------------------------------------------
alw_fruchtfolgeflaechen/01_Datenimport/alw_uebersteuerung_fff.sql
--------------------------------------------------------------------------------
alw_fruchtfolgeflaechen/01_Datenimport/fruchtfolgeflaechen_alt.sql
--------------------------------------------------------------------------------
alw_fruchtfolgeflaechen/01_Datenimport/afu_abbaustellen_fff.sql
--------------------------------------------------------------------------------
alw_fruchtfolgeflaechen/01_Datenimport/deleteallschemas.sql
--------------------------------------------------------------------------------
alw_fruchtfolgeflaechen/01_Datenimport/altlasten_belastete_standorte.sql
--------------------------------------------------------------------------------
alw_fruchtfolgeflaechen/01_Datenimport/schadstoffe_gaertnerei.sql
--------------------------------------------------------------------------------
alw_fruchtfolgeflaechen/01_Datenimport/naturschutz_flachmoore.sql
--------------------------------------------------------------------------------
alw_fruchtfolgeflaechen/01_Datenimport/hoheitsgrenzen.sql
--------------------------------------------------------------------------------
alw_fruchtfolgeflaechen/01_Datenimport/schadstoffe_stahlmasten.sql
--------------------------------------------------------------------------------
alw_fruchtfolgeflaechen/01_Datenimport/bodenbedeckung.sql
--------------------------------------------------------------------------------
alw_fruchtfolgeflaechen/01_Datenimport/create_schema_and_table_afu_isboden_pub.sql
class java.lang.UnsupportedOperationException
Finding tables from CreateSchema is not supported
Error parsing: -- Drop table
CREATE SCHEMA IF NOT EXISTS afu_isboden_pub (Finding tables from CreateSchema is not supported)
********************************************************************************
class java.lang.UnsupportedOperationException
Finding tables from CreateIndex is not supported
Error parsing: CREATE INDEX 
    idx_afu_isboden_bodeneinheit_wkb_geometery 
    ON 
    afu_isboden_pub.bodeneinheit 
USING gist (geometrie) (Finding tables from CreateIndex is not supported)
********************************************************************************
--------------------------------------------------------------------------------
alw_fruchtfolgeflaechen/01_Datenimport/schadstoffe_flugplatz.sql
--------------------------------------------------------------------------------
alw_fruchtfolgeflaechen/01_Datenimport/mjpnatur_flaechen.sql
--------------------------------------------------------------------------------
alw_fruchtfolgeflaechen/04_Finish/fff_komplett.sql
class java.lang.UnsupportedOperationException
Finding tables from CreateSequence is not supported
Error parsing: CREATE SEQUENCE 
    fff_komplett_seq (Finding tables from CreateSequence is not supported)
********************************************************************************
class java.lang.UnsupportedOperationException
Finding tables from CreateIndex is not supported
Error parsing: CREATE INDEX IF NOT EXISTS
    fff_komplett_geometrie_idx 
    ON 
    alw_fruchtfolgeflaechen.fff_komplett
    USING GIST(geometrie) (Finding tables from CreateIndex is not supported)
********************************************************************************
--------------------------------------------------------------------------------
alw_fruchtfolgeflaechen/04_Finish/fff_to_edit_db_finish.sql
--------------------------------------------------------------------------------
alw_fruchtfolgeflaechen/04_Finish/fff_mit_gewaesserraum.sql
class java.lang.UnsupportedOperationException
Finding tables from CreateIndex is not supported
Error parsing: CREATE INDEX IF NOT EXISTS
    fff_mit_gewaesserraum_geometrie_idx 
    ON 
    alw_fruchtfolgeflaechen.fff_mit_gewaesserraum
    USING GIST(geometrie) (Finding tables from CreateIndex is not supported)
********************************************************************************
--------------------------------------------------------------------------------
alw_fruchtfolgeflaechen/04_Finish/fff_statistik.sql
--------------------------------------------------------------------------------
alw_fruchtfolgeflaechen/04_Finish/fff_clean.sql
class net.sf.jsqlparser.JSQLParserException
net.sf.jsqlparser.parser.ParseException: Encountered unexpected token: "\"alw_fruchtfolgeflaechen\"" <S_QUOTED_IDENTIFIER>
    at line 2, column 8.

Was expecting one of:

    "ON"
    "USING"

Error parsing: CREATE INDEX 
    ON "alw_fruchtfolgeflaechen"."fruchtfolgeflaechen_buffer_mm" 
    USING GIST ("geom") (net.sf.jsqlparser.parser.ParseException: Encountered unexpected token: "\"alw_fruchtfolgeflaechen\"" <S_QUOTED_IDENTIFIER>
    at line 2, column 8.

Was expecting one of:

    "ON"
    "USING"
)
********************************************************************************
class net.sf.jsqlparser.JSQLParserException
net.sf.jsqlparser.parser.ParseException: Encountered unexpected token: "\"alw_fruchtfolgeflaechen\"" <S_QUOTED_IDENTIFIER>
    at line 2, column 5.

Was expecting one of:

    "ON"
    "USING"

Error parsing: CREATE INDEX ON 
    "alw_fruchtfolgeflaechen"."fruchtfolgeflaechen_exteriorring" 
    USING GIST ("geom") (net.sf.jsqlparser.parser.ParseException: Encountered unexpected token: "\"alw_fruchtfolgeflaechen\"" <S_QUOTED_IDENTIFIER>
    at line 2, column 5.

Was expecting one of:

    "ON"
    "USING"
)
********************************************************************************
class net.sf.jsqlparser.JSQLParserException
net.sf.jsqlparser.parser.ParseException: Encountered unexpected token: "\"alw_fruchtfolgeflaechen\"" <S_QUOTED_IDENTIFIER>
    at line 2, column 5.

Was expecting one of:

    "ON"
    "USING"

Error parsing: CREATE INDEX ON 
    "alw_fruchtfolgeflaechen"."fruchtfolgeflaechen_union" 
    USING GIST ("geom") (net.sf.jsqlparser.parser.ParseException: Encountered unexpected token: "\"alw_fruchtfolgeflaechen\"" <S_QUOTED_IDENTIFIER>
    at line 2, column 5.

Was expecting one of:

    "ON"
    "USING"
)
********************************************************************************
class java.lang.UnsupportedOperationException
Finding tables from CreateSequence is not supported
Error parsing: CREATE SEQUENCE 
    polyseq (Finding tables from CreateSequence is not supported)
********************************************************************************
class net.sf.jsqlparser.JSQLParserException
net.sf.jsqlparser.parser.ParseException: Encountered unexpected token: "\"alw_fruchtfolgeflaechen\"" <S_QUOTED_IDENTIFIER>
    at line 2, column 5.

Was expecting one of:

    "ON"
    "USING"

Error parsing: CREATE INDEX ON 
    "alw_fruchtfolgeflaechen"."polys" 
    USING GIST ("geom") (net.sf.jsqlparser.parser.ParseException: Encountered unexpected token: "\"alw_fruchtfolgeflaechen\"" <S_QUOTED_IDENTIFIER>
    at line 2, column 5.

Was expecting one of:

    "ON"
    "USING"
)
********************************************************************************
class net.sf.jsqlparser.JSQLParserException
net.sf.jsqlparser.parser.ParseException: Encountered unexpected token: "\"alw_fruchtfolgeflaechen\"" <S_QUOTED_IDENTIFIER>
    at line 2, column 5.

Was expecting one of:

    "ON"
    "USING"

Error parsing: CREATE INDEX ON 
    "alw_fruchtfolgeflaechen"."polys_point" 
    USING GIST ("geom") (net.sf.jsqlparser.parser.ParseException: Encountered unexpected token: "\"alw_fruchtfolgeflaechen\"" <S_QUOTED_IDENTIFIER>
    at line 2, column 5.

Was expecting one of:

    "ON"
    "USING"
)
********************************************************************************
class net.sf.jsqlparser.JSQLParserException
net.sf.jsqlparser.parser.ParseException: Encountered unexpected token: "\"alw_fruchtfolgeflaechen\"" <S_QUOTED_IDENTIFIER>
    at line 2, column 5.

Was expecting one of:

    "ON"
    "USING"

Error parsing: CREATE INDEX ON 
    "alw_fruchtfolgeflaechen"."polys_attr" 
    USING GIST ("geometrie") (net.sf.jsqlparser.parser.ParseException: Encountered unexpected token: "\"alw_fruchtfolgeflaechen\"" <S_QUOTED_IDENTIFIER>
    at line 2, column 5.

Was expecting one of:

    "ON"
    "USING"
)
********************************************************************************
class net.sf.jsqlparser.JSQLParserException
net.sf.jsqlparser.parser.ParseException: Encountered unexpected token: "\"alw_fruchtfolgeflaechen\"" <S_QUOTED_IDENTIFIER>
    at line 2, column 5.

Was expecting one of:

    "ON"
    "USING"

Error parsing: CREATE INDEX ON 
    "alw_fruchtfolgeflaechen"."polys_join" 
    USING GIST ("geometrie") (net.sf.jsqlparser.parser.ParseException: Encountered unexpected token: "\"alw_fruchtfolgeflaechen\"" <S_QUOTED_IDENTIFIER>
    at line 2, column 5.

Was expecting one of:

    "ON"
    "USING"
)
********************************************************************************
--------------------------------------------------------------------------------
alw_fruchtfolgeflaechen/02_Vorberechnung/fff_zusammensetzen.sql
class java.lang.UnsupportedOperationException
Finding tables from CreateIndex is not supported
Error parsing: CREATE INDEX IF NOT EXISTS
    fff_zusammengesetzt_geometrie_idx 
    ON 
    alw_fruchtfolgeflaechen.fff_zusammengesetzt 
USING GIST(geometrie) (Finding tables from CreateIndex is not supported)
********************************************************************************
--------------------------------------------------------------------------------
alw_fruchtfolgeflaechen/02_Vorberechnung/maske_bodenbedeckung.sql
--------------------------------------------------------------------------------
alw_fruchtfolgeflaechen/02_Vorberechnung/fff_100.sql
class java.lang.UnsupportedOperationException
Finding tables from CreateIndex is not supported
Error parsing: CREATE INDEX IF NOT EXISTS
    ffff_mit_bodenkartierung_100_geometrie_idx 
    ON 
    alw_fruchtfolgeflaechen.fff_mit_bodenkartierung_100
USING GIST(geometrie) (Finding tables from CreateIndex is not supported)
********************************************************************************
--------------------------------------------------------------------------------
alw_fruchtfolgeflaechen/02_Vorberechnung/maske_ohne_grundwasserschutz.sql
class java.lang.UnsupportedOperationException
Finding tables from CreateIndex is not supported
Error parsing: CREATE INDEX IF NOT EXISTS
    fff_maske_fertig_geometrie_idx 
    ON 
    alw_fruchtfolgeflaechen.fff_maske_fertig
USING GIST(geometrie) (Finding tables from CreateIndex is not supported)
********************************************************************************
--------------------------------------------------------------------------------
alw_fruchtfolgeflaechen/02_Vorberechnung/fff_50.sql
class java.lang.UnsupportedOperationException
Finding tables from CreateIndex is not supported
Error parsing: CREATE INDEX IF NOT EXISTS
    fff_mit_bodenkartierung_50_geometrie_idx 
    ON 
    alw_fruchtfolgeflaechen.fff_mit_bodenkartierung_50
 USING GIST(geometrie) (Finding tables from CreateIndex is not supported)
********************************************************************************
--------------------------------------------------------------------------------
alw_fruchtfolgeflaechen/02_Vorberechnung/maske_ohne_auen_flachmoore_hochmoore_vogelreservate.sql
class java.lang.UnsupportedOperationException
Finding tables from CreateIndex is not supported
Error parsing: CREATE INDEX IF NOT EXISTS
    fff_maske_ohne_auen_flachmoore_hochmoore_vogelreservate_geometrie_idx 
    ON 
    alw_fruchtfolgeflaechen.fff_maske_ohne_auen_flachmoore_hochmoore_vogelreservate
USING GIST(geometrie) (Finding tables from CreateIndex is not supported)
********************************************************************************
--------------------------------------------------------------------------------
alw_fruchtfolgeflaechen/02_Vorberechnung/make_table_fff_maske_bodenbedeckung.sql
--------------------------------------------------------------------------------
alw_fruchtfolgeflaechen/02_Vorberechnung/bodeninhalt_index_setzen.sql
class java.lang.UnsupportedOperationException
Finding tables from CreateIndex is not supported
Error parsing: CREATE INDEX IF NOT EXISTS
    bodeneinheit_bodpktzahl_idx 
    ON 
    afu_isboden_pub.bodeneinheit 
USING btree (bodpktzahl) (Finding tables from CreateIndex is not supported)
********************************************************************************
class java.lang.UnsupportedOperationException
Finding tables from CreateIndex is not supported
Error parsing: CREATE INDEX IF NOT EXISTS
    bodeneinheit_gelform_idx 
    ON 
    afu_isboden_pub.bodeneinheit 
USING btree (gelform) (Finding tables from CreateIndex is not supported)
********************************************************************************
class java.lang.UnsupportedOperationException
Finding tables from CreateIndex is not supported
Error parsing: CREATE INDEX IF NOT EXISTS
    bodeneinheit_geometrie_idx 
    ON 
    afu_isboden_pub.bodeneinheit 
USING gist (geometrie) (Finding tables from CreateIndex is not supported)
********************************************************************************
class java.lang.UnsupportedOperationException
Finding tables from CreateIndex is not supported
Error parsing: CREATE INDEX IF NOT EXISTS
    bodeneinheit_skelett_ob_idx 
    ON 
    afu_isboden_pub.bodeneinheit 
USING btree (skelett_ob) (Finding tables from CreateIndex is not supported)
********************************************************************************
class java.lang.UnsupportedOperationException
Finding tables from CreateIndex is not supported
Error parsing: CREATE INDEX IF NOT EXISTS
    bodeneinheit_wasserhhgr_idx 
    ON 
    afu_isboden_pub.bodeneinheit 
USING btree (wasserhhgr) (Finding tables from CreateIndex is not supported)
********************************************************************************
class java.lang.UnsupportedOperationException
Finding tables from CreateIndex is not supported
Error parsing: CREATE INDEX IF NOT EXISTS
    idx_afu_isboden_bodeneinheit_wkb_geometery 
    ON 
    afu_isboden_pub.bodeneinheit 
USING gist (geometrie) (Finding tables from CreateIndex is not supported)
********************************************************************************
--------------------------------------------------------------------------------
alw_fruchtfolgeflaechen/02_Vorberechnung/maske_ohne_bauzonen.sql
class java.lang.UnsupportedOperationException
Finding tables from CreateIndex is not supported
Error parsing: CREATE INDEX IF NOT EXISTS
    fff_maske_ohne_bauzonen_geometrie_idx 
    ON 
    alw_fruchtfolgeflaechen.fff_maske_ohne_bauzonen
USING GIST(geometrie) (Finding tables from CreateIndex is not supported)
********************************************************************************
--------------------------------------------------------------------------------
alw_fruchtfolgeflaechen/02_Vorberechnung/maske_ohne_naturreservate.sql
class java.lang.UnsupportedOperationException
Finding tables from CreateIndex is not supported
Error parsing: CREATE INDEX IF NOT EXISTS
    fff_maske_ohne_naturreservate_geometrie_idx 
    ON 
    alw_fruchtfolgeflaechen.fff_maske_ohne_naturreservate
USING GIST(geometrie) (Finding tables from CreateIndex is not supported)
********************************************************************************
--------------------------------------------------------------------------------
alw_fruchtfolgeflaechen/02_Vorberechnung/delete_data.sql
--------------------------------------------------------------------------------
alw_fruchtfolgeflaechen/02_Vorberechnung/maske_where_bodenkartierung.sql
class java.lang.UnsupportedOperationException
Finding tables from CreateIndex is not supported
Error parsing: CREATE INDEX IF NOT EXISTS
    fff_maske_where_bodenkartierung_geometrie_idx 
    ON 
    alw_fruchtfolgeflaechen.fff_maske_where_bodenkartierung
USING GIST(geometrie) (Finding tables from CreateIndex is not supported)
********************************************************************************
--------------------------------------------------------------------------------
alw_fruchtfolgeflaechen/02_Vorberechnung/fff_ohne_bodenkartierung.sql
class java.lang.UnsupportedOperationException
Finding tables from CreateIndex is not supported
Error parsing: CREATE INDEX IF NOT EXISTS
    fff_ohne_bodenkartierung_geometrie_idx 
    ON 
    alw_fruchtfolgeflaechen.fff_ohne_bodenkartierung
USING GIST(geometrie) (Finding tables from CreateIndex is not supported)
********************************************************************************
--------------------------------------------------------------------------------
alw_fruchtfolgeflaechen/02_Vorberechnung/maske_ohne_klimaeignung.sql
class java.lang.UnsupportedOperationException
Finding tables from CreateIndex is not supported
Error parsing: CREATE INDEX IF NOT EXISTS
    fff_maske_ohne_klimaeignung_geometrie_idx 
    ON 
    alw_fruchtfolgeflaechen.fff_maske_ohne_klimaeignung
USING GIST(geometrie) (Finding tables from CreateIndex is not supported)
********************************************************************************
--------------------------------------------------------------------------------
alw_fruchtfolgeflaechen/02_Vorberechnung/maske_where_not_bodenkartierung.sql
class java.lang.UnsupportedOperationException
Finding tables from CreateIndex is not supported
Error parsing: CREATE INDEX IF NOT EXISTS
    fff_maske_where_not_bodenkartierung_geometrie_idx 
    ON 
    alw_fruchtfolgeflaechen.fff_maske_where_not_bodenkartierung
USING GIST(geometrie) (Finding tables from CreateIndex is not supported)
********************************************************************************
--------------------------------------------------------------------------------
alw_fruchtfolgeflaechen/02_Vorberechnung/maske_ohne_trockenwiesen.sql
class java.lang.UnsupportedOperationException
Finding tables from CreateIndex is not supported
Error parsing: CREATE INDEX IF NOT EXISTS
    fff_maske_ohne_trockenwiesen_geometrie_idx 
    ON 
    alw_fruchtfolgeflaechen.fff_maske_ohne_trockenwiesen
USING GIST(geometrie) (Finding tables from CreateIndex is not supported)
********************************************************************************
--------------------------------------------------------------------------------
alw_fruchtfolgeflaechen/02_Vorberechnung/maske_ohne_altlasten.sql
class java.lang.UnsupportedOperationException
Finding tables from CreateIndex is not supported
Error parsing: CREATE INDEX IF NOT EXISTS
    fff_maske_ohne_altlasten_geometrie_idx 
    ON 
    alw_fruchtfolgeflaechen.fff_maske_ohne_altlasten
USING GIST(geometrie) (Finding tables from CreateIndex is not supported)
********************************************************************************
--------------------------------------------------------------------------------
alw_fruchtfolgeflaechen/02_Vorberechnung/maske_ohne_schadstoffbelastete_boeden.sql
class java.lang.UnsupportedOperationException
Finding tables from CreateIndex is not supported
Error parsing: CREATE INDEX IF NOT EXISTS
    fff_maske_ohne_schadstoffbelastete_boeden_geometrie_idx 
    ON 
    alw_fruchtfolgeflaechen.fff_maske_ohne_schadstoffbelastete_boeden
USING GIST(geometrie) (Finding tables from CreateIndex is not supported)
********************************************************************************
--------------------------------------------------------------------------------
arp_richtplan_oeffentlicher_verkehr_pub/arp_richtplan_pub_oeffentlicher_verkehr.sql
--------------------------------------------------------------------------------
agi_simi_regions/copy_from/edit_db.sql
--------------------------------------------------------------------------------
agi_simi_regions/copy_from/gemeinden.sql
--------------------------------------------------------------------------------
agi_simi_regions/copy_from/kanton.sql
--------------------------------------------------------------------------------
agi_simi_regions/post_copy/refs_reset.sql
--------------------------------------------------------------------------------
agi_simi_regions/gemeinden/insert_gem_reg.sql
--------------------------------------------------------------------------------
agi_simi_regions/gemeinden/delete_gem_reg.sql
--------------------------------------------------------------------------------
agi_simi_regions/pre_copy/delete_regions.sql
--------------------------------------------------------------------------------
agi_simi_regions/pre_copy/refs_set_null.sql
